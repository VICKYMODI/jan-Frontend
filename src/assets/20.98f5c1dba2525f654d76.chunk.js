webpackJsonp([20],{"6wHN":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("WT6e"),o=a("bfOx"),i=a("Xjw4"),l=a("7DMc"),r=a("z6At"),s=a("oM2X"),c=a("nhD7"),u=a("gvij"),m=a("sPEV"),d=a("83x0"),p=a("neUS"),h=a("R4TA"),y=a("8k3G"),g=a("LdfH"),P=a("eHLV"),v=a("IBfq"),R=a("UU6z"),f=a("HFLS"),A=a("BS/f"),b=a("oLy+"),C=a("vdXp"),V=function(){return function(e){e.policyVersion&&(this.policyVersion=new C.a(e.policyVersion)),this.insuranceSiteKey=e.insuranceSiteKey,this.selectedProgramOption=e.selectedProgramOption,this.paymentPlan=e.paymentPlan,this.cardType=e.cardType,this.paymentBy=e.paymentBy,this.cardHolderName=e.cardHolderName,this.cardNumber=e.cardNumber,this.expiryMonth=e.expiryMonth,this.expiryYear=e.expiryYear,this.cvv=e.cvv,this.recurringCardHolderName=e.recurringCardHolderName,this.recurringCardNumber=e.recurringCardNumber,this.recurringCardExpiryMonth=e.recurringCardExpiryMonth,this.recurringCardExpiryYear=e.recurringCardExpiryYear,this.recurringCardCvv=e.recurringCardCvv,this.bankName=e.bankName,this.bankAccountType=e.bankAccountType,this.accountNumber=e.accountNumber,this.routingNumber=e.routingNumber,this.isRecurringCardDetails=e.isRecurringCardDetails,this.cashPaymentBy=e.cashPaymentBy,this.amount=e.amount,this.premiumAmount=e.premiumAmount,this.cardAmount=e.cardAmount,this.cashAmount=e.cashAmount,this.moneyOrderAmount=e.moneyOrderAmount,this.billingAddress=e.billingAddress,this.aprtUntNumber=e.aprtUntNumber,this.address=e.address,this.city=e.city,this.zipcode=e.zipcode,this.stateId=e.stateId,this.recurringAprtUntNumber=e.recurringAprtUntNumber,this.recurringAddress=e.recurringAddress,this.recurringCity=e.recurringCity,this.recurringZipcode=e.recurringZipcode,this.recurringStateId=e.recurringStateId,this.chaseAuthResponse=e.chaseAuthResponse,this.transactionType=e.transactionType,this.product=e.product,this.customerAvailability=e.customerAvailability,this.agentNotes=e.agentNotes}}(),T=a("wwEy"),N=a("2JrV"),I=a("Sfd1"),E=a("smbZ"),F=a("bzHu"),k=a("4vQB"),S=a("lEa7"),O=a("47UT"),w=a("nhDP"),M=a("lgs7"),x=this&&this.__decorate||function(e,t,a,n){var o,i=arguments.length,l=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(l=(i<3?o(l):i>3?o(t,a,l):o(t,a))||l);return i>3&&l&&Object.defineProperty(t,a,l),l},D=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},B=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(o,i){function l(e){try{s(n.next(e))}catch(e){i(e)}}function r(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new a(function(t){t(e.value)}).then(l,r)}s((n=n.apply(e,t||[])).next())})},q=this&&this.__generator||function(e,t){var a,n,o,i,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,n=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(o=(o=l.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],n=0}finally{a=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}},U=l.FormControlDirective.prototype.ngOnChanges;l.FormControlDirective.prototype.ngOnChanges=function(){return this.form.nativeElement=this.valueAccessor._elementRef.nativeElement,U.apply(this,arguments)};var _=l.FormControlName.prototype.ngOnChanges;l.FormControlName.prototype.ngOnChanges=function(){var e=_.apply(this,arguments);return this.control.nativeElement=this.valueAccessor._elementRef.nativeElement,e};var W=function(){function e(e,t,a,n,o,i,l,r,s,c,u,m){this.router=e,this.route=t,this.commonService=a,this.stateService=n,this.loginService=o,this.quoteService=i,this.manualReceiptService=l,this.paymentInfoService=r,this.lc=s,this.modalService=c,this.idleService=u,this.commonRepository=m,this.title="paymentSplit",this.splitArray=[],this.SuffixConstant=R.a,this.NotificationMethodConstant=y.a,this.CustomerAvailabilityConstant=f.a,this.PaymentByConstant=A.a,this.TransactionTypeConstant=P.a,this.ProductConstant=v.a,this.HeardAboutUsConstant=g.a,this.checkCard=!0,this.mobileNo="",this.dateOfBirthMask=[/[0-9]/,/\d/,"/",/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/],this.mobileNoMask=[/[0-9]/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/],this.numericPattern="[0-9]+",this.addressModel=new b.a,this.cardDetails=!1,this.cashDetails=!1,this.moneyOrder=!1,this.isShowCardNumber=!1,this.isShowCardCvvInfo=!1,this.paymentErrorMessage=!1,this.customerAvailabilityErrorMessage=!1,this.amountPattern="^\\d+(\\.)?\\d{0,}$",this.zeroPremiumAMount=!1,this.zeroFullPayAmount=!1,this.renewalFeeAmount=0,this.transactionTypeRenewalSelected=!1,this.onTransactionChange=!1,this.selectedCardString=void 0,this.MIN_TIMEOUT_SECONDS=10,this.visaCardIconString="../assets/images/card_icon/visa-card.png",this.visaElectronCardIconString="../assets/images/card_icon/visa-electron-card.png",this.masterCardIconString="../assets/images/card_icon/master-card.png",this.discoverCardIconString="../assets/images/card_icon/discover-card.png",this.cardMonths=[{id:"01",value:"01"},{id:"02",value:"02"},{id:"03",value:"03"},{id:"04",value:"04"},{id:"05",value:"05"},{id:"06",value:"06"},{id:"07",value:"07"},{id:"08",value:"08"},{id:"09",value:"09"},{id:"10",value:"10"},{id:"11",value:"11"},{id:"12",value:"12"}],this.cardYears=[],this.collectedAmount=0,this.premiumAmount=0,this.isRenewal=!1,this.isRenewalPolicy=!1,this.isNameChanged=!1,this.isPolicyIsCancelled=!1,this.transactionTypeList=[],this.isShowFetchPolicy=!1,this.isPremiumAmountReadOnly=!1,this.isTotalCollectedAmountReadOnly=!1,this.isPolicyReadOnly=!1,this.showMakePaymentWarning=!1,this.makePaymentWarning="",this.showPaymentTransactionFeesWarning=!1,this.paymentTransactionFeesWarningAmount="",this.isShowExpiredCardMsg=!1,this.cardExpiryMsg="Your credit/debit card validity is expired, please update your card.",this.isFormSubmitted=!1,this.visaElectronCardNumbers=["4026","4508","4844","4913","4917"],this.totalCollecatedAmountByUser=0,this.transactionAmount=0,this.isTotalCollecatedAmountByUser=!1,this.isEditable=!1,this.isDisableRenewBtn=!1,this.agents=[],this.offices=[],this.isTransactionDateChanged=!1,this.paymentTransactionAdmin=!1,this.addNewPolicyToExist=!1,this._timeout=null,this.redirectPolicyPage=!1,this.isPolicyRenewed=!1,this.redirectLogout=!1,this.amwinsCardTransactionFees=!1,this.windhavenCardTransactionFees=!1,this.falconCardTransactionFees=!1,this.isShowSchedule=!1,this.installmentDueDates=[],this.installmentsAmounts=[],this.siteKey=null}return e.prototype.ngOnInit=function(){var e=this;this.idleService.idleLogout(),this.getAllActiveAgentList(),localStorage.getItem("installmentDueDates")&&(this.installmentDueDates=localStorage.getItem("installmentDueDates").split(","),this.installmentsAmounts=localStorage.getItem("installmentsAmounts").split(","),console.log("in mr"+this.installmentDueDates));for(var t=(new Date).getFullYear(),a=0;a<11;a++){var n={id:a,value:t+a};this.cardYears.push(n)}if(this.commonService.clearAlertMessage(),this.commonService.checkLoginAndRedirect(h.b.EMPLOYE)){this.commonService.adjustTopScrollBar();var o=this.commonService.getLoginUserDetails();if(3==o.role&&(this.traineeAcoount=!0),o.permissions.length>0)for(a=0;a<o.permissions.length;a++)if("MR_PAYMENT_TRANSACTION"==o.permissions[a].key){this.paymentTransactionAdmin=!0;break}o.office.city;this.manualReceiptService.getAllPaymentTransactionFee().subscribe(function(t){null!=t&&(e.paymentTransactionFees=t.data)},function(t){(0==t.status||JSON.parse(t._body).error)&&e.loginService.checkErrorResponse(t),e.commonService.showErrorMessage(JSON.parse(t._body).message)}),this.suffixEnumConstants=R.a.getNamesAndValuesByInputType(),this.notificationMethodEnumConstants=y.a.getNamesAndValuesByInputType(),this.customerAvailabilityEnumConstants=f.a.getNamesAndValuesByInputType(),this.paymentByEnumConstants=A.a.getNamesAndValuesByInputType(),this.transactionTypeEnumConstants=P.a.getNamesAndValuesByInputType(),this.heardAboutUsEnumConstants=g.a.getNamesAndValuesByInputType(),this.heardAboutUsEnumConstants.sort(function(e,t){return e.name.localeCompare(t.name)}),this.heardAboutUsEnumConstants=this.heardAboutUsEnumConstants.filter(function(e){return"OTHER"!=e.name}),this.heardAboutUsEnumConstants.push({name:"OTHER",value:"14"}),this.traineeAcoount&&(this.transactionTypeEnumConstants=this.transactionTypeEnumConstants.filter(function(e){return 2!=e.value}),this.transactionTypeEnumConstants=this.transactionTypeEnumConstants.filter(function(e){return 3!=e.value}),this.transactionTypeEnumConstants=this.transactionTypeEnumConstants.filter(function(e){return 4!=e.value})),this.productEnumConstants=v.a.getNamesAndValuesByInputType(),this.manualReceiptCheckPolicyForm=this.createManualReceiptCheckPolicyForm(),this.manualReceiptPage=this.createReceiptForm(),this.stateService.findAllStates().subscribe(function(t){void 0!=t&&(e.states=t.data,e.state=t.data.filter(function(e){return"TX"===e.code}),e.manualReceiptPage.controls.stateId.setValue(e.state[0].encryptedId),e.texasStateId=e.state[0].encryptedId,setTimeout(function(){$("#customerState").selectpicker("refresh")},10))},function(t){e.idleService.isTimeOutWarningDisplayed=!0,(0==t.status||JSON.parse(t._body).error)&&e.loginService.checkErrorResponse(t),e.commonService.showErrorMessage(JSON.parse(t._body).message)}),this.totalAmount=0,this.initValidatorJquery(),this.sub=this.route.queryParams.subscribe(function(t){return B(e,void 0,void 0,function(){var e,a=this;return q(this,function(n){if(this.commonService.clearAlertMessage(),this.totalAmount=0,this.resetCreditCardDetails(),this.paymentId=t.id,this.collectedAmount=t.tc,this.premiumAmount=t.pa,this.fullPayAmount=t.fpa,this.downPayAmount=t.dp,this.renewalFeeAmount=t.renewFee,this.isRenewal="true"==t.isRenewal,this.isNameChanged="true"==t.isNameChanged,this.updatedName=t.updatedName,this.lateFees=t.lf,this.isPolicyIsCancelled="true"==t.isPolicyIsCancelled,this.fetchedPhoneNumber=t.phoneNumber,this.fetchedEmail=t.email,this.isEditable="true"==t.isEditable,this.isDisableRenewBtn="true"==t.isDisableRenewBtn,this.isPolicyRenewed="true"==t.isPolicyRenewed,this.isRenewalPolicy="true"==t.isRenewalPolicy,this.transactionDetails=t.transactionDetails,this.policyNumber=t.policyNumber,this.customerId=t.customerId,this.cardXMask=void 0,this.isShowCardNumber=!1,this.selectedCardString=void 0,this.creditCardInfoDetails=void 0,this.isShowExpiredCardMsg=!1,this.siteKey=t.siteKey,!this.paymentTransactionAdmin&&this.downPayAmount&&this.collectedAmount&&this.renewalFeeAmount&&!this.isDisableRenewBtn&&(this.transactionTypeRenewalSelected=!0,this.collectedAmount=(parseFloat(this.collectedAmount.toString())+parseFloat(this.renewalFeeAmount.toString())).toFixed(2)),this.paymentTransactionAdmin||this.downPayAmount||!this.renewalFeeAmount||!this.isRenewal||"AMWINS"!=this.siteKey&&"AAAA"!=this.siteKey&&"CONNECT"!=this.siteKey||(this.premiumAmount>0&&(!this.lateFees||0==this.lateFees)?(this.collectedAmount=(parseFloat(this.collectedAmount.toString())+parseFloat(this.renewalFeeAmount.toString())).toFixed(2),this.transactionTypeRenewalSelected=!0):this.transactionTypeRenewalSelected=!1),0==this.collectedAmount&&(this.isPremiumAmountReadOnly=!1),this.downPayAmount&&(this.premiumAmount=this.downPayAmount,this.fullPayAmount||(this.fullPayAmount=this.downPayAmount)),this.fullPayAmount&&0==this.fullPayAmount&&38!=this.manualReceiptPage.controls.product.value&&(this.zeroFullPayAmount=!0),this.paymentId&&!this.isPolicyRenewed?(this.isShowFetchPolicy=!1,this.commonService.manualReceiptNavFlag=!0,this.isEditable||(this.loadPaymentDetailsById(),setTimeout(function(){a.setValidatorOfPolicyNumber()},1e3))):(this.isShowFetchPolicy=!0,this.manualReceiptPage.reset(),this.totalAmount=0,this.resetCreditCardDetails(),this.manualReceiptCheckPolicyForm=this.createManualReceiptCheckPolicyForm(),this.commonService.clearAlertMessage(),this.isShowExpiredCardMsg=!1),this.isPolicyRenewed){if(this.manualReceiptCheckPolicyForm.controls.transactionType.setValue(1),null!=this.siteKey)for(e=0;e<this.productEnumConstants.length;e++)if(this.productEnumConstants[e].name===this.siteKey){this.manualReceiptCheckPolicyForm.controls.product.setValue(this.productEnumConstants[e].value);break}this.manualReceiptCheckPolicyForm.controls.policyNumber.setValue(this.policyNumber),this.fetchPolicy()}return setTimeout(function(){a.paymentId&&a.isEditable&&$("#selectProduct").attr("disabled","disabled"),$(".selectpicker").selectpicker({selectOnTab:!0}),$(".selectpicker").selectpicker("refresh")},1500),[2]})})}),setTimeout(function(){$(".selectpicker").selectpicker({selectOnTab:!0}),$(".selectpicker").selectpicker("refresh"),e.isEditable&&e.fillUpManualReceiptFormForEdit()},h.a.SELECT_PICKER_REFRESH_TIME),this.isPremiumAmountReadOnly=!1,this.isPolicyReadOnly=!1}else this.redirectLogout=!0},e.prototype.createReceiptForm=function(){var e=new Date;e.setHours(0,0,0,0);var t=(e.getMonth()+1>9?e.getMonth()+1:"0"+(e.getMonth()+1))+"/"+(e.getDate()>9?e.getDate():"0"+e.getDate())+"/"+e.getFullYear();return this.setDatePicker(t),new l.FormGroup({firstName:new l.FormControl(void 0,[l.Validators.required,l.Validators.pattern(h.a.USER_NAME_PATTERN)]),middleName:new l.FormControl(void 0,[l.Validators.pattern(h.a.USER_NAME_PATTERN)]),lastName:new l.FormControl(void 0,[l.Validators.required,l.Validators.pattern(h.a.USER_NAME_PATTERN)]),suffix:new l.FormControl(void 0,[]),email:new l.FormControl(void 0,[l.Validators.required,l.Validators.pattern(h.a.EMAIL_PATTERN)]),reEmail:new l.FormControl(void 0,[l.Validators.required,l.Validators.pattern(h.a.EMAIL_PATTERN)]),mobileNo:new l.FormControl(void 0,[l.Validators.required,l.Validators.minLength(10)]),notificationMethod:new l.FormControl(this.notificationMethodEnumConstants[3].value,[]),transactionType:new l.FormControl(void 0,[l.Validators.required]),product:new l.FormControl(void 0,[l.Validators.required]),heardAboutUs:new l.FormControl(void 0,[]),policyNumber:new l.FormControl(void 0,[l.Validators.required,this.noWhitespaceValidator]),amount:new l.FormControl(void 0,[l.Validators.required,l.Validators.max(999999.999),l.Validators.min(1)]),premiumAmount:new l.FormControl(void 0,[l.Validators.required,l.Validators.max(999999.999),l.Validators.min(1)]),card:new l.FormControl(void 0,[]),cash:new l.FormControl(void 0,[]),moneyOrder:new l.FormControl,cardHolderName:new l.FormControl(void 0,[]),cardNumber:new l.FormControl(void 0,[]),expiryMonth:new l.FormControl(void 0,[]),expiryYear:new l.FormControl(void 0,[]),cvv:new l.FormControl(void 0,[this.isEditable?null:l.Validators.required]),address:new l.FormControl(void 0,[]),aprtUntNumber:new l.FormControl(void 0,[]),city:new l.FormControl(void 0,[]),stateId:new l.FormControl(void 0,[]),zipcode:new l.FormControl(void 0,[]),agentNotes:new l.FormControl(void 0,[l.Validators.required]),cashAmount:new l.FormControl(void 0,[l.Validators.pattern(this.amountPattern),l.Validators.max(999999.999),l.Validators.min(1)]),moneyOrderAmount:new l.FormControl(void 0,[l.Validators.pattern(this.amountPattern),l.Validators.max(999999.999),l.Validators.min(1)]),totalAmount:new l.FormControl(void 0,[l.Validators.pattern(this.amountPattern),l.Validators.max(999999.999),l.Validators.min(1)]),moneyOrderUpload:new l.FormControl(void 0,[this.isEditable?null:l.Validators.required]),insuranceSiteKey:new l.FormControl(void 0,[]),paymentBy:new l.FormControl(void 0,[]),policyVersion:new l.FormControl(void 0,[]),cardAmount:new l.FormControl(void 0,[l.Validators.pattern(this.amountPattern),l.Validators.max(999999.999),l.Validators.min(1)]),agent:new l.FormControl(void 0,[]),quotedBy:new l.FormControl(void 0,[]),office:new l.FormControl(void 0,[]),updatedCreatedDateTime:new l.FormControl(t,[l.Validators.required,w.b,w.e]),customerAvailability:new l.FormControl(void 0,[l.Validators.required])})},e.prototype.createManualReceiptCheckPolicyForm=function(){return this.commonService.clearAlertMessage(),new l.FormGroup({transactionType:new l.FormControl(void 0,[l.Validators.required]),product:new l.FormControl(void 0,[l.Validators.required]),policyNumber:new l.FormControl(void 0,[l.Validators.required,this.noWhitespaceValidator])})},e.prototype.loadPaymentDetailsById=function(){var e=this;this.paymentInfoService.findPaymentInfoById(this.paymentId).subscribe(function(t){if(void 0!=t&&void 0!=t.data){if(console.log(t),e.customerId=t.data.customer.decryptedId,e.policyId=t.data.policyVersion.policy.decryptedId,e.manualReceiptPage.controls.insuranceSiteKey.setValue(t.data.selectedInsuranceSite),t.data.policyVersion&&e.manualReceiptPage.controls.policyVersion.setValue(t.data.policyVersion),e.manualReceiptPage.patchValue(t.data),e.manualReceiptPage.controls.customerAvailability.setValue(void 0),t.data.policyVersion.heardAboutUs){for(var a=0;a<e.heardAboutUsEnumConstants.length;a++)if(e.heardAboutUsEnumConstants[a].name===t.data.policyVersion.heardAboutUs){e.manualReceiptPage.controls.heardAboutUs.setValue(e.heardAboutUsEnumConstants[a].value);break}}else e.manualReceiptPage.controls.heardAboutUs.setValue(void 0);if(t.data.policyVersion.quotedBy&&e.manualReceiptPage.controls.quotedBy.setValue(t.data.policyVersion.quotedBy.id),t.data&&t.data.customer){e.manualReceiptPage.patchValue(t.data.customer),e.manualReceiptPage.controls.reEmail.setValue(e.manualReceiptPage.controls.email.value),e.fetchedPhoneNumber&&""!=e.fetchedPhoneNumber&&(e.manualReceiptPage.controls.mobileNo.setValue(e.fetchedPhoneNumber),e.validatePhoneNumber()),e.fetchedEmail&&""!=e.fetchedEmail&&(e.manualReceiptPage.controls.email.setValue(e.fetchedEmail),e.manualReceiptPage.controls.reEmail.setValue(e.fetchedEmail)),e.isNameChanged&&e.updatedName&&e.setUpdatedNameToForm(e.updatedName),e.onNameBlur(void 0,"firstName"),e.onNameBlur(void 0,"middleName"),e.onNameBlur(void 0,"lastName"),t.data.customer.state,t.data.policyVersion&&t.data.policyVersion.policy&&(e.manualReceiptPage.patchValue(t.data.policyVersion.policy),e.isPolicyRenewed&&e.policyNumber&&e.manualReceiptPage.controls.policyNumber.setValue(e.policyNumber),e.onLoadPolicyNumber=e.manualReceiptPage.controls.policyNumber.value.trim().toUpperCase());for(var n=0;n<e.notificationMethodEnumConstants.length;n++)e.notificationMethodEnumConstants[n].name===t.data.policyVersion.notificationMethod&&e.manualReceiptPage.controls.notificationMethod.setValue(e.notificationMethodEnumConstants[n].value);e.isPolicyIsCancelled?(e.manualReceiptPage.controls.amount.setValue(void 0),e.manualReceiptPage.controls.premiumAmount.setValue(void 0)):(e.manualReceiptPage.controls.amount.setValue(0!=e.collectedAmount?(+e.collectedAmount).toFixed(2):void 0),e.manualReceiptPage.controls.premiumAmount.setValue(void 0!=e.premiumAmount?(+e.premiumAmount).toFixed(2):void 0)),e.manualReceiptPage.controls.agentNotes.setValue(void 0),e.manualReceiptPage.controls.cashAmount.setValue(void 0),e.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0),0==+e.premiumAmount&&(e.commonService.showInfoMessage("No payment due at this time."),e.zeroPremiumAMount=!0),!e.downPayAmount||"UNITED_AUTO"!=t.data.product&&"WINDHAVEN"!=t.data.product&&"FALCON"!=t.data.product||e.commonService.showInfoMessage("This policy is eligible for renewal payment."),e.isDisableRenewBtn&&e.commonService.clearAlertMessage()}if(null!=t.data.product)for(var o=0;o<e.productEnumConstants.length;o++)if(e.productEnumConstants[o].name===t.data.product){e.manualReceiptPage.controls.product.setValue(e.productEnumConstants[o].value);break}e.isRenewal&&!e.isPolicyRenewed?e.manualReceiptPage.controls.transactionType.setValue(5):e.lateFees?e.manualReceiptPage.controls.transactionType.setValue(0):e.manualReceiptPage.controls.transactionType.setValue(1),(e.zeroFullPayAmount&&"UNITED_AUTO"==t.data.product||("UNITED_AUTO"==t.data.product||"WINDHAVEN"==t.data.product||"FALCON"==t.data.product)&&e.downPayAmount)&&e.manualReceiptPage.controls.transactionType.setValue(5),!e.isRenewalPolicy||"WINDHAVEN"!=t.data.product&&"FALCON"!=t.data.product||e.manualReceiptPage.controls.transactionType.setValue(5),(e.zeroPremiumAMount||e.isPolicyIsCancelled||e.isDisableRenewBtn)&&e.manualReceiptPage.controls.transactionType.setValue(void 0),e.checkManualReceiptPageDynamicCondition()?(e.showMakePaymentWarning=!0,e.makePaymentWarning="Please make sure you post this payment at "+e.ProductConstant.getProductModelByProduct(e.productEnumConstants[e.manualReceiptPage.controls.product.value].name).label+" as well to complete the transaction."):e.showMakePaymentWarning=!1;var i=e.commonService.getLoginUserDetails();e.officeId=i.office.id,e.agentId=+i.encryptedId,e.paymentTransactionAdmin||e.setValidatorOfPolicyNumber();var l=t.data.policyVersion.encryptedId;e.paymentInfoService.getlatestCreditCardInfoByPolicyVersionId(l).subscribe(function(t){if(void 0!=t.data&&null!=t.data.creditCardInfo&&void 0!=t.data.creditCardInfo){e.creditCardInfoDetails=t.data.creditCardInfo,e.manualReceiptPage.controls.cardHolderName.setValue(e.creditCardInfoDetails.cardHolderName),e.manualReceiptPage.controls.cardNumber.setValue(e.creditCardInfoDetails.cardNumber),e.cardXMask=e.creditCardInfoDetails.cardNumber,e.onCardNumberEnter(null),t.data.creditCardInfo.cardType?"VISA"==t.data.creditCardInfo.cardType.toUpperCase()?(-1!=e.visaElectronCardNumbers.indexOf(t.data.creditCardInfo.cardNumber.substring(0,4))?e.selectedCardString=e.visaElectronCardIconString:e.selectedCardString=e.visaCardIconString,e.cardType="1"):"MASTERCARD"==t.data.creditCardInfo.cardType.toUpperCase()?(e.selectedCardString=e.masterCardIconString,e.cardType="0"):"DISCOVER"==t.data.creditCardInfo.cardType.toUpperCase()?(e.selectedCardString=e.discoverCardIconString,e.cardType="2",e.validateDiscoverCardTypeForManualReceiptPage(!0)):(e.selectedCardString=void 0,e.cardType=null,t.data.creditCardInfo.cardNumber?e.isShowCardNumber=!0:e.isShowCardNumber=!1,e.manualReceiptPage.controls.cardNumber.setErrors({invalidCardType:!0})):(e.selectedCardString=void 0,e.cardType=null,t.data.creditCardInfo.cardNumber?e.isShowCardNumber=!0:e.isShowCardNumber=!1,e.manualReceiptPage.controls.cardNumber.setErrors({invalidCardType:!0})),setTimeout(function(){e.onCardNumberBlur()},1e3);for(var a=void 0,n=0;n<e.cardMonths.length;n++)if(e.cardMonths[n].value==e.creditCardInfoDetails.expiryMonth){a=e.cardMonths[n];break}var o=void 0;for(n=0;n<e.cardMonths.length;n++)if(e.cardYears[n].value==e.creditCardInfoDetails.expiryYear){o=e.cardYears[n];break}e.manualReceiptPage.controls.expiryMonth.setValue(a.value),e.manualReceiptPage.controls.expiryYear.setValue(o.value),e.validateSavedCardExpiry(),e.manualReceiptPage.controls.address.setValue(e.creditCardInfoDetails.address),e.manualReceiptPage.controls.aprtUntNumber.setValue(e.creditCardInfoDetails.aprtUntNumber),e.manualReceiptPage.controls.city.setValue(e.creditCardInfoDetails.city),e.manualReceiptPage.controls.stateId.setValue(e.creditCardInfoDetails.state.encryptedId),e.manualReceiptPage.controls.zipcode.setValue(e.creditCardInfoDetails.zipcode),console.log("cc"+e.creditCardInfoDetails)}}),setTimeout(function(){$(".selectpicker").selectpicker("refresh")},h.a.SELECT_PICKER_REFRESH_TIME)}},function(t){e.idleService.isTimeOutWarningDisplayed=!0,(0==t.status||JSON.parse(t._body).error)&&e.loginService.checkErrorResponse(t),e.commonService.showErrorMessage(JSON.parse(t._body).message)})},e.prototype.focusOnZip=function(){$("#zipcode").focus()},e.prototype.getStateNAmeStateEncryptedId=function(e){var t=this.states.filter(function(t){return t.encryptedId==e}).map(function(e){return e.name});return t&&t.length>0?t[0]:void 0},e.prototype.verifyAddress=function(){var e=this;return new Promise(function(t){null!=e.manualReceiptPage.controls.address.value&&""!=e.manualReceiptPage.controls.address.value&&null!=e.manualReceiptPage.controls.zipcode.value&&""!=e.manualReceiptPage.controls.zipcode.value&&null!=e.manualReceiptPage.controls.city.value&&""!=e.manualReceiptPage.controls.city.value?(e.addressModel.address1=e.manualReceiptPage.controls.address.value+(null!=e.manualReceiptPage.controls.aprtUntNumber.value&&""!=e.manualReceiptPage.controls.aprtUntNumber.value?" #"+e.manualReceiptPage.controls.aprtUntNumber.value:""),e.addressModel.address2="",e.addressModel.city=e.manualReceiptPage.controls.city.value,e.addressModel.state=e.getStateNAmeStateEncryptedId(e.manualReceiptPage.controls.stateId.value),e.addressModel.zip5=e.manualReceiptPage.controls.zipcode.value,e.stateService.verifyAddress(e.addressModel).subscribe(function(a){null!=a.data.address.error?(e.manualReceiptPage.controls.address.setErrors({invalidAddress:!0}),t("")):(e.manualReceiptPage.controls.city.setValue(a.data.address.city),e.manualReceiptPage.controls.address.setErrors(void 0),e.manualReceiptPage.controls.zipcode.value!=a.data.address.zip5&&(e.manualReceiptPage.controls.zipcode.setErrors({anotherZipcode:!0}),e.errorMessage="Incorrect zipcode.Do you mean "+a.data.address.zip5+" ?"),t(""))},function(t){e.idleService.isTimeOutWarningDisplayed=!0,(0==t.status||JSON.parse(t._body).error)&&e.loginService.checkErrorResponse(t),e.commonService.showErrorMessage(JSON.parse(t._body).message)})):t("")})},e.prototype.checkZipCodeIsValidOrNot=function(){return B(this,void 0,void 0,function(){var e=this;return q(this,function(t){return[2,new Promise(function(t){null!=e.manualReceiptPage.controls.zipcode.value&&""!=e.manualReceiptPage.controls.zipcode.value&&e.manualReceiptPage.controls.zipcode.value.length>4?e.stateService.findStateAndCountryByZipcode(e.manualReceiptPage.controls.zipcode.value).subscribe(function(a){return B(e,void 0,void 0,function(){var e=this;return q(this,function(n){switch(n.label){case 0:return null!=a.data.zipCode.error?[3,2]:(this.manualReceiptPage.controls.city.setValue(a.data.zipCode.city),this.stateService.findStateByCode(a.data.zipCode.state).subscribe(function(t){e.manualReceiptPage.controls.stateId.setValue(t.data.encryptedId),setTimeout(function(){$("#customerState").selectpicker("refresh")},10)}),[4,this.verifyAddress()]);case 1:return n.sent(),t(""),[3,4];case 2:return[4,this.verifyAddress()];case 3:n.sent(),this.manualReceiptPage.controls.zipcode.setErrors({invalidZipCode:!0}),this.manualReceiptPage.controls.city.setValue(a.data.zipCode.city),this.manualReceiptPage.controls.stateId.setValue(this.texasStateId),t(""),n.label=4;case 4:return[2]}})})},function(t){return B(e,void 0,void 0,function(){return q(this,function(e){return this.idleService.isTimeOutWarningDisplayed=!0,(0==t.status||JSON.parse(t._body).error)&&this.loginService.checkErrorResponse(t),[2]})})}):(e.manualReceiptPage.controls.zipcode.setErrors({invalidZipCode:!0}),t(""))})]})})},e.prototype.notificationMethodChanged=function(){if(this.manualReceiptPage.controls.notificationMethod.value!==this.notificationMethodEnumConstants[1].value&&this.manualReceiptPage.controls.notificationMethod.value!==this.notificationMethodEnumConstants[3].value||void 0!=this.manualReceiptPage.controls.mobileNo.value&&""!==this.manualReceiptPage.controls.email.value){var e=this.manualReceiptPage.controls.email.errors;e&&e.emailAddressIsRequired&&(1==Object.keys(e).length?e=void 0:delete e.emailAddressIsRequired),this.manualReceiptPage.controls.email.setErrors(e)}else this.manualReceiptPage.controls.email.setErrors({emailAddressIsRequired:!0})},e.prototype.checkNumberPattern=function(e){return!(!e.key.match(this.numericPattern)&&"8"!=e.which&&"9"!=e.keyCode&&"27"!=e.keyCode&&"46"!=e.keyCode&&"37"!=e.keyCode&&"39"!=e.keyCode)&&(console.log(e),-1==e.target.value.indexOf(".")||"46"!=e.keyCode)},e.prototype.onPaymentByChange=function(e){var t=this;this.paymentErrorMessage=!1;var a=this.splitArray.indexOf(e);if(-1!==a)1==e&&(this.manualReceiptPage.get("cardAmount").clearValidators(),this.resetOnlyCreditCardDetails()),this.splitArray.splice(a,1),$(".selectAllWhenFilter"+e).prop("checked",!1);else if(this.splitArray.length>1){var n=this.splitArray[0];1==n&&(this.manualReceiptPage.get("cardAmount").clearValidators(),this.resetOnlyCreditCardDetails()),this.splitArray.splice(0,1),$(".selectAllWhenFilter"+n).prop("checked",!1),this.splitArray.push(e),$(".selectAllWhenFilter"+e).prop("checked",!0)}else this.splitArray.push(e),$(".selectAllWhenFilter"+e).prop("checked",!0);if(0==this.splitArray.length&&(this.splitArray.push(1),$(".selectAllWhenFilter1").prop("checked",!0)),this.isTotalCollecatedAmountByUser?(this.verifyTotalAndPremiumAmount(),this.totalCollecatedAmountByUser=parseFloat(this.manualReceiptPage.controls.amount.value)-this.transactionAmount):this.manualReceiptPage.controls.amount.value?(this.verifyTotalAndPremiumAmount(),this.totalCollecatedAmountByUser=parseFloat(this.manualReceiptPage.controls.amount.value),this.isTotalCollecatedAmountByUser=!0):this.manualReceiptPage.controls.amount.setValue(void 0),1==this.splitArray[0]){this.manualReceiptPage.controls.card.setValue(!0);var o=this.manualReceiptPage.controls.amount.value,i=this.manualReceiptPage.controls.premiumAmount.value,r=parseFloat(this.manualReceiptPage.controls.amount.value),s=parseFloat(this.manualReceiptPage.controls.premiumAmount.value);!this.paymentTransactionAdmin&&r==s&&(o||i)&&(0!=this.manualReceiptPage.controls.transactionType.value&&1!=this.manualReceiptPage.controls.transactionType.value&&5!=this.manualReceiptPage.controls.transactionType.value||r!=s||0!=this.manualReceiptPage.controls.product.value&&3!=this.manualReceiptPage.controls.product.value&&8!=this.manualReceiptPage.controls.product.value&&35!=this.manualReceiptPage.controls.product.value&&38!=this.manualReceiptPage.controls.product.value&&12!=this.manualReceiptPage.controls.product.value)?parseFloat(this.manualReceiptPage.controls.amount.value)==parseFloat(this.manualReceiptPage.controls.premiumAmount.value)&&this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[0].value):(this.cardDetails=!0,setTimeout(function(){$(".selectpicker").selectpicker("refresh")},10),setTimeout(function(){$("#card-number").focus(),t.initValidatorJquery()},20),this.cashDetails=!1,this.moneyOrder=!1,this.splitArray.includes(2)?(this.cashDetails=!0,this.manualReceiptPage.controls.moneyOrderAmount.setValue(null)):this.splitArray.includes(3)?(this.moneyOrder=!0,this.manualReceiptPage.controls.cashAmount.setValue(null)):(this.manualReceiptPage.controls.moneyOrderAmount.setValue(null),this.manualReceiptPage.controls.cashAmount.setValue(null)),this.cashDetails||this.moneyOrder?this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[3].value):this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[0].value),this.initValidatorJquery(),this.manualReceiptPage.get("address").setValidators([l.Validators.required]),this.manualReceiptPage.get("aprtUntNumber").clearValidators(),this.manualReceiptPage.get("city").setValidators([l.Validators.required]),this.manualReceiptPage.get("stateId").setValidators([l.Validators.required]),this.manualReceiptPage.get("zipcode").setValidators([l.Validators.required,l.Validators.maxLength(5)]),this.manualReceiptPage.get("cardHolderName").setValidators([l.Validators.required]),this.manualReceiptPage.get("cardNumber").setValidators([l.Validators.required,l.Validators.pattern(h.a.NUMERIC_PATTERN)]),this.manualReceiptPage.get("expiryMonth").setValidators([l.Validators.required]),this.manualReceiptPage.get("expiryYear").setValidators([l.Validators.required]),this.isEditable||this.manualReceiptPage.get("cvv").setValidators([l.Validators.required,l.Validators.pattern(h.a.NUMERIC_PATTERN)]),this.manualReceiptPage.get("moneyOrderAmount").clearValidators(),this.manualReceiptPage.get("cashAmount").clearValidators(),this.manualReceiptPage.get("moneyOrderUpload").clearValidators(),this.manualReceiptPage.get("cardAmount").clearValidators(),this.manualReceiptPage.controls.moneyOrderUpload.reset(),this.manualReceiptPage.get("address").updateValueAndValidity(),this.manualReceiptPage.get("aprtUntNumber").updateValueAndValidity(),this.manualReceiptPage.get("city").updateValueAndValidity(),this.manualReceiptPage.get("stateId").updateValueAndValidity(),this.manualReceiptPage.get("zipcode").updateValueAndValidity(),this.manualReceiptPage.get("cardHolderName").updateValueAndValidity(),this.manualReceiptPage.get("cardNumber").updateValueAndValidity(),this.manualReceiptPage.get("expiryMonth").updateValueAndValidity(),this.manualReceiptPage.get("expiryYear").updateValueAndValidity(),this.manualReceiptPage.get("cvv").updateValueAndValidity(),this.manualReceiptPage.get("moneyOrderAmount").updateValueAndValidity(),this.manualReceiptPage.get("cashAmount").updateValueAndValidity(),this.manualReceiptPage.get("moneyOrderUpload").updateValueAndValidity(),this.manualReceiptPage.get("cardAmount").updateValueAndValidity(),this.manualReceiptPage.controls.stateId.setValue(this.texasStateId),this.manualReceiptPage.controls.cardAmount.setValue((+this.manualReceiptPage.controls.amount.value).toFixed(2)),setTimeout(function(){$(".selectpicker").selectpicker("refresh")},h.a.SELECT_PICKER_REFRESH_TIME)),setTimeout(function(){$(".selectpicker").selectpicker("refresh")},h.a.SELECT_PICKER_REFRESH_TIME)}if(2==this.splitArray[0]&&(this.cashDetails=!0,this.cardDetails=!1,this.moneyOrder=!1,this.splitArray.includes(1)?(this.cardDetails=!0,this.manualReceiptPage.controls.moneyOrderAmount.setValue(null),setTimeout(function(){$(".selectpicker").selectpicker("refresh")},h.a.SELECT_PICKER_REFRESH_TIME)):this.splitArray.includes(3)?(this.moneyOrder=!0,this.manualReceiptPage.controls.cardAmount.setValue(null)):(this.manualReceiptPage.controls.moneyOrderAmount.setValue(null),this.manualReceiptPage.controls.cardAmount.setValue(null)),this.manualReceiptPage.get("address").clearValidators(),this.manualReceiptPage.get("aprtUntNumber").clearValidators(),this.manualReceiptPage.get("city").clearValidators(),this.manualReceiptPage.get("stateId").clearValidators(),this.manualReceiptPage.get("zipcode").clearValidators(),this.manualReceiptPage.get("cardHolderName").clearValidators(),this.manualReceiptPage.get("cardNumber").clearValidators(),this.manualReceiptPage.get("expiryMonth").clearValidators(),this.manualReceiptPage.get("expiryYear").clearValidators(),this.manualReceiptPage.get("cvv").clearValidators(),3==this.splitArray[1]?(this.moneyOrder=!0,this.manualReceiptPage.get("moneyOrderAmount").setValidators([l.Validators.pattern(this.amountPattern),l.Validators.required,l.Validators.max(999999.999),l.Validators.min(1)]),this.isEditable||this.manualReceiptPage.get("moneyOrderUpload").setValidators([l.Validators.required]),this.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0)):(this.moneyOrder=!1,this.manualReceiptPage.get("moneyOrderAmount").clearValidators(),this.manualReceiptPage.get("moneyOrderUpload").clearValidators(),this.manualReceiptPage.controls.moneyOrderUpload.reset()),this.cardDetails||this.moneyOrder?this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[3].value):this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[1].value),this.manualReceiptPage.controls.amount.value&&this.manualReceiptPage.controls.cashAmount.setValue((+this.manualReceiptPage.controls.amount.value).toFixed(2)),this.manualReceiptPage.controls.cardAmount.setValue(void 0),this.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0),this.manualReceiptPage.get("cashAmount").setValidators([l.Validators.pattern(this.amountPattern),l.Validators.required,l.Validators.max(999999.999),l.Validators.min(1)]),this.manualReceiptPage.get("address").updateValueAndValidity(),this.manualReceiptPage.get("aprtUntNumber").updateValueAndValidity(),this.manualReceiptPage.get("city").updateValueAndValidity(),this.manualReceiptPage.get("stateId").updateValueAndValidity(),this.manualReceiptPage.get("zipcode").updateValueAndValidity(),this.manualReceiptPage.get("cardHolderName").updateValueAndValidity(),this.manualReceiptPage.get("cardNumber").updateValueAndValidity(),this.manualReceiptPage.get("expiryMonth").updateValueAndValidity(),this.manualReceiptPage.get("expiryYear").updateValueAndValidity(),this.manualReceiptPage.get("cvv").updateValueAndValidity(),this.manualReceiptPage.get("moneyOrderAmount").updateValueAndValidity(),this.manualReceiptPage.get("cashAmount").updateValueAndValidity(),this.manualReceiptPage.get("moneyOrderUpload").updateValueAndValidity(),this.manualReceiptPage.get("cardAmount").updateValueAndValidity()),3==this.splitArray[0]&&(2==this.splitArray[1]?(this.cashDetails=!0,setTimeout(function(){$(".selectpicker").selectpicker("refresh")},10),setTimeout(function(){$("#card-number").focus(),t.initValidatorJquery()},20),this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[3].value),this.manualReceiptPage.get("moneyOrderAmount").setValidators([l.Validators.pattern(this.amountPattern),l.Validators.required,l.Validators.max(999999.999),l.Validators.min(1)]),this.isEditable||this.manualReceiptPage.get("moneyOrderUpload").setValidators([l.Validators.required]),this.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0),this.manualReceiptPage.get("cashAmount").setValidators([l.Validators.pattern(this.amountPattern),l.Validators.required,l.Validators.max(999999.999),l.Validators.min(1)]),this.manualReceiptPage.controls.amount.value&&this.manualReceiptPage.controls.cashAmount.setValue((+this.manualReceiptPage.controls.amount.value).toFixed(2))):(this.cashDetails=!1,this.manualReceiptPage.get("cashAmount").clearValidators(),this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[2].value),this.manualReceiptPage.controls.amount.value&&this.manualReceiptPage.controls.moneyOrderAmount.setValue((+this.manualReceiptPage.controls.amount.value).toFixed(2)),this.manualReceiptPage.controls.cardAmount.setValue(void 0),this.manualReceiptPage.controls.cashAmount.setValue(void 0)),this.cardDetails=!1,this.cashDetails=!1,this.moneyOrder=!0,this.splitArray.includes(1)?(this.cardDetails=!0,this.manualReceiptPage.controls.cashAmount.setValue(null),setTimeout(function(){$(".selectpicker").selectpicker("refresh")},h.a.SELECT_PICKER_REFRESH_TIME)):this.splitArray.includes(2)?(this.cashDetails=!0,this.manualReceiptPage.controls.cardAmount.setValue(null)):(this.manualReceiptPage.controls.cardAmount.setValue(null),this.manualReceiptPage.controls.cashAmount.setValue(null)),this.cashDetails||this.cardDetails?this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[3].value):this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[2].value),this.manualReceiptPage.get("address").clearValidators(),this.manualReceiptPage.get("aprtUntNumber").clearValidators(),this.manualReceiptPage.get("city").clearValidators(),this.manualReceiptPage.get("stateId").clearValidators(),this.manualReceiptPage.get("zipcode").clearValidators(),this.manualReceiptPage.get("cardHolderName").clearValidators(),this.manualReceiptPage.get("cardNumber").clearValidators(),this.manualReceiptPage.get("expiryMonth").clearValidators(),this.manualReceiptPage.get("expiryYear").clearValidators(),this.manualReceiptPage.get("cvv").clearValidators(),this.manualReceiptPage.get("moneyOrderAmount").setValidators([l.Validators.pattern(this.amountPattern),l.Validators.required,l.Validators.max(999999.999),l.Validators.min(1)]),this.isEditable||this.manualReceiptPage.get("moneyOrderUpload").setValidators([l.Validators.required]),this.manualReceiptPage.get("address").updateValueAndValidity(),this.manualReceiptPage.get("aprtUntNumber").updateValueAndValidity(),this.manualReceiptPage.get("city").updateValueAndValidity(),this.manualReceiptPage.get("stateId").updateValueAndValidity(),this.manualReceiptPage.get("zipcode").updateValueAndValidity(),this.manualReceiptPage.get("cardHolderName").updateValueAndValidity(),this.manualReceiptPage.get("cardNumber").updateValueAndValidity(),this.manualReceiptPage.get("expiryMonth").updateValueAndValidity(),this.manualReceiptPage.get("expiryYear").updateValueAndValidity(),this.manualReceiptPage.get("cvv").updateValueAndValidity(),this.manualReceiptPage.get("moneyOrderAmount").updateValueAndValidity(),this.manualReceiptPage.get("cashAmount").updateValueAndValidity(),this.manualReceiptPage.get("moneyOrderUpload").updateValueAndValidity(),this.manualReceiptPage.get("cardAmount").updateValueAndValidity()),this.updatePaymentTransactionFees(),this.calculateTotalAmount(),this.updateRenewalFeeWithTotalCollecationAmount(),this.paymentTransactionAdmin||this.setValidatorOfPolicyNumber(),setTimeout(function(){$(".selectpicker").selectpicker("refresh")},10),setTimeout(function(){$("#card-number").focus(),t.initValidatorJquery()},20),!this.paymentTransactionAdmin&&(1==this.manualReceiptPage.controls.transactionType.value||0==this.manualReceiptPage.controls.transactionType.value||5==this.manualReceiptPage.controls.transactionType.value)&&!this.checkTransactionTypeForPremiumZero()&&+this.premiumAmount>parseFloat(this.manualReceiptPage.controls.premiumAmount.value)){this.manualReceiptPage.controls.premiumAmount;this.setValidatorOnPremiumAmount({min:{min:+this.premiumAmount}})}if(this.fullPayAmount&&parseFloat(this.manualReceiptPage.controls.premiumAmount.value)>this.fullPayAmount&&!this.zeroFullPayAmount&&!this.isPolicyIsCancelled&&(0==this.manualReceiptPage.controls.transactionType.value||1==this.manualReceiptPage.controls.transactionType.value||5==this.manualReceiptPage.controls.transactionType.value)){this.manualReceiptPage.controls.premiumAmount;this.setValidatorOnPremiumAmount({max:{max:+this.fullPayAmount}})}},e.prototype.checkTotalAndPremiumIsSameAndPaymentByIsCreditCard=function(){var e=this;if(void 0!=this.manualReceiptPage.controls.product.value&&null!=this.manualReceiptPage.controls.product.value&&""!==this.manualReceiptPage.controls.product.value)(0!=this.manualReceiptPage.controls.transactionType.value&&1!=this.manualReceiptPage.controls.transactionType.value&&5!=this.manualReceiptPage.controls.transactionType.value||(0==this.manualReceiptPage.controls.transactionType.value||1==this.manualReceiptPage.controls.transactionType.value||5==this.manualReceiptPage.controls.transactionType.value)&&0!=this.manualReceiptPage.controls.product.value&&3!=this.manualReceiptPage.controls.product.value&&8!=this.manualReceiptPage.controls.product.value&&35!=this.manualReceiptPage.controls.product.value&&38!=this.manualReceiptPage.controls.product.value&&12!=this.manualReceiptPage.controls.product.value&&!this.paymentTransactionAdmin)&&(this.paymentTransactionAdmin||setTimeout(function(){if(e.manualReceiptPage.controls.paymentBy.value==e.paymentByEnumConstants[0].value&&parseFloat(e.manualReceiptPage.controls.amount.value)==parseFloat(e.manualReceiptPage.controls.premiumAmount.value)){e.manualReceiptPage.controls.cardAmount.setValue(void 0),e.splitArray.splice(0,1),$(".selectAllWhenFilter1").prop("checked",!1);var t="Please make payment directly with "+e.ProductConstant.getProductModelByProduct(e.productEnumConstants[e.manualReceiptPage.controls.product.value].name).label+" as AMS doesn't support this transaction yet.",a={backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Information",message:void 0!=e.manualReceiptPage.controls.transactionType.value&&null!=e.manualReceiptPage.controls.transactionType.value&&""!==e.manualReceiptPage.controls.transactionType.value?t:"Please select any transaction type.",okButton:{label:"OK"}}};e.modalService.show(S.a,a).content.onClose.subscribe(function(t){e.resetCreditCardDetails()})}},h.a.SELECT_PICKER_REFRESH_TIME));else if(this.manualReceiptPage.controls.amount.value&&this.manualReceiptPage.controls.premiumAmount.value){this.modalService.show(S.a,{backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Warning",message:"Please select any product.",okButton:{label:"OK"}}}).content.onClose.subscribe(function(t){e.resetCreditCardDetails(),$("#selectProduct").focus()})}},e.prototype.resetCreditCardDetails=function(){$(".selectAllWhenFilter1").prop("checked",!1),$(".selectAllWhenFilter2").prop("checked",!1),$(".selectAllWhenFilter3").prop("checked",!1),this.cashDetails=!1,this.cardDetails=!1,this.moneyOrder=!1,this.splitArray=[],this.manualReceiptPage.controls.paymentBy.setValue(void 0),this.manualReceiptPage.controls.card.setValue(void 0),this.manualReceiptPage.controls.cash.setValue(void 0),this.manualReceiptPage.controls.moneyOrder.setValue(void 0),this.manualReceiptPage.get("address").clearValidators(),this.manualReceiptPage.get("aprtUntNumber").clearValidators(),this.manualReceiptPage.get("city").clearValidators(),this.manualReceiptPage.get("stateId").clearValidators(),this.manualReceiptPage.get("zipcode").clearValidators(),this.manualReceiptPage.get("cardHolderName").clearValidators(),this.manualReceiptPage.get("cardNumber").clearValidators(),this.manualReceiptPage.get("expiryMonth").clearValidators(),this.manualReceiptPage.get("expiryYear").clearValidators(),this.manualReceiptPage.get("cvv").clearValidators(),this.manualReceiptPage.get("moneyOrderAmount").clearValidators(),this.manualReceiptPage.get("cashAmount").clearValidators(),this.manualReceiptPage.get("moneyOrderUpload").clearValidators(),this.manualReceiptPage.get("cardAmount").clearValidators(),this.manualReceiptPage.get("address").updateValueAndValidity(),this.manualReceiptPage.get("aprtUntNumber").updateValueAndValidity(),this.manualReceiptPage.get("city").updateValueAndValidity(),this.manualReceiptPage.get("stateId").updateValueAndValidity(),this.manualReceiptPage.get("zipcode").updateValueAndValidity(),this.manualReceiptPage.get("cardHolderName").updateValueAndValidity(),this.manualReceiptPage.get("cardNumber").updateValueAndValidity(),this.manualReceiptPage.get("expiryMonth").updateValueAndValidity(),this.manualReceiptPage.get("expiryYear").updateValueAndValidity(),this.manualReceiptPage.get("cvv").updateValueAndValidity(),this.manualReceiptPage.get("moneyOrderAmount").updateValueAndValidity(),this.manualReceiptPage.get("cashAmount").updateValueAndValidity(),this.manualReceiptPage.get("moneyOrderUpload").updateValueAndValidity(),this.manualReceiptPage.get("cardAmount").updateValueAndValidity()},e.prototype.submitForm=function(){return B(this,void 0,void 0,function(){var e=this;return q(this,function(t){return void 0!=this.modalReference&&setTimeout(function(){return e.modalReference.hide()},400),this._timeout&&window.clearTimeout(this._timeout),this._timeout=window.setTimeout(function(){e._timeout=null,e.lc.run(function(){if(null!=e.manualReceiptPage.controls.firstName.value&&e.manualReceiptPage.controls.firstName.value.length>=2&&null!=e.manualReceiptPage.controls.lastName.value&&e.manualReceiptPage.controls.lastName.value.length>=2){var t=new V(e.manualReceiptPage.value);t.cardType=e.cardType;var a=new N.a(e.manualReceiptPage.value);if(e.manualReceiptPage.value.policyVersion&&e.manualReceiptPage.value.policyVersion.encryptedId){a.encryptedId=e.manualReceiptPage.value.policyVersion.policy.customer.encryptedId;var n=new T.a({encryptedId:e.manualReceiptPage.value.policyVersion.policy.encryptedId,policyNumber:e.manualReceiptPage.value.policyNumber,customer:a});t.policyVersion=new C.a({encryptedId:e.manualReceiptPage.value.policyVersion.encryptedId,notificationMethod:e.manualReceiptPage.value.notificationMethod,policy:n})}else{a.encryptedId=void 0;n=new T.a({encryptedId:void 0,policyNumber:e.manualReceiptPage.value.policyNumber,customer:a});t.policyVersion=new C.a({encryptedId:void 0,notificationMethod:e.manualReceiptPage.value.notificationMethod,policy:n})}if(t.policyVersion&&t.policyVersion.policy&&t.policyVersion.policy.customer){var o={paymentRequest:t,premiumDetails:void 0};void 0!=e.paymentId&&null!=e.paymentId||e.manualReceiptService.checkExistingCustomer(t.policyVersion.policy.customer.encryptedId,t.policyVersion.policy.customer.firstName,t.policyVersion.policy.customer.lastName,1,t.policyVersion.policy.policyNumber).subscribe(function(t){if(t&&t.data&&t.data.length>0){console.log("show a popup in which we will show all the fetched customer details like Name, Email, Phone and checkbox");var a=t.data;if(e.isPolicyRenewed)for(var n=0;n<a.length;n++){var i=a[n];(i.encryptedId=e.customerId)&&(e.manualReceiptPage.controls.firstName.setValue(i.customer.firstName),e.manualReceiptPage.controls.middleName.setValue(i.customer.middleName),e.manualReceiptPage.controls.lastName.setValue(i.customer.lastName),e.manualReceiptPage.controls.email.setValue(i.customer.email),e.manualReceiptPage.controls.reEmail.setValue(i.customer.email),e.manualReceiptPage.controls.mobileNo.setValue(i.customer.mobileNo),e.addNewPolicyToExist=!0,e.selectedPaymentInfo=i)}else{var l={backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Customer already exists.",okButton:{label:"OK"},cancelButton:{label:"Cancel"},existingPaymentInfos:t.data,selectedTransactionType:e.manualReceiptPage.controls.transactionType.value,enteredPolicyNumber:o.paymentRequest.policyVersion.policy.policyNumber,customerdetailUpdate:!1},class:"modal-lg"};e.modalReference=e.modalService.show(F.a,l),e.modalReference.content.onClose.subscribe(function(t){t&&(t.selectedPaymentInfo?2!=e.manualReceiptPage.controls.transactionType.value&&"policy"==t.customerOrPolicy?(e.redirectPolicyPage=!0,e.router.navigate([h.b.EMPLOYE+"/"+h.b.CUSTOMER_POLICY_PROFILE],{queryParams:{id:t.selectedPaymentInfo.customer.encryptedId,policyId:t.selectedPaymentInfo.policyVersion.policy.encryptedId}})):"customer"==t.customerOrPolicy&&(console.log(t.selectedPaymentInfo.customer),e.manualReceiptPage.controls.firstName.setValue(t.selectedPaymentInfo.customer.firstName),e.manualReceiptPage.controls.middleName.setValue(t.selectedPaymentInfo.customer.middleName),e.manualReceiptPage.controls.lastName.setValue(t.selectedPaymentInfo.customer.lastName),e.manualReceiptPage.controls.email.setValue(t.selectedPaymentInfo.customer.email),e.manualReceiptPage.controls.reEmail.setValue(t.selectedPaymentInfo.customer.email),e.manualReceiptPage.controls.mobileNo.setValue(t.selectedPaymentInfo.customer.mobileNo),e.addNewPolicyToExist=!0,e.selectedPaymentInfo=t.selectedPaymentInfo):e.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit")),e.commonService.adjustTopScrollBar()})}}},function(t){(0==t.status||JSON.parse(t._body).error)&&e.loginService.checkErrorResponse(t),e.commonService.showErrorMessage(JSON.parse(t._body).message)})}}})},250),[2]})})},e.prototype.submitReceiptForm=function(){return B(this,void 0,void 0,function(){var e=this;return q(this,function(t){return this.blockUI.start("Please wait..."),this.reEnterCorrectEmail(),this.calculateTotalAmount(),setTimeout(function(){if(e.manualReceiptPage.controls.firstName.value&&e.manualReceiptPage.controls.firstName.setValue(e.manualReceiptPage.controls.firstName.value.trim()),e.manualReceiptPage.controls.middleName.value&&e.manualReceiptPage.controls.middleName.setValue(e.manualReceiptPage.controls.middleName.value.trim()),e.manualReceiptPage.controls.lastName.value&&e.manualReceiptPage.controls.lastName.setValue(e.manualReceiptPage.controls.lastName.value.trim()),e.manualReceiptPage.controls.email.value&&e.manualReceiptPage.controls.email.setValue(e.manualReceiptPage.controls.email.value.trim()),e.manualReceiptPage.controls.agentNotes.value&&e.manualReceiptPage.controls.agentNotes.setValue(e.manualReceiptPage.controls.agentNotes.value.trim()),e.manualReceiptPage.controls.cardHolderName.value&&e.manualReceiptPage.controls.cardHolderName.setValue(e.manualReceiptPage.controls.cardHolderName.value.trim()),e.manualReceiptPage.controls.address.value&&e.manualReceiptPage.controls.address.setValue(e.manualReceiptPage.controls.address.value.trim()),e.manualReceiptPage.controls.aprtUntNumber.value&&e.manualReceiptPage.controls.aprtUntNumber.setValue(e.manualReceiptPage.controls.aprtUntNumber.value.trim()),e.paymentErrorMessage=!1,e.customerAvailabilityErrorMessage=!1,e.manualReceiptPage.value.mobileNo){var t=("string"==typeof e.manualReceiptPage.value.mobileNo?e.manualReceiptPage.value.mobileNo.replace(/-/g,""):e.manualReceiptPage.value.mobileNo).toString(),a=("string"==typeof e.manualReceiptPage.value.mobileNo?e.manualReceiptPage.value.mobileNo.replace(/-|_/g,""):e.manualReceiptPage.value.mobileNo).toString();t.length!==a.length&&e.manualReceiptPage.controls.mobileNo.setErrors({"":!0})}if("NEW_BUSINESS"!=e.manualReceiptPage.controls.transactionType.value&&2!=e.manualReceiptPage.controls.transactionType.value||!e.paymentTransactionAdmin||e.manualReceiptPage.controls.policyNumber.setErrors(null),"NEW_BUSINESS"==e.manualReceiptPage.controls.transactionType.value||2==e.manualReceiptPage.controls.transactionType.value?(e.manualReceiptPage.get("heardAboutUs").setValidators([l.Validators.required]),e.manualReceiptPage.get("heardAboutUs").updateValueAndValidity(),e.manualReceiptPage.get("quotedBy").setValidators([l.Validators.required]),e.manualReceiptPage.get("quotedBy").updateValueAndValidity()):(e.manualReceiptPage.get("heardAboutUs").clearValidators(),e.manualReceiptPage.get("heardAboutUs").updateValueAndValidity(),e.manualReceiptPage.get("quotedBy").clearValidators(),e.manualReceiptPage.get("quotedBy").updateValueAndValidity()),(e.isEditable||e.paymentTransactionAdmin)&&(e.manualReceiptPage.get("agent").setValidators([l.Validators.required]),e.manualReceiptPage.get("office").setValidators([l.Validators.required]),e.manualReceiptPage.get("agent").updateValueAndValidity(),e.manualReceiptPage.get("office").updateValueAndValidity()),e.manualReceiptPage.valid)if(e.commonService.showLoadingImageInButton("#btnManualReceiptSubmit"),e.manualReceiptPage.value.card||e.manualReceiptPage.value.cash||e.manualReceiptPage.value.moneyOrder){var n=new V(e.manualReceiptPage.value);n.cardType=e.cardType;var o=new N.a(e.manualReceiptPage.value);if(o.mobileNo=("string"==typeof e.manualReceiptPage.value.mobileNo?e.manualReceiptPage.value.mobileNo.replace(/-/g,""):e.manualReceiptPage.value.mobileNo).toString(),e.manualReceiptPage.value.policyVersion&&e.manualReceiptPage.value.policyVersion.encryptedId){o.encryptedId=e.manualReceiptPage.value.policyVersion.policy.customer.encryptedId;var i=new T.a({encryptedId:e.manualReceiptPage.value.policyVersion.policy.encryptedId,policyNumber:e.manualReceiptPage.value.policyNumber,customer:o});n.policyVersion=new C.a({encryptedId:e.manualReceiptPage.value.policyVersion.encryptedId,notificationMethod:e.manualReceiptPage.value.notificationMethod,heardAboutUs:null!==e.manualReceiptPage.value.heardAboutUs?e.manualReceiptPage.value.heardAboutUs:e.manualReceiptPage.value.policyVersion.heardAboutUs,quotedBy:null!=e.manualReceiptPage.value.quotedBy?e.manualReceiptPage.value.quotedBy:null!=e.manualReceiptPage.value.policyVersion.quotedBy?e.manualReceiptPage.value.policyVersion.quotedBy.id:"",policy:i})}else{o.encryptedId=void 0;i=new T.a({encryptedId:void 0,policyNumber:e.manualReceiptPage.value.policyNumber,customer:o});n.policyVersion=new C.a({encryptedId:void 0,notificationMethod:e.manualReceiptPage.value.notificationMethod,heardAboutUs:e.manualReceiptPage.value.heardAboutUs,quotedBy:e.manualReceiptPage.value.quotedBy,policy:i})}if(e.isEditable||e.paymentTransactionAdmin){for(var r=0;r<e.agents.length;r++)if(e.manualReceiptPage.controls.agent.value==e.agents[r].id){e.agents[r];break}for(r=0;r<e.offices.length;r++)if(e.manualReceiptPage.controls.office.value==e.offices[r].decryptedId){e.offices[r];break}if(e.isEditable||e.paymentTransactionAdmin){if(2!==n.transactionType&&e.isEditable&&null!=e.previousPaymentInfo.policyVersion.heardAboutUs){e.heardAboutUsOldValue=e.heardAboutUsEnumConstants.filter(function(t){return t.name==e.previousPaymentInfo.policyVersion.heardAboutUs});var s=e.heardAboutUsOldValue[0].value;n.policyVersion.heardAboutUs!==s&&(n.policyVersion.heardAboutUs=s)}2!==n.transactionType&&e.isEditable&&null==e.previousPaymentInfo.policyVersion.heardAboutUs&&(n.policyVersion.heardAboutUs=void 0);var c={paymentRequest:n,agent:e.manualReceiptPage.controls.agent.value,office:e.manualReceiptPage.controls.office.value,updatedCreatedDateTime:e.manualReceiptPage.controls.updatedCreatedDateTime.value};e.addNewPolicyToExist&&(c.paymentRequest.policyVersion.policy.customer.encryptedId=e.selectedPaymentInfo.customer.encryptedId,c.paymentRequest.policyVersion.policy.customer.email=e.manualReceiptPage.value.email,c.paymentRequest.policyVersion.policy.customer.mobileNo=("string"==typeof e.manualReceiptPage.value.mobileNo?e.manualReceiptPage.value.mobileNo.replace(/-/g,""):e.manualReceiptPage.value.mobileNo).toString(),c.paymentRequest.policyVersion.policy.customer.firstName=e.selectedPaymentInfo.customer.firstName,c.paymentRequest.policyVersion.policy.customer.lastName=e.selectedPaymentInfo.customer.lastName,c.paymentRequest.policyVersion.policy.customer.middleName=e.selectedPaymentInfo.customer.middleName,c.paymentRequest.policyVersion.policy.customer.suffix=e.selectedPaymentInfo.customer.suffix),e.updateMRTransaction(c)}else{var u=e.commonService.getLoginUserDetails();setTimeout(function(){e.officeId=u.office.id,e.agentId=+u.encryptedId;var t={paymentRequest:n,office:e.officeId,agent:e.agentId,updatedCreatedDateTime:null};e.addNewPolicyToExist&&(t.paymentRequest.policyVersion.policy.customer.encryptedId=e.selectedPaymentInfo.customer.encryptedId,t.paymentRequest.policyVersion.policy.customer.email=e.manualReceiptPage.value.email,t.paymentRequest.policyVersion.policy.customer.mobileNo=("string"==typeof e.manualReceiptPage.value.mobileNo?e.manualReceiptPage.value.mobileNo.replace(/-/g,""):e.manualReceiptPage.value.mobileNo).toString(),t.paymentRequest.policyVersion.policy.customer.firstName=e.selectedPaymentInfo.customer.firstName,t.paymentRequest.policyVersion.policy.customer.lastName=e.selectedPaymentInfo.customer.lastName,t.paymentRequest.policyVersion.policy.customer.middleName=e.selectedPaymentInfo.customer.middleName,t.paymentRequest.policyVersion.policy.customer.suffix=e.selectedPaymentInfo.customer.suffix),e.updateMRTransaction(t)},h.a.SELECT_PICKER_REFRESH_TIME)}}else if(n.policyVersion&&n.policyVersion.policy&&n.policyVersion.policy.customer){var m={paymentRequest:n,premiumDetails:void 0};void 0==e.paymentId||null==e.paymentId?e.manualReceiptService.checkExistingCustomer(n.policyVersion.policy.customer.encryptedId,n.policyVersion.policy.customer.firstName,n.policyVersion.policy.customer.lastName,1,n.policyVersion.policy.policyNumber).subscribe(function(t){if(t&&t.data&&t.data.length>0)if(1==t.data.length&&t.data[0].policyVersion.policy.policyNumber==n.policyVersion.policy.policyNumber){if(console.log("make payment for that policy and exit"),t.data[0]&&t.data[0].policyVersion&&t.data[0].policyVersion.policy&&t.data[0].policyVersion.policy.customer){m.paymentRequest.policyVersion.encryptedId=t.data[0].policyVersion.encryptedId,m.paymentRequest.policyVersion.policy.encryptedId=t.data[0].policyVersion.policy.encryptedId,m.paymentRequest.policyVersion.policy.policyNumber=t.data[0].policyVersion.policy.policyNumber,m.paymentRequest.policyVersion.policy.customer.encryptedId=t.data[0].policyVersion.policy.customer.encryptedId;for(var a=0;a<e.ProductConstant.getNamesAndValuesByInputType().length;a++)if(e.ProductConstant.getNamesAndValuesByInputType()[a].name==t.data[0].product){m.paymentRequest.product=e.ProductConstant.getNamesAndValuesByInputType()[a].value;break}e.finalMakePayment(m)}}else e.addNewPolicyToExist?(m.paymentRequest.policyVersion.policy.customer.encryptedId=e.selectedPaymentInfo.customer.encryptedId,m.paymentRequest.policyVersion.policy.customer.email=e.manualReceiptPage.value.email,m.paymentRequest.policyVersion.policy.customer.mobileNo=("string"==typeof e.manualReceiptPage.value.mobileNo?e.manualReceiptPage.value.mobileNo.replace(/-/g,""):e.manualReceiptPage.value.mobileNo).toString(),m.paymentRequest.policyVersion.policy.customer.firstName=e.selectedPaymentInfo.customer.firstName,m.paymentRequest.policyVersion.policy.customer.lastName=e.selectedPaymentInfo.customer.lastName,m.paymentRequest.policyVersion.policy.customer.middleName=e.selectedPaymentInfo.customer.middleName,m.paymentRequest.policyVersion.policy.customer.suffix=e.selectedPaymentInfo.customer.suffix,e.finalMakePayment(m)):(console.log("Register New Customer and Policy"),e.finalMakePayment(m)),e.commonService.adjustTopScrollBar();else 2!=e.manualReceiptPage.controls.transactionType.value?(console.log("Check if policy exists if not new business"),e.manualReceiptService.fetchPolicyByPolicyNumber(n.policyVersion.policy.policyNumber).subscribe(function(t){if(t&&t.data&&t.data.policyVersion&&t.data.policyVersion.policy&&t.data.customer){e.customerId=t.data.customer.decryptedId,e.policyId=t.data.policyVersion.policy.decryptedId;t.data.policyVersion.policy.policyNumber;var a=t.data.customer.firstName+" "+t.data.customer.lastName,n={backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Policy already exists",message:"Policy "+t.data.policyVersion.policy.policyNumber+" is registered for "+a+" at "+t.data.product+". Should we make payment for "+a+"?",okButton:{label:"Yes"},cancelButton:{label:"No"}}};e.modalService.show(S.a,n).content.onClose.subscribe(function(a){if(a){m.paymentRequest.policyVersion.encryptedId=t.data.policyVersion.encryptedId,m.paymentRequest.policyVersion.policy.encryptedId=t.data.policyVersion.policy.encryptedId,m.paymentRequest.policyVersion.policy.policyNumber=t.data.policyVersion.policy.policyNumber,m.paymentRequest.policyVersion.policy.customer.encryptedId=t.data.customer.encryptedId,m.paymentRequest.policyVersion.policy.customer.email=t.data.customer.email,m.paymentRequest.policyVersion.policy.customer.mobileNo=t.data.customer.mobileNo,m.paymentRequest.policyVersion.policy.customer.firstName=t.data.customer.firstName,m.paymentRequest.policyVersion.policy.customer.lastName=t.data.customer.lastName,m.paymentRequest.policyVersion.policy.customer.middleName=t.data.customer.middleName,m.paymentRequest.policyVersion.policy.customer.suffix=t.data.customer.suffix;for(var n=0;n<e.ProductConstant.getNamesAndValuesByInputType().length;n++)if(e.ProductConstant.getNamesAndValuesByInputType()[n].name==t.data.product){m.paymentRequest.product=e.ProductConstant.getNamesAndValuesByInputType()[n].value;break}e.finalMakePayment(m)}else e.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit")})}},function(t){e.finalMakePayment(m)})):e.finalMakePayment(m)},function(t){e.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit"),e.idleService.isTimeOutWarningDisplayed=!0,(0==t.status||JSON.parse(t._body).error)&&e.loginService.checkErrorResponse(t),e.commonService.showErrorMessage(JSON.parse(t._body).message)}):e.finalMakePayment(m)}}else e.paymentErrorMessage=!0,e.blockUI.stop(),e.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit"),$("html,body").animate({scrollTop:$("#paymentVia").offset().top},"slow");else if(e.blockUI.stop(),!e.manualReceiptPage.valid){var d=Object.keys(e.manualReceiptPage.controls).map(function(t){return e.manualReceiptPage.controls[t]}).filter(function(e){return e.invalid});if(d.length>0){var p=d[0].nativeElement;if(d[0].markAsTouched(),!p)for(var y=0;y<d.length;y++){var g=d[y].nativeElement;if(g&&"radio"==g.type){p=d[y].nativeElement;break}}if(e.manualReceiptPage.controls.customerAvailability.invalid&&"radio"==p.type)return e.customerAvailabilityErrorMessage=!0,e.blockUI.stop(),e.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit"),void $("html,body").animate({scrollTop:$("#paymentVia").offset().top},"slow");if(!(e.manualReceiptPage.value.card||e.manualReceiptPage.value.cash||e.manualReceiptPage.value.moneyOrder||p))return e.paymentErrorMessage=!0,e.blockUI.stop(),e.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit"),void $("html,body").animate({scrollTop:$("#paymentVia").offset().top},"slow");p?p.id&&"moneyOrderReceiptDocument"==p.id?($(p).closest(".muploadimg").addClass("quote-has-error"),$(p).focus(),e.manualReceiptPage.controls.moneyOrderUpload.markAsTouched()):($(p).focus(),setTimeout(function(){$(p).data("selectpicker")&&$(p).data("selectpicker").$button.focus()},100)):d[0]&&d[0].errors&&(d[0].errors.invalidCardType||d[0].errors.invalidCardTypeDiscover)&&$("#card-number").focus()}}},5*h.a.SELECT_PICKER_REFRESH_TIME),[2]})})},e.prototype.finalMakePayment=function(e){var t=this;switch(this.manualReceiptPage.controls.paymentBy.value){case this.paymentByEnumConstants[0].value:e.paymentRequest.moneyOrderAmount=void 0,e.paymentRequest.cashAmount=void 0;break;case this.paymentByEnumConstants[1].value:e.paymentRequest.moneyOrderAmount=void 0;break;case this.paymentByEnumConstants[2].value:e.paymentRequest.cashAmount=void 0;break;case this.paymentByEnumConstants[3].value:this.splitArray.includes(1)&&this.splitArray.includes(2)?e.paymentRequest.moneyOrderAmount=void 0:this.splitArray.includes(1)&&this.splitArray.includes(3)?e.paymentRequest.cashAmount=void 0:e.paymentRequest.cardAmount=void 0}if(this.manualReceiptPage.controls.paymentBy.value==this.paymentByEnumConstants[0].value||this.splitArray.includes(1)||(e.paymentRequest.address=void 0,e.paymentRequest.aprtUntNumber=void 0,e.paymentRequest.city=void 0,e.paymentRequest.stateId=void 0,e.paymentRequest.zipcode=void 0,e.paymentRequest.cardHolderName=void 0,e.paymentRequest.cardNumber=void 0,e.paymentRequest.expiryMonth=void 0,e.paymentRequest.expiryYear=void 0,e.paymentRequest.cvv=void 0),this.saveManualReceiptObservable&&this.saveManualReceiptObservable.unsubscribe(),"NEW_BUSINESS"==this.manualReceiptPage.controls.transactionType.value||2==this.manualReceiptPage.controls.transactionType.value)if(this.manualReceiptPage.controls.paymentBy.value==this.paymentByEnumConstants[0].value||this.splitArray.includes(1))this.saveManualReceiptObservable=this.manualReceiptService.saveManualReceipt(e,this.file,!1).subscribe(function(a){if(t.blockUI.stop(),a.data&&a.data.chaseAuthResponse){var n={backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Enter Policy Number.",okButton:{label:"OK"},cancelButton:{label:"Cancel"},enteredPolicyNumber:t.manualReceiptPage.controls.policyNumber.value?t.manualReceiptPage.controls.policyNumber.value.trim().toUpperCase():t.manualReceiptPage.controls.policyNumber.value}};t.modalService.show(k.a,n).content.onDriverDetailsUpdate.subscribe(function(n){0!=n?(t.blockUI.start("please wait..."),t.manualReceiptService.updatePaymentInfo(e,t.file,a.data.chaseAuthResponse.id,n.policyNumber,!0).subscribe(function(e){t.blockUI.stop(),t.isFormSubmitted=!0,t.router.navigate([h.b.EMPLOYE+"/"+h.b.CUSTOMER_POLICY_PROFILE],{queryParams:{id:e.data.customer.encryptedId,policyId:e.data.policyId}})},function(e){t.blockUI.stop(),t.idleService.isTimeOutWarningDisplayed=!0,(0==e.status||JSON.parse(e._body).error)&&t.loginService.checkErrorResponse(e),t.commonService.showErrorMessage(JSON.parse(e._body).message)}),console.log("capture")):(console.log("void"),t.manualReceiptService.updatePaymentInfo(e,t.file,a.data.chaseAuthResponse.id,n.policyNumber,!1).subscribe(function(e){t.blockUI.stop()},function(e){t.blockUI.stop(),t.idleService.isTimeOutWarningDisplayed=!0,(0==e.status||JSON.parse(e._body).error)&&t.loginService.checkErrorResponse(e),t.commonService.showErrorMessage(JSON.parse(e._body).message)})),console.log(n)}),$("#btnManualReceiptSubmit").removeAttr("disabled"),t.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit")}t.saveManualReceiptObservable.unsubscribe()},function(e){t.blockUI.stop(),t.idleService.isTimeOutWarningDisplayed=!0,(0==e.status||JSON.parse(e._body).error)&&t.loginService.checkErrorResponse(e),t.commonService.showErrorMessage(JSON.parse(e._body).message),t.saveManualReceiptObservable.unsubscribe(),t.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit")});else{this.blockUI.stop();var a={backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Enter Policy Number.",okButton:{label:"OK"},cancelButton:{label:"Cancel"},enteredPolicyNumber:void 0!=this.manualReceiptPage.controls.policyNumber.value?this.manualReceiptPage.controls.policyNumber.value.trim().toUpperCase():""}};this.modalService.show(k.a,a).content.onDriverDetailsUpdate.subscribe(function(a){0!=a?(t.blockUI.start("please wait..."),t.saveManualReceiptObservable=t.manualReceiptService.updatePaymentInfo(e,t.file,"",a.policyNumber,!0).subscribe(function(e){t.blockUI.stop(),t.isFormSubmitted=!0,t.router.navigate([h.b.EMPLOYE+"/"+h.b.CUSTOMER_POLICY_PROFILE],{queryParams:{id:e.data.customer.encryptedId,policyId:e.data.policyId}}),t.saveManualReceiptObservable.unsubscribe()},function(e){t.blockUI.stop(),t.idleService.isTimeOutWarningDisplayed=!0,(0==e.status||JSON.parse(e._body).error)&&t.loginService.checkErrorResponse(e),t.commonService.showErrorMessage(JSON.parse(e._body).message),t.saveManualReceiptObservable.unsubscribe()}),console.log("capture")):(console.log("void"),t.blockUI.stop(),$("#btnManualReceiptSubmit").removeAttr("disabled"),t.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit")),console.log(a)})}else this.saveManualReceiptObservable=this.manualReceiptService.saveManualReceiptWithOutNewBusiness(e,this.file,!0).subscribe(function(e){if(t.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit"),t.blockUI.stop(),e.data&&e.data.encryptedId)if(e.message&&-1!=e.message.indexOf("Payment has been captured successfully. System cant make payment")){var a={backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Warning",message:e.message,messageIcon:{icon:"fa fa-lg fa-exclamation-triangle"},okButton:{label:"Ok"}}};t.modalService.show(S.a,a).content.onClose.subscribe(function(a){t.isFormSubmitted=!0,t.router.navigate([h.b.EMPLOYE+"/"+h.b.CUSTOMER_POLICY_PROFILE],{queryParams:{id:e.data.customer.encryptedId,policyId:e.data.policyId}})})}else t.isFormSubmitted=!0,t.router.navigate([h.b.EMPLOYE+"/"+h.b.CUSTOMER_POLICY_PROFILE],{queryParams:{id:e.data.customer.encryptedId,policyId:e.data.policyId}});else console.error(e);t.saveManualReceiptObservable.unsubscribe()},function(e){t.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit"),t.blockUI.stop(),t.idleService.isTimeOutWarningDisplayed=!0,(0==e.status||JSON.parse(e._body).error)&&t.loginService.checkErrorResponse(e),t.commonService.showErrorMessage(JSON.parse(e._body).message),t.saveManualReceiptObservable.unsubscribe()})},e.prototype.calculateTotalAmount=function(){var e=this;setTimeout(function(){e.moneyOrder&&e.cashDetails&&(e.totalAmount=parseFloat(e.manualReceiptPage.controls.cashAmount.value?e.manualReceiptPage.controls.cashAmount.value:"0")+parseFloat(e.manualReceiptPage.controls.moneyOrderAmount.value?e.manualReceiptPage.controls.moneyOrderAmount.value:"0"));var t=parseFloat(e.manualReceiptPage.controls.amount.value?e.manualReceiptPage.controls.amount.value:"0"),a=void 0,n=void 0;switch(e.manualReceiptPage.controls.paymentBy.value){case e.paymentByEnumConstants[0].value:a=e.manualReceiptPage.controls.cardAmount,n=parseFloat(e.manualReceiptPage.controls.cardAmount.value?e.manualReceiptPage.controls.cardAmount.value:"0");break;case e.paymentByEnumConstants[1].value:a=e.manualReceiptPage.controls.cashAmount,n=parseFloat(e.manualReceiptPage.controls.cashAmount.value?e.manualReceiptPage.controls.cashAmount.value:"0");break;case e.paymentByEnumConstants[2].value:a=e.manualReceiptPage.controls.moneyOrderAmount,n=parseFloat(e.manualReceiptPage.controls.moneyOrderAmount.value?e.manualReceiptPage.controls.moneyOrderAmount.value:"0");break;case e.paymentByEnumConstants[3].value:if(e.splitArray.includes(1)&&e.splitArray.includes(2)){a=e.manualReceiptPage.controls.cardAmount;e.manualReceiptPage.controls.cardAmount.value,e.manualReceiptPage.controls.cashAmount.value;n=parseFloat(e.manualReceiptPage.controls.cardAmount.value?e.manualReceiptPage.controls.cardAmount.value:"0")+parseFloat(e.manualReceiptPage.controls.cashAmount.value?e.manualReceiptPage.controls.cashAmount.value:"0");break}if(e.splitArray.includes(1)&&e.splitArray.includes(3)){a=e.manualReceiptPage.controls.cardAmount;e.manualReceiptPage.controls.cardAmount.value,e.manualReceiptPage.controls.moneyOrderAmount.value;n=parseFloat(e.manualReceiptPage.controls.cardAmount.value?e.manualReceiptPage.controls.cardAmount.value:"0")+parseFloat(e.manualReceiptPage.controls.moneyOrderAmount.value?e.manualReceiptPage.controls.moneyOrderAmount.value:"0");break}a=e.manualReceiptPage.controls.cashAmount;e.manualReceiptPage.controls.cashAmount.value,e.manualReceiptPage.controls.moneyOrderAmount.value;n=parseFloat(e.manualReceiptPage.controls.cashAmount.value?e.manualReceiptPage.controls.cashAmount.value:"0")+parseFloat(e.manualReceiptPage.controls.moneyOrderAmount.value?e.manualReceiptPage.controls.moneyOrderAmount.value:"0")}if(t>+(n=n?n.toFixed(2):n))a.setErrors({invalidAmount:"Amount must be equal to total collected amount."}),a.markAsTouched();else if(t<+n){e.modalService.show(S.a,{backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Confirmation",message:"Entered amount is greater than total collected amount. Do you want to update total collected amount?",okButton:{label:"OK"},cancelButton:{label:"NO"}}}).content.onClose.subscribe(function(t){t&&1==t?(e.manualReceiptPage.controls.amount.setValue((+n).toFixed(2)),e.verifyTotalAndPremiumAmount(),e.totalCollecatedAmountByUser=e.manualReceiptPage.controls.amount.value):(a.setErrors({invalidAmount:"Amount must be equal to total collected amount."}),a.markAsTouched())})}else{if(a){var o=a.errors;o&&o.invalidAmount&&(1==Object.keys(o).length?o=void 0:delete o.invalidAmount),a.setErrors(o)}e.splitArray.includes(1)&&+e.manualReceiptPage.controls.cardAmount.value<+h.a.MIN_CARD_AMOUNT&&e.minimumCardAmountValidation()}},h.a.SELECT_PICKER_REFRESH_TIME)},e.prototype.editCashAmountBlur=function(){var e=this.manualReceiptPage.controls.cashAmount.value,t=this.manualReceiptPage.controls.amount.value;this.splitArray.includes(1)?this.manualReceiptPage.controls.cashAmount.valid&&(+t>+e?(this.manualReceiptPage.controls.cashAmount.setValue((+e).toFixed(2)),this.manualReceiptPage.controls.cardAmount.setValue((+t-+e).toFixed(2))):this.manualReceiptPage.controls.cardAmount.setValue(void 0)):this.manualReceiptPage.controls.cashAmount.valid&&(+t>+e?(this.manualReceiptPage.controls.cashAmount.setValue((+e).toFixed(2)),this.manualReceiptPage.controls.moneyOrderAmount.setValue((+t-+e).toFixed(2))):this.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0))},e.prototype.editMoneyOrderAmountBlur=function(){var e=this.manualReceiptPage.controls.moneyOrderAmount.value,t=this.manualReceiptPage.controls.amount.value;this.splitArray.includes(1)?this.manualReceiptPage.controls.moneyOrderAmount.valid&&(+t>+e?(this.manualReceiptPage.controls.cardAmount.setValue((+t-+e).toFixed(2)),this.manualReceiptPage.controls.moneyOrderAmount.setValue((+e).toFixed(2))):this.manualReceiptPage.controls.cardAmount.setValue(void 0)):this.manualReceiptPage.controls.moneyOrderAmount.valid&&(+t>+e?(this.manualReceiptPage.controls.cashAmount.setValue((+t-+e).toFixed(2)),this.manualReceiptPage.controls.moneyOrderAmount.setValue((+e).toFixed(2))):this.manualReceiptPage.controls.cashAmount.setValue(void 0))},e.prototype.editCardAmountBlur=function(){var e=this.manualReceiptPage.controls.cardAmount.value,t=this.manualReceiptPage.controls.amount.value;this.manualReceiptPage.controls.cardAmount.valid&&(this.splitArray.includes(2)?+t>+e?(this.manualReceiptPage.controls.cashAmount.setValue((+t-+e).toFixed(2)),this.manualReceiptPage.controls.cardAmount.setValue((+e).toFixed(2))):this.manualReceiptPage.controls.cashAmount.setValue(void 0):this.splitArray.includes(3)&&(+t>+e?(this.manualReceiptPage.controls.moneyOrderAmount.setValue((+t-+e).toFixed(2)),this.manualReceiptPage.controls.cardAmount.setValue((+e).toFixed(2))):this.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0)))},e.prototype.fileOnchangeEvent=function(e){var t=this;if(e.currentTarget.files&&e.currentTarget.files[0])if(e.currentTarget.files[0].size>h.a.MAX_FILE_UPLOAD_SIZE_LIMIT){this.modalService.show(S.a,{backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"File size too large!!",message:"Maximum file upload size is 4mb.",closeButton:{label:"close"},okButton:{label:"Ok"}}}).content.onClose.subscribe(function(e){t.file=void 0,t.manualReceiptPage.controls.moneyOrderUpload.setValue(void 0),$("#moneyOrderReceiptDocument")&&$("#moneyOrderReceiptDocument")[0]&&($("#moneyOrderReceiptDocument")[0].value="")})}else{if(!e.target)return;this.file=e.target.files[0]}},e.prototype.initValidatorJquery=function(){var e=this;setTimeout(function(){var t=e;void 0!=$("#card-number")[0]&&$("#card-number").validateCreditCard(function(a){var n=!1;if(t.manualReceiptPage&&(null!=a.card_type?"visa"==a.card_type.name||"visa_electron"==a.card_type.name?(t.selectedCardString="visa"==a.card_type.name?t.visaCardIconString:t.visaElectronCardIconString,e.cardType="1",n=!0):"mastercard"==a.card_type.name?(t.selectedCardString=t.masterCardIconString,e.cardType="0",n=!0):"discover"==a.card_type.name?(t.selectedCardString=t.discoverCardIconString,e.cardType="2",n=!0,e.validateDiscoverCardTypeForManualReceiptPage(!1)):(t.selectedCardString=void 0,e.cardType=null):t.selectedCardString=void 0),n){var o=t.manualReceiptPage.controls.cardNumber.errors;o&&o.invalidCardType&&(1==Object.keys(o).length?o=void 0:delete o.invalidCardType),t.manualReceiptPage.controls.cardNumber.setErrors(o)}else t.isShowCardNumber=!1,(t.creditCardInfoDetails||t.manualReceiptPage.controls.cardNumber.value)&&(t.manualReceiptPage.controls.cardNumber.setErrors({invalidCardType:!0}),$("#card-number")[0].focus())}),e.paymentTransactionAdmin&&e.removeCardValidations()},1e3)},e.prototype.checkCardNumber=function(e){return!(!e.key.match(this.numericPattern)&&"8"!=e.which&&"9"!=e.keyCode&&"27"!=e.keyCode&&"46"!=e.keyCode&&"37"!=e.keyCode&&"39"!=e.keyCode)},e.prototype.onCardNumberEnter=function(e){if(this.manualReceiptPage.controls.cardNumber.valid){var t=this.manualReceiptPage.controls.cardNumber.value;this.cardXMask="XXXX-XXXX-XXXX-"+t.substr(12)}},e.prototype.onCardNumberBlur=function(){this.manualReceiptPage.controls.cardNumber.valid&&(this.isShowCardNumber=!0)},e.prototype.editCardNumber=function(){var e=this;this.isShowCardNumber=!1,setTimeout(function(){$("#card-number").focus(),e.initValidatorJquery()},500)},e.prototype.openShowCardCvvInfo=function(e){this.isShowCardCvvInfo=!this.isShowCardCvvInfo,e.stopPropagation(),e.preventDefault()},e.prototype.closeShowCardCvvInfo=function(e){console.log(new Date),this.isShowCardCvvInfo=!1},e.prototype.detectProduct=function(){},e.prototype.checkTotalAmountAndPremiumAmount=function(){var e=this;this.verifyTotalAndPremiumAmount(),this.manualReceiptPage.controls.amount.value&&this.manualReceiptPage.controls.amount.setValue("NaN"!=(+this.manualReceiptPage.controls.amount.value).toFixed(2)?(+this.manualReceiptPage.controls.amount.value).toFixed(2):0),this.manualReceiptPage.controls.premiumAmount.value&&this.manualReceiptPage.controls.premiumAmount.setValue("NaN"!=(+this.manualReceiptPage.controls.premiumAmount.value).toFixed(2)?(+this.manualReceiptPage.controls.premiumAmount.value).toFixed(2):0),setTimeout(function(){if(e.manualReceiptPage.controls.amount.value&&e.manualReceiptPage.controls.premiumAmount.value)if(parseFloat(e.manualReceiptPage.controls.amount.value)<parseFloat(e.manualReceiptPage.controls.premiumAmount.value))e.manualReceiptPage.controls.amount.setErrors({invalidTotalAmount:!0}),e.manualReceiptPage.controls.amount.markAsTouched();else{var t=e.manualReceiptPage.controls.amount.errors;t&&t.invalidTotalAmount&&(1==Object.keys(t).length?t=void 0:delete t.invalidTotalAmount),e.manualReceiptPage.controls.amount.setErrors(t),parseFloat(e.manualReceiptPage.controls.amount.value)<=0&&!e.paymentTransactionAdmin&&e.setValidatorOnAmount({min:{min:+e.totalAmount}}),e.manualReceiptPage.controls.paymentBy.value==e.paymentByEnumConstants[1].value?(e.manualReceiptPage.controls.cashAmount.setValue((+e.manualReceiptPage.controls.amount.value).toFixed(2)),e.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0),e.manualReceiptPage.controls.cardAmount.setValue(void 0),e.totalAmount=e.manualReceiptPage.controls.amount.value):e.manualReceiptPage.controls.paymentBy.value==e.paymentByEnumConstants[2].value?(e.manualReceiptPage.controls.moneyOrderAmount.setValue((+e.manualReceiptPage.controls.amount.value).toFixed(2)),e.manualReceiptPage.controls.cashAmount.setValue(void 0),e.manualReceiptPage.controls.cardAmount.setValue(void 0),e.totalAmount=e.manualReceiptPage.controls.amount.value):e.manualReceiptPage.controls.paymentBy.value==e.paymentByEnumConstants[0].value?(e.manualReceiptPage.controls.cardAmount.setValue((+e.manualReceiptPage.controls.amount.value).toFixed(2)),e.manualReceiptPage.controls.cashAmount.setValue(void 0),e.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0),e.totalAmount=e.manualReceiptPage.controls.amount.value):e.manualReceiptPage.controls.paymentBy.value==e.paymentByEnumConstants[3].value&&(e.splitArray.includes(1)&&(e.splitArray.includes(2)||e.splitArray.includes(3))?(e.manualReceiptPage.controls.cardAmount.setValue((+e.manualReceiptPage.controls.amount.value).toFixed(2)),e.manualReceiptPage.controls.cashAmount.setValue(void 0),e.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0),e.totalAmount=e.manualReceiptPage.controls.amount.value):(null!=e.manualReceiptPage.controls.moneyOrderAmount.value&&void 0!=e.manualReceiptPage.controls.moneyOrderAmount.value&&0!=e.manualReceiptPage.controls.moneyOrderAmount.value&&""!=e.manualReceiptPage.controls.moneyOrderAmount.value&&+e.manualReceiptPage.controls.moneyOrderAmount.value<+e.manualReceiptPage.controls.amount.value?+e.manualReceiptPage.controls.amount.value<+e.manualReceiptPage.controls.moneyOrderAmount.value?(e.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0),e.manualReceiptPage.controls.cashAmount.setValue((+e.manualReceiptPage.controls.amount.value).toFixed(2))):e.manualReceiptPage.controls.cashAmount.setValue((+e.manualReceiptPage.controls.amount.value-+e.manualReceiptPage.controls.moneyOrderAmount.value).toFixed(2)):(e.manualReceiptPage.controls.cashAmount.setValue((+e.manualReceiptPage.controls.amount.value).toFixed(2)),e.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0)),e.totalAmount=e.manualReceiptPage.controls.amount.value))}if(e.manualReceiptPage.controls.amount.value&&e.manualReceiptPage.controls.premiumAmount.value&&0!==e.manualReceiptPage.controls.product.value&&!e.paymentTransactionAdmin){if(null!=e.manualReceiptPage.controls.transactionType.value&&""!==e.manualReceiptPage.controls.transactionType.value&&0==e.manualReceiptPage.controls.transactionType.value)if(parseFloat(e.manualReceiptPage.controls.amount.value)<=parseFloat(e.manualReceiptPage.controls.premiumAmount.value))e.setValidatorOnTotalCollectedAmount({amountShouldBeGreterThanPremium:!0});else(a=e.manualReceiptPage.controls.amount).hasError("amountShouldBeGreterThanPremium")&&delete a.errors.amountShouldBeGreterThanPremium,e.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(a.errors)?void 0:a.errors);else if(null!=e.manualReceiptPage.controls.transactionType.value&&""!==e.manualReceiptPage.controls.transactionType.value){if(parseFloat(e.manualReceiptPage.controls.amount.value)<parseFloat(e.manualReceiptPage.controls.premiumAmount.value))e.setValidatorOnTotalCollectedAmount({invalidTotalAmount:!0});else(a=e.manualReceiptPage.controls.amount).hasError("amountShouldBeGreterThanPremium")&&delete a.errors.amountShouldBeGreterThanPremium,a.hasError("invalidTotalAmount")&&delete a.errors.invalidTotalAmount,e.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(a.errors)?void 0:a.errors)}else{var a;(a=e.manualReceiptPage.controls.amount).hasError("amountShouldBeGreterThanPremium")&&delete a.errors.amountShouldBeGreterThanPremium,e.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(a.errors)?void 0:a.errors)}if(3!=e.manualReceiptPage.controls.product.value&&8!=e.manualReceiptPage.controls.product.value&&35!=e.manualReceiptPage.controls.product.value&&38!=e.manualReceiptPage.controls.product.value&&12!=e.manualReceiptPage.controls.product.value||null==e.lateFees)(a=e.manualReceiptPage.controls.amount).hasError("min")&&"0.00"!=e.manualReceiptPage.controls.amount.value&&delete a.errors.min,e.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(a.errors)?void 0:a.errors);else if(null==e.manualReceiptPage.controls.transactionType.value||""===e.manualReceiptPage.controls.transactionType.value||0!=e.manualReceiptPage.controls.transactionType.value&&5!=e.manualReceiptPage.controls.transactionType.value)(a=e.manualReceiptPage.controls.amount).hasError("min")&&"0.00"!=e.manualReceiptPage.controls.amount.value&&delete a.errors.min,e.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(a.errors)?void 0:a.errors);else if(parseFloat(e.lateFees.toString())>parseFloat(e.manualReceiptPage.controls.amount.value)-parseFloat(e.manualReceiptPage.controls.premiumAmount.value))e.setValidatorOnTotalCollectedAmount({min:{min:parseFloat(e.manualReceiptPage.controls.premiumAmount.value)+parseFloat(e.lateFees.toString())}});else(a=e.manualReceiptPage.controls.amount).hasError("min")&&"0.00"!=e.manualReceiptPage.controls.amount.value&&delete a.errors.min,e.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(a.errors)?void 0:a.errors)}if(e.manualReceiptPage.controls.amount.dirty&&e.manualReceiptPage.controls.amount.valid&&(e.verifyTotalAndPremiumAmount(),e.totalCollecatedAmountByUser=parseFloat(e.manualReceiptPage.controls.amount.value),e.updatePaymentTransactionFees()),e.manualReceiptPage.controls.premiumAmount.dirty&&e.manualReceiptPage.controls.premiumAmount.valid&&!e.paymentTransactionAdmin){if(e.renewalFeeAmount>0)parseFloat(e.manualReceiptPage.controls.amount.value)+parseFloat(e.transactionAmount.toString())+parseFloat(e.renewalFeeAmount.toString())<parseFloat(e.manualReceiptPage.controls.premiumAmount.value)&&(e.verifyTotalAndPremiumAmount(),e.totalCollecatedAmountByUser=parseFloat(e.manualReceiptPage.controls.premiumAmount.value));else parseFloat(e.manualReceiptPage.controls.amount.value)-+e.transactionAmount<parseFloat(e.manualReceiptPage.controls.premiumAmount.value)&&(e.verifyTotalAndPremiumAmount(),e.totalCollecatedAmountByUser=parseFloat(e.manualReceiptPage.controls.premiumAmount.value));e.updateTotalCollecationAmount(),e.updatePaymentTransactionFees()}if(e.paymentTransactionAdmin||e.setValidatorOfPolicyNumber(),null!=e.manualReceiptPage.controls.transactionType.value&&""!==e.manualReceiptPage.controls.transactionType.value&&0==e.manualReceiptPage.controls.transactionType.value||1==e.manualReceiptPage.controls.transactionType.value||5==e.manualReceiptPage.controls.transactionType.value)if(!e.manualReceiptPage.controls.premiumAmount.value||void 0==e.premiumAmount||0!=e.manualReceiptPage.controls.product.value&&3!=e.manualReceiptPage.controls.product.value&&8!=e.manualReceiptPage.controls.product.value&&35!=e.manualReceiptPage.controls.product.value&&38!=e.manualReceiptPage.controls.product.value&&12!=e.manualReceiptPage.controls.product.value||e.paymentTransactionAdmin)(n=e.manualReceiptPage.controls.premiumAmount).hasError("min")&&delete n.errors.min,e.setValidatorOnPremiumAmount("{}"==JSON.stringify(n.errors)?void 0:n.errors);else if(+e.premiumAmount>parseFloat(e.manualReceiptPage.controls.premiumAmount.value)){var n=e.manualReceiptPage.controls.premiumAmount;e.setValidatorOnPremiumAmount({min:{min:+e.premiumAmount}})}else{(n=e.manualReceiptPage.controls.premiumAmount).hasError("min")&&delete n.errors.min,e.setValidatorOnPremiumAmount("{}"==JSON.stringify(n.errors)?void 0:n.errors)}else(n=e.manualReceiptPage.controls.premiumAmount).hasError("min")&&delete n.errors.min,e.setValidatorOnPremiumAmount("{}"==JSON.stringify(n.errors)?void 0:n.errors);if(e.initValidatorJquery(),e.splitArray.includes(1)&&(e.isShowCardNumber=!0),e.checkTransactionTypeForPremiumZero()&&parseFloat(e.manualReceiptPage.controls.amount.value)<=0&&e.setValidatorOnAmount({min:{min:+e.totalAmount}}),e.checkTransactionTypeForPremiumZero()?(e.manualReceiptPage.get("premiumAmount").setValidators([l.Validators.required,l.Validators.pattern(e.amountPattern),l.Validators.max(999999.999),l.Validators.min(0)]),e.manualReceiptPage.get("premiumAmount").updateValueAndValidity()):(e.manualReceiptPage.get("premiumAmount").setValidators([l.Validators.required,l.Validators.pattern(e.amountPattern),l.Validators.max(999999.999),l.Validators.min(1)]),e.manualReceiptPage.get("premiumAmount").updateValueAndValidity()),!e.paymentTransactionAdmin&&(1==e.manualReceiptPage.controls.transactionType.value||0==e.manualReceiptPage.controls.transactionType.value||5==e.manualReceiptPage.controls.transactionType.value)&&+e.premiumAmount>parseFloat(e.manualReceiptPage.controls.premiumAmount.value)&&!e.checkTransactionTypeForPremiumZero()){n=e.manualReceiptPage.controls.premiumAmount;e.setValidatorOnPremiumAmount({min:{min:+e.premiumAmount}})}if(e.fullPayAmount&&parseFloat(e.manualReceiptPage.controls.premiumAmount.value)>e.fullPayAmount&&!e.zeroFullPayAmount&&!e.isPolicyIsCancelled&&(0==e.manualReceiptPage.controls.transactionType.value||1==e.manualReceiptPage.controls.transactionType.value||5==e.manualReceiptPage.controls.transactionType.value)&&!e.checkTransactionTypeForPremiumZero()){n=e.manualReceiptPage.controls.premiumAmount;e.setValidatorOnPremiumAmount({max:{max:+e.fullPayAmount}})}e.updateRenewalFeeWithTotalCollecationAmount()},h.a.SELECT_PICKER_REFRESH_TIME)},e.prototype.resetPaymentViaItems=function(){this.manualReceiptPage.controls.address.reset(),this.manualReceiptPage.controls.aprtUntNumber.reset(),this.manualReceiptPage.controls.city.reset(),this.manualReceiptPage.controls.stateId.reset(),this.manualReceiptPage.controls.zipcode.reset(),this.manualReceiptPage.controls.cardHolderName.reset(),this.manualReceiptPage.controls.cardNumber.reset(),this.manualReceiptPage.controls.expiryMonth.reset(),this.manualReceiptPage.controls.expiryYear.reset(),this.manualReceiptPage.controls.cvv.reset(),this.manualReceiptPage.controls.moneyOrderAmount.reset(),this.manualReceiptPage.controls.cashAmount.reset(),this.manualReceiptPage.controls.moneyOrderUpload.reset(),this.isShowCardNumber=!1,this.selectedCardString=void 0},e.prototype.removeFile=function(){var e=this;this.modalService.show(S.a,{backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Confirmation",message:"Do you want to remove this file?",okButton:{label:"YES"},cancelButton:{label:"NO"}}}).content.onClose.subscribe(function(t){t&&1==t&&(e.file=void 0,e.manualReceiptPage.controls.moneyOrderUpload.setValue(void 0),$("#moneyOrderReceiptDocument")&&$("#moneyOrderReceiptDocument")[0]&&($("#moneyOrderReceiptDocument")[0].value=""))})},e.prototype.setValidatorOfPolicyNumber=function(){if("NEW_BUSINESS"==this.manualReceiptPage.controls.transactionType.value||2==this.manualReceiptPage.controls.transactionType.value?(this.manualReceiptPage.get("policyNumber").clearValidators(),this.manualReceiptPage.get("policyNumber").updateValueAndValidity()):(this.manualReceiptPage.get("policyNumber").setValidators([l.Validators.required,this.noWhitespaceValidator]),this.manualReceiptPage.get("policyNumber").updateValueAndValidity()),this.checkTransactionTypeForPremiumZero()?(this.manualReceiptPage.get("premiumAmount").setValidators([l.Validators.required,l.Validators.pattern(this.amountPattern),l.Validators.max(999999.999),l.Validators.min(0)]),this.manualReceiptPage.get("premiumAmount").updateValueAndValidity()):(this.manualReceiptPage.get("premiumAmount").setValidators([l.Validators.required,l.Validators.pattern(this.amountPattern),l.Validators.max(999999.999),l.Validators.min(1)]),this.manualReceiptPage.get("premiumAmount").updateValueAndValidity()),this.manualReceiptPage.controls.premiumAmount.value&&this.collectedAmount){if(0==this.manualReceiptPage.controls.transactionType.value||1==this.manualReceiptPage.controls.transactionType.value){var e=this.productEnumConstants[this.manualReceiptPage.controls.product.value].name;this.zeroPremiumAMount||(console.log(e),0==this.manualReceiptPage.controls.transactionType.value&&("AAAA"!=e&&parseFloat(this.manualReceiptPage.controls.amount.value)-this.transactionAmount==parseFloat(this.manualReceiptPage.controls.premiumAmount.value)?(this.lateFees?this.manualReceiptPage.controls.amount.setValue((parseFloat(this.manualReceiptPage.controls.premiumAmount.value)+parseFloat(this.lateFees.toString())).toFixed(2)):this.manualReceiptPage.controls.transactionType.setValue(1),$(".selectpicker").selectpicker("refresh")):"AAAA"!=e&&parseFloat(this.manualReceiptPage.controls.amount.value)<parseFloat(this.manualReceiptPage.controls.premiumAmount.value)&&(this.lateFees?this.manualReceiptPage.controls.amount.setValue((parseFloat(this.manualReceiptPage.controls.premiumAmount.value)+parseFloat(this.lateFees.toString())).toFixed(2)):(this.manualReceiptPage.controls.transactionType.setValue(1),this.manualReceiptPage.controls.amount.setValue(parseFloat(this.manualReceiptPage.controls.premiumAmount.value).toFixed(2))),$(".selectpicker").selectpicker("refresh")),this.isPremiumAmountReadOnly=!0),1!=this.manualReceiptPage.controls.transactionType.value||this.paymentTransactionAdmin||(parseFloat(this.manualReceiptPage.controls.amount.value)-this.transactionAmount>parseFloat(this.manualReceiptPage.controls.premiumAmount.value)&&(this.isRenewal&&!this.isPolicyRenewed?this.manualReceiptPage.controls.transactionType.setValue(5):this.manualReceiptPage.controls.transactionType.setValue(0),$(".selectpicker").selectpicker("refresh")),this.isPremiumAmountReadOnly=!0))}else this.isPremiumAmountReadOnly=!1;if(0!=this.manualReceiptPage.controls.product.value&&!this.paymentTransactionAdmin)if(3!=this.manualReceiptPage.controls.product.value&&8!=this.manualReceiptPage.controls.product.value&&35!=this.manualReceiptPage.controls.product.value&&38!=this.manualReceiptPage.controls.product.value&&12!=this.manualReceiptPage.controls.product.value||null==this.lateFees)(t=this.manualReceiptPage.controls.amount).hasError("min")&&"0.00"!=this.manualReceiptPage.controls.amount.value&&delete t.errors.min,this.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(t.errors)?void 0:t.errors);else if(null==this.manualReceiptPage.controls.transactionType.value||""===this.manualReceiptPage.controls.transactionType.value||0!=this.manualReceiptPage.controls.transactionType.value&&5!=this.manualReceiptPage.controls.transactionType.value)(t=this.manualReceiptPage.controls.amount).hasError("min")&&"0.00"!=this.manualReceiptPage.controls.amount.value&&delete t.errors.min,this.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(t.errors)?void 0:t.errors);else if(parseFloat(this.lateFees.toString())>parseFloat(this.manualReceiptPage.controls.amount.value)-parseFloat(this.manualReceiptPage.controls.premiumAmount.value))this.setValidatorOnTotalCollectedAmount({min:{min:parseFloat(this.manualReceiptPage.controls.premiumAmount.value)+parseFloat(this.lateFees.toString())}});else(t=this.manualReceiptPage.controls.amount).hasError("min")&&"0.00"!=this.manualReceiptPage.controls.amount.value&&delete t.errors.min,this.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(t.errors)?void 0:t.errors)}if(this.checkManualReceiptPageDynamicCondition()?(this.showMakePaymentWarning=!0,this.makePaymentWarning="Please make sure you post this payment at "+this.ProductConstant.getProductModelByProduct(this.productEnumConstants[this.manualReceiptPage.controls.product.value].name).label+" as well to complete the transaction."):this.showMakePaymentWarning=!1,this.manualReceiptPage.controls.amount.value&&this.manualReceiptPage.controls.premiumAmount.value&&0!==this.manualReceiptPage.controls.product.value&&!this.paymentTransactionAdmin)if(null!=this.manualReceiptPage.controls.transactionType.value&&""!==this.manualReceiptPage.controls.transactionType.value&&0==this.manualReceiptPage.controls.transactionType.value)parseFloat(this.manualReceiptPage.controls.amount.value)<=parseFloat(this.manualReceiptPage.controls.premiumAmount.value)?this.setValidatorOnTotalCollectedAmount({amountShouldBeGreterThanPremium:!0}):((t=this.manualReceiptPage.controls.amount).hasError("amountShouldBeGreterThanPremium")&&delete t.errors.amountShouldBeGreterThanPremium,this.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(t.errors)?void 0:t.errors));else if(null!=this.manualReceiptPage.controls.transactionType.value&&""!==this.manualReceiptPage.controls.transactionType.value){if(parseFloat(this.manualReceiptPage.controls.amount.value)<parseFloat(this.manualReceiptPage.controls.premiumAmount.value))this.setValidatorOnTotalCollectedAmount({invalidTotalAmount:!0});else(t=this.manualReceiptPage.controls.amount).hasError("amountShouldBeGreterThanPremium")&&delete t.errors.amountShouldBeGreterThanPremium,t.hasError("invalidTotalAmount")&&delete t.errors.invalidTotalAmount,this.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(t.errors)?void 0:t.errors)}else{var t;(t=this.manualReceiptPage.controls.amount).hasError("amountShouldBeGreterThanPremium")&&delete t.errors.amountShouldBeGreterThanPremium,this.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(t.errors)?void 0:t.errors)}this.validateDiscoverCardTypeForManualReceiptPage(!0),"AAAA"==this.productEnumConstants[this.manualReceiptPage.controls.product.value].name||!this.lateFees||this.zeroFullPayAmount||this.isPolicyIsCancelled||1!=this.manualReceiptPage.controls.transactionType.value&&(5!=this.manualReceiptPage.controls.transactionType.value||"UNITED_AUTO"==this.productEnumConstants[this.manualReceiptPage.controls.product.value].name||"WINDHAVEN"==this.productEnumConstants[this.manualReceiptPage.controls.product.value].name||"FALCON"==this.productEnumConstants[this.manualReceiptPage.controls.product.value].name)||this.manualReceiptPage.controls.transactionType.setValue(0)},e.prototype.setValidatorOfTransactionType=function(){if("NEW_BUSINESS"==this.manualReceiptPage.controls.transactionType.value||2==this.manualReceiptPage.controls.transactionType.value?(this.manualReceiptPage.get("policyNumber").clearValidators(),this.manualReceiptPage.get("policyNumber").updateValueAndValidity(),this.manualReceiptPage.get("heardAboutUs").setValidators([l.Validators.required]),this.manualReceiptPage.get("heardAboutUs").updateValueAndValidity(),setTimeout(function(){$(".selectpicker").selectpicker({selectOnTab:!0}),$(".selectpicker").selectpicker("refresh")},50)):(this.manualReceiptPage.get("policyNumber").setValidators([l.Validators.required,this.noWhitespaceValidator]),this.manualReceiptPage.get("policyNumber").updateValueAndValidity(),this.manualReceiptPage.get("heardAboutUs").clearValidators(),this.manualReceiptPage.get("heardAboutUs").updateValueAndValidity()),this.checkTransactionTypeForPremiumZero()?(this.manualReceiptPage.get("premiumAmount").setValidators([l.Validators.required,l.Validators.pattern(this.amountPattern),l.Validators.max(999999.999),l.Validators.min(0)]),this.manualReceiptPage.get("premiumAmount").updateValueAndValidity()):(this.manualReceiptPage.get("premiumAmount").setValidators([l.Validators.required,l.Validators.pattern(this.amountPattern),l.Validators.max(999999.999),l.Validators.min(1)]),this.manualReceiptPage.get("premiumAmount").updateValueAndValidity()),this.checkTotalAndPremiumIsSameAndPaymentByIsCreditCard(),this.checkManualReceiptPageDynamicCondition()?(this.showMakePaymentWarning=!0,this.makePaymentWarning="Please make sure you post this payment at "+this.ProductConstant.getProductModelByProduct(this.productEnumConstants[this.manualReceiptPage.controls.product.value].name).label+" as well to complete the transaction."):this.showMakePaymentWarning=!1,this.manualReceiptPage.controls.premiumAmount.value&&this.paymentId&&this.collectedAmount)if(0==this.manualReceiptPage.controls.transactionType.value||1==this.manualReceiptPage.controls.transactionType.value){var e=this.productEnumConstants[this.manualReceiptPage.controls.product.value].name;"AAAA"!=e&&"AMWINS"!=e&&"CONNECT"!=e||this.zeroPremiumAMount||(console.log(e),0==this.manualReceiptPage.controls.transactionType.value&&(parseFloat(this.manualReceiptPage.controls.amount.value)<=parseFloat(this.manualReceiptPage.controls.premiumAmount.value)&&(this.manualReceiptPage.controls.amount.setValue(0!=this.collectedAmount?(+this.collectedAmount).toFixed(2):void 0),this.manualReceiptPage.controls.premiumAmount.setValue(void 0!=this.premiumAmount?(+this.premiumAmount).toFixed(2):void 0)),this.isPremiumAmountReadOnly=!0),1==this.manualReceiptPage.controls.transactionType.value&&(this.manualReceiptPage.controls.paymentBy.value==this.paymentByEnumConstants[3].value&&this.splitArray.includes(1)||(this.manualReceiptPage.controls.amount.setValue(void 0!=this.premiumAmount?(+this.premiumAmount).toFixed(2):void 0),this.manualReceiptPage.controls.premiumAmount.setValue(void 0!=this.premiumAmount?(+this.premiumAmount).toFixed(2):void 0),this.verifyTotalAndPremiumAmount(),this.totalCollecatedAmountByUser=parseFloat(this.manualReceiptPage.controls.amount.value)),this.isPremiumAmountReadOnly=!0)),this.checkTotalAmountAndPremiumAmount()}else this.isPremiumAmountReadOnly=!1;if(this.manualReceiptPage.controls.amount.value&&this.manualReceiptPage.controls.premiumAmount.value&&0!==this.manualReceiptPage.controls.product.value&&!this.paymentTransactionAdmin){if(null!=this.manualReceiptPage.controls.transactionType.value&&""!==this.manualReceiptPage.controls.transactionType.value&&0==this.manualReceiptPage.controls.transactionType.value)if(parseFloat(this.manualReceiptPage.controls.amount.value)<=parseFloat(this.manualReceiptPage.controls.premiumAmount.value))this.setValidatorOnTotalCollectedAmount({amountShouldBeGreterThanPremium:!0});else(t=this.manualReceiptPage.controls.amount).hasError("amountShouldBeGreterThanPremium")&&delete t.errors.amountShouldBeGreterThanPremium,this.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(t.errors)?void 0:t.errors);else if(null!=this.manualReceiptPage.controls.transactionType.value&&""!==this.manualReceiptPage.controls.transactionType.value){if(parseFloat(this.manualReceiptPage.controls.amount.value)<parseFloat(this.manualReceiptPage.controls.premiumAmount.value))this.setValidatorOnTotalCollectedAmount({invalidTotalAmount:!0});else(t=this.manualReceiptPage.controls.amount).hasError("amountShouldBeGreterThanPremium")&&delete t.errors.amountShouldBeGreterThanPremium,t.hasError("invalidTotalAmount")&&delete t.errors.invalidTotalAmount,this.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(t.errors)?void 0:t.errors)}else{var t;(t=this.manualReceiptPage.controls.amount).hasError("amountShouldBeGreterThanPremium")&&delete t.errors.amountShouldBeGreterThanPremium,this.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(t.errors)?void 0:t.errors)}if(3!=this.manualReceiptPage.controls.product.value&&8!=this.manualReceiptPage.controls.product.value&&38!=this.manualReceiptPage.controls.product.value||null==this.lateFees)(t=this.manualReceiptPage.controls.amount).hasError("min")&&"0.00"!=this.manualReceiptPage.controls.amount.value&&delete t.errors.min,this.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(t.errors)?void 0:t.errors);else if(null==this.manualReceiptPage.controls.transactionType.value||""===this.manualReceiptPage.controls.transactionType.value||0!=this.manualReceiptPage.controls.transactionType.value&&5!=this.manualReceiptPage.controls.transactionType.value)(t=this.manualReceiptPage.controls.amount).hasError("min")&&"0.00"!=this.manualReceiptPage.controls.amount.value&&delete t.errors.min,this.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(t.errors)?void 0:t.errors);else if(parseFloat(this.lateFees.toString())>parseFloat(this.manualReceiptPage.controls.amount.value)-parseFloat(this.manualReceiptPage.controls.premiumAmount.value))this.setValidatorOnTotalCollectedAmount({min:{min:parseFloat(this.manualReceiptPage.controls.premiumAmount.value)+parseFloat(this.lateFees.toString())}});else(t=this.manualReceiptPage.controls.amount).hasError("min")&&"0.00"!=this.manualReceiptPage.controls.amount.value&&delete t.errors.min,this.setValidatorOnTotalCollectedAmount("{}"==JSON.stringify(t.errors)?void 0:t.errors)}if(this.validateDiscoverCardTypeForManualReceiptPage(!0),this.updateCardTransactionFeesForAmWins(),this.renewalFeeAmount>0&&!this.paymentTransactionAdmin){if(!this.transactionTypeRenewalSelected){var a=+this.collectedAmount+ +this.renewalFeeAmount;+this.collectedAmount<+a&&(this.collectedAmount=(parseFloat(this.collectedAmount.toString())+parseFloat(this.renewalFeeAmount.toString())).toFixed(2),this.transactionTypeRenewalSelected=!0)}this.onTransactionChange=!0,this.updateRenewalFeeWithTotalCollecationAmount(),this.checkTotalAmountAndPremiumAmount()}},e.prototype.validateCardExpiry=function(e){this.isShowExpiredCardMsg=!1;var t=+this.manualReceiptPage.controls.expiryMonth.value,a=+this.manualReceiptPage.controls.expiryYear.value,n=new Date;0!=a&&a==n.getFullYear()&&t<=n.getMonth()&&(this.isShowExpiredCardMsg=!0,this.manualReceiptPage.controls.expiryMonth.setValue("")),setTimeout(function(){$(".selectpicker").selectpicker("refresh")},10)},e.prototype.validateSavedCardExpiry=function(){this.isShowExpiredCardMsg=!1;var e=+this.manualReceiptPage.controls.expiryMonth.value,t=+this.manualReceiptPage.controls.expiryYear.value,a=new Date;0!=t&&t==a.getFullYear()&&e<=a.getMonth()+1&&(this.isShowExpiredCardMsg=!0,this.manualReceiptPage.controls.expiryMonth.setValue(""),this.manualReceiptPage.controls.expiryYear.setValue("")),setTimeout(function(){$(".selectpicker").selectpicker("refresh")},10)},e.prototype.noWhitespaceValidator=function(e){return!(0===(e.value||"").trim().length)?null:{whitespace:!0}},e.prototype.policyNumberExist=function(){var e=this;return null!=this.manualReceiptPage.controls.policyNumber.value&&this.manualReceiptPage.controls.policyNumber.setValue(this.manualReceiptPage.controls.policyNumber.value.trim().toUpperCase()),new Promise(function(t){null!=e.manualReceiptPage.controls.policyNumber.value&&""!=e.manualReceiptPage.controls.policyNumber.value.trim()&&e.manualReceiptPage.controls.policyNumber.value.trim().toUpperCase()!=e.onLoadPolicyNumber?e.manualReceiptService.policyNumberExist(e.manualReceiptPage.controls.policyNumber.value.trim()).subscribe(function(a){a.data&&1==a.data?t(""):(e.manualReceiptPage.get("policyNumber").setErrors(void 0),t(""))}):t("")})},e.prototype.omit_special_char=function(e){var t;return(t=e.charCode)>64&&t<91||t>96&&t<123||8==t||32==t||t>=48&&t<=57||45==t},e.prototype.onPolicyNumberKeyUp=function(e){null!=this.manualReceiptPage.controls.policyNumber.value&&this.manualReceiptPage.controls.policyNumber.setValue(this.manualReceiptPage.controls.policyNumber.value.trim().toUpperCase()),null!=this.manualReceiptCheckPolicyForm.controls.policyNumber.value&&this.manualReceiptCheckPolicyForm.controls.policyNumber.setValue(this.manualReceiptCheckPolicyForm.controls.policyNumber.value.trim().toUpperCase())},e.prototype.setValidatorsOnFetchPolicyNumber=function(){"NEW_BUSINESS"==this.manualReceiptCheckPolicyForm.controls.transactionType.value||2==this.manualReceiptCheckPolicyForm.controls.transactionType.value?(this.manualReceiptCheckPolicyForm.get("policyNumber").setValue(void 0),this.manualReceiptCheckPolicyForm.get("policyNumber").clearValidators(),this.manualReceiptCheckPolicyForm.get("policyNumber").updateValueAndValidity()):this.paymentTransactionAdmin||(this.manualReceiptCheckPolicyForm.get("policyNumber").setValidators([l.Validators.required,this.noWhitespaceValidator]),this.manualReceiptCheckPolicyForm.get("policyNumber").updateValueAndValidity())},e.prototype.fetchPolicy=function(){return B(this,void 0,void 0,function(){var e,t,a,n,o,i=this;return q(this,function(l){return this.commonService.clearAlertMessage(),this.manualReceiptCheckPolicyForm.valid?(this.blockUI.start("Fetching policy details, Please wait..."),console.log(JSON.stringify(this.manualReceiptCheckPolicyForm.value)),"NEW_BUSINESS"==this.manualReceiptCheckPolicyForm.controls.transactionType.value||2==this.manualReceiptCheckPolicyForm.controls.transactionType.value?(this.isShowFetchPolicy=!1,this.commonService.manualReceiptNavFlag=!0,this.isPremiumAmountReadOnly=!1,this.isPolicyReadOnly=!0,this.manualReceiptPage=this.createReceiptForm(),this.manualReceiptPage.patchValue(this.manualReceiptCheckPolicyForm.value),setTimeout(function(){$(".selectpicker").selectpicker({selectOnTab:!0}),$(".selectpicker").selectpicker("refresh"),$(".todisable").attr("disabled","disabled")},h.a.SELECT_PICKER_REFRESH_TIME),this.blockUI.stop(),this.checkManualReceiptCheckPolicyFormDynamicCondition()?(this.showMakePaymentWarning=!0,this.makePaymentWarning="Please make sure you post this payment at "+this.ProductConstant.getProductModelByProduct(this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name).label+" as well to complete the transaction."):this.showMakePaymentWarning=!1):(this.traineeAcoount?this.transactionTypeEnumConstants.forEach(function(t){t.value==i.manualReceiptCheckPolicyForm.controls.transactionType.value&&(e=t.name)}):e=this.transactionTypeEnumConstants[this.manualReceiptCheckPolicyForm.controls.transactionType.value].name,t=this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name,a=this.manualReceiptCheckPolicyForm.controls.policyNumber.value,this.searchedPolicy=a,"AAAA"!=t&&"AMWINS"!=t&&"CONNECT"!=t&&"UNITED_AUTO"!=t&&"WINDHAVEN"!=t&&"FALCON"!=t||"ENDORESEMENT"!=e&&"RENEWAL"!=e&&"INSTALLMENT"!=e&&"INSTALL_LF"!=e?this.manualReceiptService.fetchPolicyByPolicyNumber(a).subscribe(function(e){if(i.blockUI.stop(),e&&e.data)if(e.data.createdDatetime)if(moment().tz("America/Chicago").format("DD/MM/YYYY")==moment(e.data.createdDatetime).format("DD/MM/YYYY")){i.blockUI.stop(),i.modalService.show(S.a,{backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Confirmation",message:"Payment for this policy has already been received today. Are you sure, you want to make another payment?",okButton:{label:"Yes"},cancelButton:{label:"No"}}}).content.onClose.subscribe(function(t){t&&i.showManualReceiptForFetchPolicyByPolicyNumber(e)})}else i.showManualReceiptForFetchPolicyByPolicyNumber(e);else i.showManualReceiptForFetchPolicyByPolicyNumber(e);else i.commonService.showInfoMessage("Can not find policy details, Please enter here."),i.isShowFetchPolicy=!1,i.commonService.manualReceiptNavFlag=!0,i.isPremiumAmountReadOnly=!1,i.isPolicyReadOnly=!0,i.manualReceiptPage=i.createReceiptForm(),i.manualReceiptPage.patchValue(i.manualReceiptCheckPolicyForm.value),setTimeout(function(){$(".selectpicker").selectpicker({selectOnTab:!0}),$(".selectpicker").selectpicker("refresh"),$(".todisable").attr("disabled","disabled"),i.policyNumberExist()},h.a.SELECT_PICKER_REFRESH_TIME),i.checkManualReceiptCheckPolicyFormDynamicCondition()?(i.showMakePaymentWarning=!0,i.makePaymentWarning="Please make sure you post this payment at "+i.ProductConstant.getProductModelByProduct(i.productEnumConstants[i.manualReceiptCheckPolicyForm.controls.product.value].name).label+" as well to complete the transaction."):i.showMakePaymentWarning=!1},function(e){i.commonService.showInfoMessage("Can not find policy details, Please enter here."),i.isShowFetchPolicy=!1,i.commonService.manualReceiptNavFlag=!0,i.isPremiumAmountReadOnly=!1,i.isPolicyReadOnly=!0,i.manualReceiptPage=i.createReceiptForm(),i.manualReceiptPage.patchValue(i.manualReceiptCheckPolicyForm.value),setTimeout(function(){$(".selectpicker").selectpicker({selectOnTab:!0}),$(".selectpicker").selectpicker("refresh"),$(".todisable").attr("disabled","disabled"),i.policyNumberExist()},h.a.SELECT_PICKER_REFRESH_TIME),i.blockUI.stop(),i.checkManualReceiptCheckPolicyFormDynamicCondition()?(i.showMakePaymentWarning=!0,i.makePaymentWarning="Please make sure you post this payment at "+i.ProductConstant.getProductModelByProduct(i.productEnumConstants[i.manualReceiptCheckPolicyForm.controls.product.value].name).label+" as well to complete the transaction."):i.showMakePaymentWarning=!1}):this.manualReceiptService.fetchPolicy(e,t,a).subscribe(function(e){i.manualReceiptService.fetchPolicyResponse(a).subscribe(function(e){if(e&&e.data&&e.data.paymentInfoResponse)if(e.data.paymentInfoResponse.createdDatetime)if(moment().tz("America/Chicago").format("DD/MM/YYYY")==moment(e.data.paymentInfoResponse.createdDatetime).format("DD/MM/YYYY")){i.blockUI.stop();i.modalService.show(S.a,{backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Confirmation",message:"Payment for this policy has already been received today. Are you sure, you want to make another payment?",okButton:{label:"Yes"},cancelButton:{label:"No"}}}).content.onClose.subscribe(function(t){t&&(i.blockUI.start("Fetching policy details, Please wait..."),i.showManualReceiptForFetchPolicyResponse(e))})}else i.showManualReceiptForFetchPolicyResponse(e);else i.showManualReceiptForFetchPolicyResponse(e);console.log(i.manualReceiptPage.controls.cardNumber)},function(e){i.blockUI.stop(),i.isPremiumAmountReadOnly=!1,i.isPolicyReadOnly=!1,i.idleService.isTimeOutWarningDisplayed=!0,(0==e.status||JSON.parse(e._body).error)&&i.loginService.checkErrorResponse(e),i.commonService.showErrorMessage(JSON.parse(e._body).message)})},function(e){i.blockUI.stop(),i.isPremiumAmountReadOnly=!1,i.isPolicyReadOnly=!1,i.idleService.isTimeOutWarningDisplayed=!0,(0==e.status||JSON.parse(e._body).error)&&i.loginService.checkErrorResponse(e),i.commonService.showErrorMessage(JSON.parse(e._body).message)}))):this.manualReceiptCheckPolicyForm.valid||(n=Object.keys(this.manualReceiptCheckPolicyForm.controls).map(function(e){return i.manualReceiptCheckPolicyForm.controls[e]}).filter(function(e){return e.invalid})).length>0&&(o=n[0].nativeElement,n[0].markAsTouched(),o&&($(o).focus(),setTimeout(function(){$(o).data("selectpicker")&&$(o).data("selectpicker").$button.focus()},100))),[2]})})},e.prototype.showManualReceiptForFetchPolicyResponse=function(e){return B(this,void 0,void 0,function(){var t,a,n,o,i=this;return q(this,function(l){switch(l.label){case 0:return!e.data.policyStatus||"Cancelled"!=e.data.policyStatus&&"Expired"!=e.data.policyStatus||(this.isPolicyIsCancelled=!0),e.data.isRenewalPolicy&&(this.isRenewalPolicy=!0),!this.paymentTransactionAdmin&&!this.isPolicyIsCancelled&&e.data.policyPayInFullAmount<=1&&"UNITED_AUTO"==this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name&&(5==this.manualReceiptCheckPolicyForm.controls.transactionType.value||0==this.manualReceiptCheckPolicyForm.controls.transactionType.value||1==this.manualReceiptCheckPolicyForm.controls.transactionType.value)||!this.paymentTransactionAdmin&&!this.isPolicyIsCancelled&&e.data.policyPayInFullAmount<=1&&"WINDHAVEN"==this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name&&this.isRenewalPolicy&&(5==this.manualReceiptCheckPolicyForm.controls.transactionType.value||0==this.manualReceiptCheckPolicyForm.controls.transactionType.value||1==this.manualReceiptCheckPolicyForm.controls.transactionType.value)||!this.paymentTransactionAdmin&&!this.isPolicyIsCancelled&&e.data.policyPayInFullAmount<=1&&"FALCON"==this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name&&this.isRenewalPolicy&&(5==this.manualReceiptCheckPolicyForm.controls.transactionType.value||0==this.manualReceiptCheckPolicyForm.controls.transactionType.value||1==this.manualReceiptCheckPolicyForm.controls.transactionType.value)?(!1,[4,this.fetchRenewalDetails()]):[3,2];case 1:if(!l.sent())return this.blockUI.stop(),[2,!1];l.label=2;case 2:return this.blockUI.stop(),e.data.policyAlertMessage&&this.commonService.showWarningMessage(e.data.policyAlertMessage),this.paymentId=e.data.paymentInfoResponse.encryptedId,this.isShowFetchPolicy=!1,this.commonService.manualReceiptNavFlag=!0,this.manualReceiptPage=this.createReceiptForm(),"UNITED_AUTO"!=this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name&&"WINDHAVEN"!=this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name&&"FALCON"!=this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name||!this.downPayAmount||(e.data.amount=(this.collectedAmount+this.renewalFeeAmount).toFixed(2),this.collectedAmount=(this.collectedAmount+this.renewalFeeAmount).toFixed(2),e.data.premiumAmount=this.downPayAmount,e.data.policyPayInFullAmount=this.downPayAmount,e.data.appliedLateFees=this.lateFees,this.manualReceiptPage.controls.transactionType.setValue(5)),t=new Date(e.data.policyEffectiveDate),a=new Date,t>a&&!this.isPolicyRenewed?(38!=this.manualReceiptPage.controls.product.value&&35!=this.manualReceiptPage.controls.product.value&&(this.isRenewal=!0),!this.paymentTransactionAdmin&&"AAAA"==this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name||"CONNECT"==this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name||"AMWINS"==this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name?(!1,[4,this.fetchRenewalFees()]):[3,4]):[3,4];case 3:if(!l.sent())return this.blockUI.stop(),[2,!1];e.data.amount=(parseFloat(e.data.amount.toString())+parseFloat(this.renewalFeeAmount.toString())).toFixed(2),this.collectedAmount=(parseFloat(e.data.amount.toString())+parseFloat(this.renewalFeeAmount.toString())).toFixed(2),this.transactionTypeRenewalSelected=!0,l.label=4;case 4:return this.manualReceiptPage.patchValue(e.data.paymentInfoResponse),this.manualReceiptPage.controls.customerAvailability.setValue(void 0),this.fullPayAmount=e.data.policyPayInFullAmount,e.data.policyPayInFullAmount<=1&&"WINDHAVEN"!=this.manualReceiptPage.controls.product.value&&(this.zeroFullPayAmount=!0),e.data.paymentInfoResponse.customer&&(this.manualReceiptPage.patchValue(e.data.paymentInfoResponse.customer),console.log(this.manualReceiptPage.controls.firstName.value),this.manualReceiptPage.controls.reEmail.setValue(this.manualReceiptPage.controls.email.value),this.paymentId&&e.data.nameChanged&&e.data.updatedName?(this.isNameChanged=e.data.nameChanged,this.setUpdatedNameToForm(e.data.updatedName)):this.isNameChanged=!1,this.onNameBlur(void 0,"firstName"),this.onNameBlur(void 0,"middleName"),this.onNameBlur(void 0,"lastName"),this.mobileNo=e.data.paymentInfoResponse.customer.mobileNo),this.manualReceiptCheckPolicyForm.controls.policyNumber.setValue(e.data.fetchedPolicyNumber),this.manualReceiptPage.patchValue(this.manualReceiptCheckPolicyForm.value),this.manualReceiptPage.controls.agentNotes.setValue(void 0),n=this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name,38!=this.manualReceiptPage.controls.product.value&&12!=this.manualReceiptPage.controls.product.value||!this.premiumAmount?(this.manualReceiptPage.controls.amount.setValue(0!=e.data.amount?(+e.data.amount).toFixed(2):void 0),this.manualReceiptPage.controls.premiumAmount.setValue(void 0!=e.data.premiumAmount?(+e.data.premiumAmount).toFixed(2):void 0),this.collectedAmount=e.data.amount,this.premiumAmount=e.data.premiumAmount):(this.manualReceiptPage.controls.amount.setValue(0!=e.data.amount?(+e.data.amount).toFixed(2):void 0),this.manualReceiptPage.controls.premiumAmount.setValue(this.premiumAmount)),"UNITED_AUTO"==n&&this.searchedPolicy.split("-")[1].trim()!=e.data.fetchedPolicyNumber.split("-")[1].trim()&&(this.isPolicyRenewed=!0),this.lateFees=e.data.appliedLateFees,1==this.manualReceiptPage.controls.transactionType.value?(null!=e.data.appliedLateFees&&this.manualReceiptPage.controls.transactionType.setValue(0),(this.isRenewal&&!this.isPolicyRenewed||this.zeroFullPayAmount||this.downPayAmount)&&this.manualReceiptPage.controls.transactionType.setValue(5)):0==this.manualReceiptPage.controls.transactionType.value?(null!=e.data.appliedLateFees||this.isPolicyRenewed||this.manualReceiptPage.controls.transactionType.setValue(1),(this.isRenewal&&!this.isPolicyRenewed||this.zeroFullPayAmount||this.downPayAmount)&&this.manualReceiptPage.controls.transactionType.setValue(5)):5!=this.manualReceiptPage.controls.transactionType.value||this.isRenewal||this.zeroFullPayAmount||this.downPayAmount||(null!=e.data.appliedLateFees?this.manualReceiptPage.controls.transactionType.setValue(0):this.manualReceiptPage.controls.transactionType.setValue(1)),this.checkManualReceiptPageDynamicCondition()?(this.showMakePaymentWarning=!0,this.makePaymentWarning="Please make sure you post this payment at "+this.ProductConstant.getProductModelByProduct(this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name).label+" as well to complete the transaction."):this.showMakePaymentWarning=!1,this.onLoadPolicyNumber=this.manualReceiptPage.controls.policyNumber.value.trim().toUpperCase(),this.isPolicyReadOnly=!0,console.log(this.manualReceiptPage.controls.cardNumber),setTimeout(function(){if(console.log(i.manualReceiptPage.controls.cardNumber),$(".selectpicker").selectpicker({selectOnTab:!0}),$(".selectpicker").selectpicker("refresh"),$(".todisable").attr("disabled","disabled"),i.checkTotalAmountAndPremiumAmount(),null!=e.data.paymentInfoResponse.creditCardInfo&&void 0!=e.data.paymentInfoResponse.creditCardInfo){i.creditCardInfoDetails=e.data.paymentInfoResponse.creditCardInfo,i.manualReceiptPage.controls.cardHolderName.setValue(i.creditCardInfoDetails.cardHolderName),i.manualReceiptPage.controls.cardNumber.setValue(i.creditCardInfoDetails.cardNumber),i.cardXMask=i.creditCardInfoDetails.cardNumber,i.onCardNumberEnter(null),e.data.paymentInfoResponse.creditCardInfo.cardType?"VISA"==e.data.paymentInfoResponse.creditCardInfo.cardType.toUpperCase()?(-1!=i.visaElectronCardNumbers.indexOf(i.creditCardInfoDetails.cardNumber.substring(0,4))?i.selectedCardString=i.visaElectronCardIconString:i.selectedCardString=i.visaCardIconString,i.cardType="1"):"MASTERCARD"==e.data.paymentInfoResponse.creditCardInfo.cardType.toUpperCase()?(i.selectedCardString=i.masterCardIconString,i.cardType="0"):"DISCOVER"==e.data.paymentInfoResponse.creditCardInfo.cardType.toUpperCase()?(i.selectedCardString=i.discoverCardIconString,i.cardType="2",i.validateDiscoverCardTypeForManualReceiptPage(!0)):(i.selectedCardString=void 0,i.cardType=null,e.data.paymentInfoResponse.creditCardInfo.cardNumber?i.isShowCardNumber=!0:i.isShowCardNumber=!1,i.manualReceiptPage.controls.cardNumber.setErrors({invalidCardType:!0})):(i.selectedCardString=void 0,i.cardType=null,e.data.paymentInfoResponse.creditCardInfo.cardNumber?i.isShowCardNumber=!0:i.isShowCardNumber=!1,i.manualReceiptPage.controls.cardNumber.setErrors({invalidCardType:!0})),console.log(i.manualReceiptPage.controls.cardNumber),i.onCardNumberBlur();for(var t=void 0,a=0;a<i.cardMonths.length;a++)if(i.cardMonths[a].value==i.creditCardInfoDetails.expiryMonth){t=i.cardMonths[a];break}var n=void 0;for(a=0;a<i.cardMonths.length;a++)if(i.cardYears[a].value==i.creditCardInfoDetails.expiryYear){n=i.cardYears[a];break}i.manualReceiptPage.controls.expiryMonth.setValue(t.value),i.manualReceiptPage.controls.expiryYear.setValue(n.value),i.validateSavedCardExpiry(),i.manualReceiptPage.controls.address.setValue(i.creditCardInfoDetails.address),i.manualReceiptPage.controls.aprtUntNumber.setValue(i.creditCardInfoDetails.aprtUntNumber),i.manualReceiptPage.controls.city.setValue(i.creditCardInfoDetails.city),i.manualReceiptPage.controls.stateId.setValue(i.creditCardInfoDetails.state.encryptedId),i.manualReceiptPage.controls.zipcode.setValue(i.creditCardInfoDetails.zipcode),console.log("cc "+i.creditCardInfoDetails)}if(i.paymentTransactionAdmin){if(i.isEditable&&e.data.paymentInfoResponse.office&&e.data.paymentInfoResponse.agent)i.officeId=e.data.paymentInfoResponse.office.id,i.agentId=e.data.paymentInfoResponse.agent.decryptedId;else{var o=i.commonService.getLoginUserDetails();setTimeout(function(){i.officeId=o.office.id,i.agentId=+o.encryptedId},h.a.SELECT_PICKER_REFRESH_TIME)}$(".selectpicker").selectpicker("refresh"),setTimeout(function(){$(".selectpicker").selectpicker({selectOnTab:!0}),$(".selectpicker").selectpicker("refresh")},h.a.SELECT_PICKER_REFRESH_TIME)}},h.a.SELECT_PICKER_REFRESH_TIME),o="",0==+e.data.paymentInfoResponse.premiumAmount&&(this.commonService.showInfoMessage("No payment due at this time."),this.zeroPremiumAMount=!0),"UNITED_AUTO"!=n&&"WINDHAVEN"!=n||this.searchedPolicy.split("-")[1].trim()!=e.data.fetchedPolicyNumber.split("-")[1].trim()&&this.commonService.showInfoMessage("Policy "+this.searchedPolicy+" is now renewed to "+e.data.fetchedPolicyNumber+"."),o&&this.commonService.showInfoMessage(o),"UNITED_AUTO"==n&&this.downPayAmount&&this.commonService.showInfoMessage("This policy is eligible for renewal payment."),"WINDHAVEN"!=n&&"FALCON"!=n||!this.isRenewalPolicy||(this.commonService.showInfoMessage("This policy is eligible for renewal payment."),this.manualReceiptPage.controls.transactionType.setValue(5)),0!=this.manualReceiptPage.controls.transactionType.value&&1!=this.manualReceiptPage.controls.transactionType.value&&5!=this.manualReceiptPage.controls.transactionType.value&&(this.manualReceiptPage.controls.amount.setValue(void 0),this.manualReceiptPage.controls.premiumAmount.setValue(void 0)),void 0==e.data.paymentInfoResponse.premiumAmount||0!=this.manualReceiptCheckPolicyForm.controls.transactionType.value&&1!=this.manualReceiptCheckPolicyForm.controls.transactionType.value||this.zeroPremiumAMount||(this.isPremiumAmountReadOnly=!0),this.submitForm(),[2]}})})},e.prototype.showManualReceiptForFetchPolicyByPolicyNumber=function(e){var t=this;this.paymentId=e.data.encryptedId,this.isShowFetchPolicy=!1,this.commonService.manualReceiptNavFlag=!0,this.manualReceiptPage=this.createReceiptForm(),this.manualReceiptPage.patchValue(e.data),this.manualReceiptPage.controls.customerAvailability.setValue(void 0),this.manualReceiptPage.controls.agentNotes.setValue(void 0),"UNITED_AUTO"==this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name&&this.downPayAmount&&(e.data.amount=this.collectedAmount,e.data.premiumAmount=this.downPayAmount,e.data.policyPayInFullAmount=this.downPayAmount,e.data.appliedLateFees=this.lateFees,this.fullPayAmount=this.downPayAmount,this.manualReceiptPage.controls.transactionType.setValue(5)),"WINDHAVEN"!=this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name||5!=this.manualReceiptCheckPolicyForm.controls.transactionType.value&&!this.isRenewalPolicy||this.manualReceiptPage.controls.transactionType.setValue(5),"WINDHAVEN"==this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name&&this.isRenewalPolicy&&this.commonService.showInfoMessage("This policy is eligible for renewal payment."),"UNITED_AUTO"==this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name&&this.downPayAmount&&this.commonService.showInfoMessage("This policy is eligible for renewal payment."),e.data.customer&&(this.manualReceiptPage.patchValue(e.data.customer),this.manualReceiptPage.controls.reEmail.setValue(this.manualReceiptPage.controls.email.value),this.onNameBlur(void 0,"firstName"),this.onNameBlur(void 0,"middleName"),this.onNameBlur(void 0,"lastName"),this.mobileNo=e.data.customer.mobileNo),e.data.policyPayInFullAmount<=1&&(this.fullPayAmount=e.data.policyPayInFullAmount,this.zeroFullPayAmount=!0),this.zeroFullPayAmount&&this.manualReceiptPage.controls.transactionType.setValue(5),this.manualReceiptPage.patchValue(this.manualReceiptCheckPolicyForm.value),this.manualReceiptPage.controls.amount.setValue(0!=e.data.amount?(+e.data.amount).toFixed(2):void 0),this.manualReceiptPage.controls.premiumAmount.setValue(0!=e.data.premiumAmount?(+e.data.premiumAmount).toFixed(2):void 0);for(var a=0;a<this.ProductConstant.getNamesAndValuesByInputType().length;a++)if(this.ProductConstant.getNamesAndValuesByInputType()[a].name==e.data.product){this.manualReceiptPage.controls.product.setValue(this.ProductConstant.getNamesAndValuesByInputType()[a].value),this.manualReceiptCheckPolicyForm.controls.product.setValue(this.ProductConstant.getNamesAndValuesByInputType()[a].value);break}this.checkManualReceiptPageDynamicCondition()?(this.showMakePaymentWarning=!0,this.makePaymentWarning="Please make sure you post this payment at "+this.ProductConstant.getProductModelByProduct(this.productEnumConstants[this.manualReceiptCheckPolicyForm.controls.product.value].name).label+" as well to complete the transaction."):this.showMakePaymentWarning=!1,this.onLoadPolicyNumber=this.manualReceiptPage.controls.policyNumber.value.trim().toUpperCase(),this.isPolicyReadOnly=!0,setTimeout(function(){if($(".selectpicker").selectpicker({selectOnTab:!0}),$(".selectpicker").selectpicker("refresh"),$(".todisable").attr("disabled","disabled"),t.checkTotalAmountAndPremiumAmount(),null!=e.data.creditCardInfo&&void 0!=e.data.creditCardInfo){t.creditCardInfoDetails=e.data.creditCardInfo,t.manualReceiptPage.controls.cardHolderName.setValue(t.creditCardInfoDetails.cardHolderName),t.manualReceiptPage.controls.cardNumber.setValue(t.creditCardInfoDetails.cardNumber),t.cardXMask=t.creditCardInfoDetails.cardNumber,t.onCardNumberEnter(null),e.data.creditCardInfo.cardType?"VISA"==e.data.creditCardInfo.cardType.toUpperCase()?(-1!=t.visaElectronCardNumbers.indexOf(t.creditCardInfoDetails.cardNumber.substring(0,4))?t.selectedCardString=t.visaElectronCardIconString:t.selectedCardString=t.visaCardIconString,t.cardType="1"):"MASTERCARD"==e.data.creditCardInfo.cardType.toUpperCase()?(t.selectedCardString=t.masterCardIconString,t.cardType="0"):"DISCOVER"==e.data.creditCardInfo.cardType.toUpperCase()?(t.selectedCardString=t.discoverCardIconString,t.cardType="2",t.validateDiscoverCardTypeForManualReceiptPage(!0)):(t.selectedCardString=void 0,t.cardType=null,e.data.creditCardInfo.cardNumber?t.isShowCardNumber=!0:t.isShowCardNumber=!1,t.manualReceiptPage.controls.cardNumber.setErrors({invalidCardType:!0})):(t.selectedCardString=void 0,t.cardType=null,e.data.creditCardInfo.cardNumber?t.isShowCardNumber=!0:t.isShowCardNumber=!1,t.manualReceiptPage.controls.cardNumber.setErrors({invalidCardType:!0})),t.onCardNumberBlur();for(var a=void 0,n=0;n<t.cardMonths.length;n++)if(t.cardMonths[n].value==t.creditCardInfoDetails.expiryMonth){a=t.cardMonths[n];break}var o=void 0;for(n=0;n<t.cardMonths.length;n++)if(t.cardYears[n].value==t.creditCardInfoDetails.expiryYear){o=t.cardYears[n];break}t.manualReceiptPage.controls.expiryMonth.setValue(a.value),t.manualReceiptPage.controls.expiryYear.setValue(o.value),t.validateSavedCardExpiry(),t.manualReceiptPage.controls.address.setValue(t.creditCardInfoDetails.address),t.manualReceiptPage.controls.aprtUntNumber.setValue(t.creditCardInfoDetails.aprtUntNumber),t.manualReceiptPage.controls.city.setValue(t.creditCardInfoDetails.city),t.manualReceiptPage.controls.stateId.setValue(t.creditCardInfoDetails.state.encryptedId),t.manualReceiptPage.controls.zipcode.setValue(t.creditCardInfoDetails.zipcode),console.log("cc "+t.creditCardInfoDetails)}},h.a.SELECT_PICKER_REFRESH_TIME)},e.prototype.cancelReceiptForm=function(){this.policyId&&this.customerId?this.router.navigate([h.b.EMPLOYE+"/"+h.b.CUSTOMER_POLICY_PROFILE],{queryParams:{id:this.customerId,policyId:this.policyId}}):this.router.navigate([h.b.EMPLOYE+"/"+h.b.EMPLOYE_POLICY_PROFILE])},e.prototype.onProductChange=function(){this.checkManualReceiptPageDynamicCondition()?(this.showMakePaymentWarning=!0,this.makePaymentWarning="Please make sure you post this payment at "+this.ProductConstant.getProductModelByProduct(this.productEnumConstants[this.manualReceiptPage.controls.product.value].name).label+" as well to complete the transaction."):this.showMakePaymentWarning=!1},e.prototype.checkManualReceiptPageDynamicCondition=function(){if(void 0!=this.manualReceiptPage.controls.transactionType.value&&void 0!=this.manualReceiptPage.controls.product.value){var e=this.productEnumConstants[this.manualReceiptPage.controls.product.value].name,t=v.a.getConnectedProductNamesAndValuesByInputType();if(0==this.manualReceiptPage.controls.transactionType.value||1==this.manualReceiptPage.controls.transactionType.value||5==this.manualReceiptPage.controls.transactionType.value||2==this.manualReceiptPage.controls.transactionType.value)for(var a=0,n=t;a<n.length;a++){if(n[a].name==e)return!1}return!0}return!1},e.prototype.checkManualReceiptCheckPolicyFormDynamicCondition=function(){return 2!=this.manualReceiptCheckPolicyForm.controls.transactionType.value&&0!=this.manualReceiptCheckPolicyForm.controls.product.value&&3!=this.manualReceiptCheckPolicyForm.controls.product.value&&8!=this.manualReceiptCheckPolicyForm.controls.product.value&&35!=this.manualReceiptPage.controls.product.value||0!=this.manualReceiptCheckPolicyForm.controls.transactionType.value&&1!=this.manualReceiptCheckPolicyForm.controls.transactionType.value&&5!=this.manualReceiptCheckPolicyForm.controls.transactionType.value&&2!=this.manualReceiptCheckPolicyForm.controls.transactionType.value&&(0==this.manualReceiptCheckPolicyForm.controls.product.value||3==this.manualReceiptCheckPolicyForm.controls.product.value||8==this.manualReceiptCheckPolicyForm.controls.product.value)},e.prototype.checkTransactionTypeForPremiumZero=function(){return!("NEW_BUSINESS"!=this.manualReceiptPage.controls.transactionType.value&&2!=this.manualReceiptPage.controls.transactionType.value&&"ENDORSEMENT"!=this.manualReceiptPage.controls.transactionType.value&&3!=this.manualReceiptPage.controls.transactionType.value&&"REINSTATEMENT"!=this.manualReceiptPage.controls.transactionType.value&&4!=this.manualReceiptPage.controls.transactionType.value&&"LATE_FEE"!=this.manualReceiptPage.controls.transactionType.value&&6!=this.manualReceiptPage.controls.transactionType.value&&"BAL_DUE"!=this.manualReceiptPage.controls.transactionType.value&&7!=this.manualReceiptPage.controls.transactionType.value&&"COPY"!=this.manualReceiptPage.controls.transactionType.value&&8!=this.manualReceiptPage.controls.transactionType.value&&"FAX"!=this.manualReceiptPage.controls.transactionType.value&&9!=this.manualReceiptPage.controls.transactionType.value&&"MANUAL"!=this.manualReceiptPage.controls.transactionType.value&&10!=this.manualReceiptPage.controls.transactionType.value&&"NOTARY"!=this.manualReceiptPage.controls.transactionType.value&&11!=this.manualReceiptPage.controls.transactionType.value&&"PAPERWORK"!=this.manualReceiptPage.controls.transactionType.value&&12!=this.manualReceiptPage.controls.transactionType.value&&!this.paymentTransactionAdmin)},e.prototype.onNameKeyUp=function(e,t){"firstName"==t?null!=this.manualReceiptPage.controls.firstName.value&&this.manualReceiptPage.controls.firstName.setValue(this.manualReceiptPage.controls.firstName.value.toUpperCase()):"middleName"==t?null!=this.manualReceiptPage.controls.middleName.value&&this.manualReceiptPage.controls.middleName.setValue(this.manualReceiptPage.controls.middleName.value.toUpperCase()):null!=this.manualReceiptPage.controls.lastName.value&&this.manualReceiptPage.controls.lastName.setValue(this.manualReceiptPage.controls.lastName.value.toUpperCase())},e.prototype.onNameBlur=function(e,t){"firstName"==t?null!=this.manualReceiptPage.controls.firstName.value&&this.manualReceiptPage.controls.firstName.setValue(this.manualReceiptPage.controls.firstName.value.trim().toUpperCase()):"middleName"==t?null!=this.manualReceiptPage.controls.middleName.value&&this.manualReceiptPage.controls.middleName.setValue(this.manualReceiptPage.controls.middleName.value.trim().toUpperCase()):null!=this.manualReceiptPage.controls.lastName.value&&this.manualReceiptPage.controls.lastName.setValue(this.manualReceiptPage.controls.lastName.value.trim().toUpperCase())},e.prototype.onEmailKeyUp=function(){null!=this.manualReceiptPage.controls.email.value&&this.manualReceiptPage.controls.email.setValue(this.manualReceiptPage.controls.email.value.trim().toUpperCase())},e.prototype.onReEmailKeyUp=function(){null!=this.manualReceiptPage.controls.reEmail.value&&this.manualReceiptPage.controls.reEmail.setValue(this.manualReceiptPage.controls.reEmail.value.trim().toUpperCase())},e.prototype.reEnterCorrectEmail=function(){this.onEmailKeyUp(),this.onReEmailKeyUp();var e=this.manualReceiptPage.get("reEmail");if(null!=this.manualReceiptPage.controls.email.value&&""!=this.manualReceiptPage.controls.email.value&&this.manualReceiptPage.controls.reEmail.value!=this.manualReceiptPage.controls.email.value)e.setErrors({reEnterCorrectEmail:!0});else{var t=this.manualReceiptPage.controls.reEmail.errors;t&&t.reEnterCorrectEmail&&(1==Object.keys(t).length?t=void 0:delete t.reEnterCorrectEmail),this.manualReceiptPage.controls.reEmail.setErrors(t)}},e.prototype.setValidatorOnTotalCollectedAmount=function(e){this.manualReceiptPage.controls.amount.setErrors(e),this.manualReceiptPage.controls.amount.markAsTouched()},e.prototype.setValidatorOnPremiumAmount=function(e){this.manualReceiptPage.controls.premiumAmount.setErrors(e),this.manualReceiptPage.controls.premiumAmount.markAsTouched()},e.prototype.setValidatorOnAmount=function(e){this.manualReceiptPage.controls.amount.setErrors(e),this.manualReceiptPage.controls.amount.markAsTouched()},e.prototype.validateDiscoverCardTypeForManualReceiptPage=function(e){if(void 0!=this.manualReceiptPage.controls.transactionType.value&&void 0!=this.manualReceiptPage.controls.product.value&&8==this.manualReceiptPage.controls.product.value&&1==this.manualReceiptPage.controls.transactionType.value&&parseFloat(this.manualReceiptPage.controls.amount.value)==parseFloat(this.manualReceiptPage.controls.premiumAmount.value)&&this.cardType&&"2"==this.cardType&&void 0!=$("#card-number")[0])return this.isShowCardNumber=!1,this.manualReceiptPage.controls.cardNumber.setErrors({invalidCardTypeDiscover:!0}),void(this.creditCardInfoDetails&&$("#card-number")[0].focus());var t=this.manualReceiptPage.controls.cardNumber;t.hasError("invalidCardTypeDiscover")&&delete t.errors.invalidCardTypeDiscover,this.manualReceiptPage.controls.cardNumber.setErrors("{}"==JSON.stringify(t.errors)?void 0:t.errors),this.creditCardInfoDetails&&this.manualReceiptPage.controls.cardNumber.markAsTouched(),e&&this.onCardNumberBlur()},e.prototype.setUpdatedNameToForm=function(e){var t=e.split(" ");t.length>0&&2==t.length?(this.manualReceiptPage.controls.firstName.setValue(t[0]),this.manualReceiptPage.controls.lastName.setValue(t[1])):t.length>0&&3==t.length?(this.manualReceiptPage.controls.firstName.setValue(t[0]),this.manualReceiptPage.controls.middleName.setValue(t[1]),this.manualReceiptPage.controls.lastName.setValue(t[2])):t.length>0&&4==t.length&&(this.manualReceiptPage.controls.firstName.setValue(t[0]),this.manualReceiptPage.controls.middleName.setValue(t[1]),this.manualReceiptPage.controls.lastName.setValue(t[2]+" "+t[3]))},e.prototype.ngOnDestroy=function(){this.idleService.onDestroy()},e.prototype.canDeactivate=function(){return B(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return this.isShowFetchPolicy||this.isFormSubmitted?[2,!0]:[3,1];case 1:return this.redirectPolicyPage?[2,!0]:[3,2];case 2:return this.redirectLogout?[2,!0]:[3,3];case 3:return[4,this.showExitWarning()];case 4:return e.sent()?[2,!0]:[2,!1]}})})},e.prototype.showExitWarning=function(){var e=this;return new Promise(function(t){return e.modalService.show(S.a,{backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Confirmation",message:"Do you want to leave this page? Your changes will not be saved.",okButton:{label:"Yes"},cancelButton:{label:"No"}}}).content.onClose.subscribe(function(a){a?(e.isShowFetchPolicy=!0,e.commonService.manualReceiptNavFlag=!0,e.totalAmount=0,e.resetCreditCardDetails(),e.manualReceiptPage.reset(),e.manualReceiptCheckPolicyForm=e.createManualReceiptCheckPolicyForm(),e.commonService.clearAlertMessage(),e.isShowExpiredCardMsg=!1,setTimeout(function(){$(".selectpicker").selectpicker({selectOnTab:!0}),$(".selectpicker").selectpicker("refresh")},h.a.SELECT_PICKER_REFRESH_TIME),t(!0)):t(!1)})})},e.prototype.validatePhoneNumber=function(){var e=this.manualReceiptPage.controls.mobileNo.value,t=(+this.replaceAll(e,"-","")).toString();if(e=this.replaceAll(e,"-",""),t.length!=e.length)this.manualReceiptPage.controls.mobileNo.setErrors({invalidMobileNumber:{}});else{var a=this.manualReceiptPage.controls.mobileNo;a.hasError("invalidMobileNumber")&&delete a.errors.invalidMobileNumber,this.manualReceiptPage.controls.mobileNo.setErrors("{}"==JSON.stringify(a.errors)?void 0:a.errors)}this.manualReceiptPage.controls.mobileNo.markAsTouched()},e.prototype.escapeRegExp=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},e.prototype.replaceAll=function(e,t,a){return e.toString().replace(new RegExp(this.escapeRegExp(t),"g"),a)},e.prototype.updatePaymentTransactionFees=function(){if(!this.paymentTransactionAdmin){this.splitArray.length>0&&(this.manualReceiptPage.controls.paymentBy.value==this.paymentByEnumConstants[3].value?this.splitArray.includes(1)&&this.splitArray.includes(2)?this.transactionAmount=this.getTransactionFeesAmountByName("CARD_CASH"):this.splitArray.includes(1)&&this.splitArray.includes(3)?this.transactionAmount=this.getTransactionFeesAmountByName("CARD_MO"):this.transactionAmount=this.getTransactionFeesAmountByName("CASH_MO"):this.manualReceiptPage.controls.paymentBy.value==this.paymentByEnumConstants[0].value?this.transactionAmount=this.getTransactionFeesAmountByName("CARD"):this.manualReceiptPage.controls.paymentBy.value==this.paymentByEnumConstants[1].value?this.transactionAmount=this.getTransactionFeesAmountByName("CASH"):this.manualReceiptPage.controls.paymentBy.value==this.paymentByEnumConstants[2].value&&(this.transactionAmount=this.getTransactionFeesAmountByName("MO")));var e=+this.totalCollecatedAmountByUser+ +this.transactionAmount;this.updatePaymentAmount(+e),+e<+this.manualReceiptPage.controls.premiumAmount.value?this.manualReceiptPage.controls.amount.setValue((+this.manualReceiptPage.controls.premiumAmount.value).toFixed(2)):(this.manualReceiptPage.controls.amount.reset(),this.manualReceiptPage.controls.amount.setValue(e.toFixed(2)))}this.checkTotalAndPremiumIsSameAndPaymentByIsCreditCard(),this.transactionAmount>0&&!this.paymentTransactionAdmin?(this.showPaymentTransactionFeesWarning=!0,this.amwinsCardTransactionFees?this.paymentTransactionFeesWarningAmount="AmWins Card Payment Transaction fees $"+h.a.AMWINS_CARD_TRANSACTION_FEE+" is added.":this.windhavenCardTransactionFees?this.paymentTransactionFeesWarningAmount="Windhaven Card Payment Transaction fees $"+h.a.WINDHAVEN_CARD_TRANSACTION_FEE+" is added.":this.falconCardTransactionFees?this.paymentTransactionFeesWarningAmount="Falcon Card Payment Transaction fees $"+h.a.FALCON_CARD_TRANSACTION_FEE+" is added.":this.paymentTransactionFeesWarningAmount="Payment Transaction fees $"+this.transactionAmount+" is added."):this.showPaymentTransactionFeesWarning=!1,this.updateCardTransactionFeesForAmWins(),this.updateRenewalFeeWithTotalCollecationAmount()},e.prototype.getTransactionFeesAmountByName=function(e){for(var t,a=0;a<this.paymentTransactionFees.length;a++)if(this.paymentTransactionFees[a].serviceFee.name==e){t=this.paymentTransactionFees[a].amount;break}return parseFloat(t)},e.prototype.updateTotalCollecationAmount=function(){if(this.transactionAmount>0){var e=this.manualReceiptPage.controls.amount.value,t=this.manualReceiptPage.controls.premiumAmount.value;this.lateFees>0&&(t=+t+this.lateFees),+e<+t+this.transactionAmount&&this.manualReceiptPage.controls.amount.setValue((+t+this.transactionAmount).toFixed(2))}},e.prototype.updateRenewalFeeWithTotalCollecationAmount=function(){if(!this.paymentTransactionAdmin)if(this.renewalFeeAmount>0&&5==this.manualReceiptPage.controls.transactionType.value){var e=this.manualReceiptPage.controls.amount.value,t=this.manualReceiptPage.controls.premiumAmount.value;if(this.transactionAmount>0||this.renewalFeeAmount>0){e=this.manualReceiptPage.controls.amount.value,t=this.manualReceiptPage.controls.premiumAmount.value;+this.lateFees>0&&(t=+t+ +this.lateFees);var a=+t+ +this.transactionAmount+ +this.renewalFeeAmount;+e<+a&&(this.manualReceiptPage.controls.amount.setValue((+a).toFixed(2)),this.updatePaymentAmount(+a))}var n=parseFloat(this.collectedAmount)+parseFloat(this.transactionAmount.toString());+e<n?(this.manualReceiptPage.controls.amount.setValue(n.toFixed(2)),this.totalCollecatedAmountByUser=parseFloat(this.manualReceiptPage.controls.amount.value)-parseFloat(this.transactionAmount.toString())):this.onTransactionChange&&(this.manualReceiptPage.controls.amount.setValue(n.toFixed(2)),this.totalCollecatedAmountByUser=this.manualReceiptPage.controls.amount.value,this.onTransactionChange=!1)}else if(this.renewalFeeAmount>0&&5!==this.manualReceiptPage.controls.transactionType.value){e=this.manualReceiptPage.controls.amount.value,t=this.manualReceiptPage.controls.premiumAmount.value;this.lateFees>0&&0==this.manualReceiptPage.controls.transactionType.value&&(t=parseFloat(this.manualReceiptPage.controls.premiumAmount.value)+parseFloat(this.lateFees.toString())),+e<+t+ +this.transactionAmount?(this.manualReceiptPage.controls.amount.setValue((+t+ +this.transactionAmount).toFixed(2)),this.totalCollecatedAmountByUser=parseFloat(this.manualReceiptPage.controls.amount.value)-parseFloat(this.transactionAmount.toString())):this.onTransactionChange&&(this.manualReceiptPage.controls.amount.setValue((+t+ +this.transactionAmount).toFixed(2)),this.totalCollecatedAmountByUser=this.manualReceiptPage.controls.amount.value,this.onTransactionChange=!1)}},e.prototype.fillUpManualReceiptFormForEdit=function(){var e=this;this.paymentInfoService.findPaymentInfoById(this.paymentId).subscribe(function(t){if(void 0!=t&&void 0!=t.data){var a=t.data;e.previousPaymentInfo=a,e.customerId=a.customer.decryptedId,e.policyId=a.policyVersion.policy.decryptedId,e.paymentTransactionInfo=t.data,e.manualReceiptPage.patchValue(a),e.manualReceiptPage.patchValue(a.customer),e.manualReceiptPage.patchValue(a.policyVersion.policy),e.manualReceiptPage.controls.reEmail.setValue(a.customer.email);for(var n=0;n<e.transactionTypeEnumConstants.length;n++)if(e.transactionTypeEnumConstants[n].name===a.transactionType){e.manualReceiptPage.controls.transactionType.setValue(e.transactionTypeEnumConstants[n].value);break}if(null!=a.product)for(var o=0;o<e.productEnumConstants.length;o++)if(e.productEnumConstants[o].name===a.product){e.manualReceiptPage.controls.product.setValue(e.productEnumConstants[o].value);break}for(var i=0;i<e.notificationMethodEnumConstants.length;i++)e.notificationMethodEnumConstants[i].name===a.policyVersion.notificationMethod&&e.manualReceiptPage.controls.notificationMethod.setValue(e.notificationMethodEnumConstants[i].value);if(a.customerAvailability)for(var l=0;l<e.customerAvailabilityEnumConstants.length;l++)e.customerAvailabilityEnumConstants[l].name===a.customerAvailability&&e.manualReceiptPage.controls.customerAvailability.setValue(e.customerAvailabilityEnumConstants[l].value);else e.manualReceiptPage.controls.customerAvailability.setValue(void 0);if(a.policyVersion.heardAboutUs){for(var r=0;r<e.heardAboutUsEnumConstants.length;r++)if(e.heardAboutUsEnumConstants[r].name===a.policyVersion.heardAboutUs){e.manualReceiptPage.controls.heardAboutUs.setValue(e.heardAboutUsEnumConstants[r].value);break}}else e.manualReceiptPage.controls.heardAboutUs.setValue(void 0);t.data.policyVersion.quotedBy&&e.manualReceiptPage.controls.quotedBy.setValue(t.data.policyVersion.quotedBy.id),setTimeout(function(){e.manualReceiptPage.controls.office.setValue(a.office.id),e.manualReceiptPage.controls.agent.setValue(a.agent.decryptedId),e.officeId=a.office.id,e.agentId=a.agent.decryptedId,$(".selectpicker").selectpicker({selectOnTab:!0}),$(".selectpicker").selectpicker("refresh")},h.a.REFRESH_TIME_100),e.setDatePicker(a.updatedCreatedDatetime.split(" ")[0]),e.manualReceiptPage.controls.updatedCreatedDateTime.setValue(a.updatedCreatedDatetime.split(" ")[0]),e.fillUpPaymentMethodDetails(a)}}),$("#selectProduct").attr("disabled",null),$(".selectpicker").selectpicker("refresh")},e.prototype.fillUpPaymentMethodDetails=function(e){var t=this;this.manualReceiptPage.controls.amount.setValue((+e.amount).toFixed(2)),this.premiumAmount=(+e.premiumAmount).toFixed(2),this.totalAmount=this.manualReceiptPage.controls.amount.value,this.manualReceiptPage.controls.premiumAmount.setValue((+e.premiumAmount).toFixed(2)),"CARD"==e.paymentBy?(this.fillCardDetails(e),this.transactionAmount=this.getTransactionFeesAmountByName("CARD"),e.cardAmount||this.manualReceiptPage.controls.cardAmount.setValue((+e.amount).toFixed(2)),this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[0].value)):"CASH"==e.paymentBy?(this.cashDetails=!0,this.manualReceiptPage.controls.cash.setValue(!0),$(".selectAllWhenFilter2").prop("checked",!0),this.splitArray.push(2),this.transactionAmount=this.getTransactionFeesAmountByName("CASH"),this.manualReceiptPage.controls.cash.setValue(!0),this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[1].value),this.manualReceiptPage.controls.cashAmount.setValue((+this.manualReceiptPage.controls.cashAmount.value).toFixed(2))):"MONEYORDER"==e.paymentBy?(this.moneyOrder=!0,this.manualReceiptPage.controls.moneyOrder.setValue(!0),$(".selectAllWhenFilter3").prop("checked",!0),this.splitArray.push(3),this.transactionAmount=this.getTransactionFeesAmountByName("MO"),this.manualReceiptPage.controls.moneyOrder.setValue(!0),this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[2].value),this.manualReceiptPage.controls.moneyOrderAmount.setValue((+this.manualReceiptPage.controls.moneyOrderAmount.value).toFixed(2))):(this.manualReceiptPage.controls.paymentBy.setValue(this.paymentByEnumConstants[3].value),e.cashAmount&&e.cardAmount?(this.fillCardDetails(e),this.cashDetails=!0,$(".selectAllWhenFilter2").prop("checked",!0),this.splitArray.push(2),this.transactionAmount=this.getTransactionFeesAmountByName("CARD_CASH"),this.manualReceiptPage.controls.cash.setValue(!0),this.manualReceiptPage.controls.cardAmount.setValue((+this.manualReceiptPage.controls.cardAmount.value).toFixed(2)),this.manualReceiptPage.controls.cashAmount.setValue((+this.manualReceiptPage.controls.cashAmount.value).toFixed(2))):e.cardAmount&&e.moneyOrderAmount?(this.fillCardDetails(e),this.moneyOrder=!0,$(".selectAllWhenFilter3").prop("checked",!0),this.splitArray.push(3),this.transactionAmount=this.getTransactionFeesAmountByName("CARD_MO"),this.manualReceiptPage.controls.moneyOrder.setValue(!0),this.manualReceiptPage.controls.cardAmount.setValue((+this.manualReceiptPage.controls.cardAmount.value).toFixed(2)),this.manualReceiptPage.controls.moneyOrderAmount.setValue((+this.manualReceiptPage.controls.moneyOrderAmount.value).toFixed(2))):(this.cashDetails=!0,this.moneyOrder=!0,$(".selectAllWhenFilter2").prop("checked",!0),$(".selectAllWhenFilter3").prop("checked",!0),this.splitArray.push(2),this.splitArray.push(3),this.manualReceiptPage.controls.moneyOrder.setValue(!0),this.manualReceiptPage.controls.cash.setValue(!0),this.transactionAmount=this.getTransactionFeesAmountByName("CASH_MO"),this.manualReceiptPage.controls.cashAmount.setValue((+this.manualReceiptPage.controls.cashAmount.value).toFixed(2)),this.manualReceiptPage.controls.moneyOrderAmount.setValue((+this.manualReceiptPage.controls.moneyOrderAmount.value).toFixed(2)))),this.initValidatorJquery(),this.transactionAmount>0&&!this.paymentTransactionAdmin?(this.showPaymentTransactionFeesWarning=!0,this.paymentTransactionFeesWarningAmount="Payment Transaction fees $"+this.transactionAmount+" is added.",this.totalCollecatedAmountByUser=+e.amount-+this.transactionAmount,this.isTotalCollecatedAmountByUser=!0):this.amwinsCardTransactionFees&&this.windhavenCardTransactionFees&&this.falconCardTransactionFees||(this.showPaymentTransactionFeesWarning=!1),this.checkManualReceiptPageDynamicCondition()?(this.showMakePaymentWarning=!0,this.makePaymentWarning="Please make sure you post this payment at "+this.ProductConstant.getProductModelByProduct(this.productEnumConstants[this.manualReceiptPage.controls.product.value].name).label+" as well to complete the transaction."):this.showMakePaymentWarning=!1,this.splitArray.includes(3)&&this.manualReceiptService.getMoneyOrderDocment(e.decryptedId).subscribe(function(e){e&&(t.moFile=e.data.documentName)}),this.checkTransactionTypeForPremiumZero()?(this.manualReceiptPage.get("premiumAmount").setValidators([l.Validators.required,l.Validators.pattern(this.amountPattern),l.Validators.max(999999.999),l.Validators.min(0)]),this.manualReceiptPage.get("premiumAmount").updateValueAndValidity()):(this.manualReceiptPage.get("premiumAmount").setValidators([l.Validators.required,l.Validators.pattern(this.amountPattern),l.Validators.max(999999.999),l.Validators.min(1)]),this.manualReceiptPage.get("premiumAmount").updateValueAndValidity())},e.prototype.fillCardDetails=function(e){var t;if(this.cardDetails=!0,this.manualReceiptPage.controls.card.setValue(!0),$(".selectAllWhenFilter1").prop("checked",!0),this.manualReceiptPage.controls.cardAmount.setValue((+this.manualReceiptPage.controls.cardAmount.value).toFixed(2)),this.splitArray.push(1),e.creditCardInfo){this.manualReceiptPage.patchValue(e.creditCardInfo);for(var a=0;a<this.cardMonths.length;a++)if(this.cardMonths[a].value==e.creditCardInfo.expiryMonth){t=this.cardMonths[a];break}var n=void 0;for(a=0;a<this.cardYears.length;a++)if(this.cardYears[a].value==e.creditCardInfo.expiryYear){n=this.cardYears[a];break}t&&this.manualReceiptPage.controls.expiryMonth.setValue(t.value),n&&this.manualReceiptPage.controls.expiryYear.setValue(n.value),this.validateSavedCardExpiry(),this.manualReceiptPage.controls.cardNumber.value&&this.onCardNumberEnter(void 0),this.onCardNumberBlur()}this.initValidatorJquery()},e.prototype.updateMRTransaction=function(e){return B(this,void 0,void 0,function(){var t,a,n,o=this;return q(this,function(i){switch(i.label){case 0:return console.log(e),!0,this.isEditable?[4,this.updateConfirmationPopUp(e)]:[3,2];case 1:if(!i.sent())return this.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit"),this.blockUI.stop(),[2];i.label=2;case 2:return"NEW_BUSINESS"==this.manualReceiptPage.controls.transactionType.value||2==this.manualReceiptPage.controls.transactionType.value?(this.blockUI.stop(),t=void 0!=this.manualReceiptPage.controls.policyNumber.value?this.manualReceiptPage.controls.policyNumber.value.trim().toUpperCase():"",a={backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{title:"Enter Policy Number.",okButton:{label:"OK"},cancelButton:{label:"Cancel"},enteredPolicyNumber:t}},this.modalService.show(k.a,a).content.onDriverDetailsUpdate.subscribe(function(t){if(0!=t){o.blockUI.start("please wait...");var a=o.isEditable?o.paymentId:0;e.paymentRequest.policyVersion.policy.policyNumber=t.policyNumber,o.manualReceiptService.updatePaymentTransaction(e,o.file,a).subscribe(function(e){o.blockUI.stop(),o.isFormSubmitted=!0,o.router.navigate([h.b.EMPLOYE+"/"+h.b.CUSTOMER_POLICY_PROFILE],{queryParams:{id:e.data.customer.encryptedId,policyId:e.data.policyId}})},function(e){o.blockUI.stop(),o.idleService.isTimeOutWarningDisplayed=!0,(0==e.status||JSON.parse(e._body).error)&&o.loginService.checkErrorResponse(e),o.commonService.showErrorMessage(JSON.parse(e._body).message)}),console.log("capture")}else o.blockUI&&(console.log("void"),o.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit"),o.blockUI.stop());console.log(t)})):(this.blockUI.start("Please wait..."),n=this.isEditable?this.paymentId:0,this.manualReceiptService.updatePaymentTransaction(e,this.file,n).subscribe(function(e){console.log(e),o.isFormSubmitted=!0,o.blockUI.stop(),o.router.navigate([h.b.EMPLOYE+"/"+h.b.CUSTOMER_POLICY_PROFILE],{queryParams:{id:e.data.customer.encryptedId,policyId:e.data.policyId}})},function(e){o.blockUI.stop(),console.error(e)})),this.commonService.removeLoadingImageInButton("#btnManualReceiptSubmit"),[2]}})})},e.prototype.setTransactionUpdatedValue=function(){var e=new V(this.manualReceiptPage.value);this.paymentTransactionInfo.paymentBy=e.paymentBy,this.paymentTransactionInfo.cardAmount=e.cardAmount,this.paymentTransactionInfo.cashAmount=e.cashAmount,this.paymentTransactionInfo.moneyOrderAmount=e.moneyOrderAmount},e.prototype.updateConfirmationPopUp=function(e){var t=this;return new Promise(function(a){var n=[],o=t.transactionTypeEnumConstants[e.paymentRequest.transactionType].name;if(o!=t.previousPaymentInfo.transactionType){var i={name:"transactionType",displayName:"Transaction Type",oldValue:t.TransactionTypeConstant.getTransactionTypeModelByTransacationType(t.previousPaymentInfo.transactionType).label,newValue:t.TransactionTypeConstant.getTransactionTypeModelByTransacationType(o).label};n.push(i)}var l=t.customerAvailabilityEnumConstants[e.paymentRequest.customerAvailability].name;if(l!==t.previousPaymentInfo.customerAvailability){i={name:"customerAvailability",displayName:"Customer Availability",oldValue:null===t.previousPaymentInfo.customerAvailability?"null":t.CustomerAvailabilityConstant.getCustomerAvailabilityModelByCustomerAvailability(t.previousPaymentInfo.customerAvailability).label,newValue:t.CustomerAvailabilityConstant.getCustomerAvailabilityModelByCustomerAvailability(l).label};n.push(i)}if(e.paymentRequest.amount!=t.previousPaymentInfo.amount){i={name:"totalAmount",displayName:"Total Collected",oldValue:"$"+(+t.previousPaymentInfo.amount).toFixed(2),newValue:"$"+e.paymentRequest.amount};n.push(i)}if(e.paymentRequest.premiumAmount!=t.previousPaymentInfo.premiumAmount){i={name:"premiumAmount",displayName:"Premium Collected",oldValue:"$"+(+t.previousPaymentInfo.premiumAmount).toFixed(2),newValue:"$"+e.paymentRequest.premiumAmount};n.push(i)}if(e.agent!=t.previousPaymentInfo.agent.decryptedId){var r=t.agents.filter(function(e){return e.id==t.previousPaymentInfo.agent.decryptedId})[0],s=t.agents.filter(function(t){return t.id==e.agent})[0];i={name:"agent",displayName:"Agent",oldValue:r?r.name:"",newValue:s.name};n.push(i)}if(e.office!=t.previousPaymentInfo.office.id){var c=t.offices.filter(function(e){return e.decryptedId==t.previousPaymentInfo.office.id})[0],u=t.offices.filter(function(t){return t.decryptedId==e.office})[0];i={name:"office",displayName:"Office",oldValue:c.name,newValue:u.name};n.push(i)}if(e.updatedCreatedDateTime!=t.previousPaymentInfo.updatedCreatedDatetime.split(" ")[0]){i={name:"transactionCreatedDate",displayName:"Transaction Created Date",oldValue:t.previousPaymentInfo.updatedCreatedDatetime.split(" ")[0],newValue:e.updatedCreatedDateTime};n.push(i)}if(e.paymentRequest.agentNotes!=t.previousPaymentInfo.agentNotes){i={name:"agentNotes",displayName:"Agent Notes",oldValue:t.previousPaymentInfo.agentNotes,newValue:e.paymentRequest.agentNotes};n.push(i)}var m=t.paymentByEnumConstants[e.paymentRequest.paymentBy].name;if(m!=t.previousPaymentInfo.paymentBy){i={name:"paymentBy",displayName:"Payment Method",oldValue:"MONEYORDER"==t.previousPaymentInfo.paymentBy?"MO":t.previousPaymentInfo.paymentBy,newValue:"MONEYORDER"==m?"MO":m};n.push(i)}if(("CASH"==m||"SPLIT"==m)&&e.paymentRequest.cashAmount!=t.previousPaymentInfo.cashAmount){i={name:"cashAmount",displayName:"Cash Amount",oldValue:null!=t.previousPaymentInfo.cashAmount?"$"+(+t.previousPaymentInfo.cashAmount).toFixed(2):"",newValue:"$"+e.paymentRequest.cashAmount};n.push(i)}if("CARD"==m||"SPLIT"==m){if(e.paymentRequest.cardAmount!=t.previousPaymentInfo.cardAmount&&e.paymentRequest.cardAmount){i={name:"cardAmount",displayName:"Card Amount",oldValue:null!=t.previousPaymentInfo.cardAmount?"$"+(+t.previousPaymentInfo.cardAmount).toFixed(2):"",newValue:"$"+e.paymentRequest.cardAmount};n.push(i)}if(t.previousPaymentInfo.creditCardInfo&&t.splitArray.includes(1)){if(e.paymentRequest.cardHolderName!=t.previousPaymentInfo.creditCardInfo.cardHolderName){i={name:"cardHolderName",displayName:"Card Holder Name",oldValue:t.previousPaymentInfo.creditCardInfo.cardHolderName,newValue:e.paymentRequest.cardHolderName};n.push(i)}if(e.paymentRequest.cardNumber!=t.previousPaymentInfo.creditCardInfo.cardNumber){i={name:"cardNumber",displayName:"Card Number",oldValue:t.previousPaymentInfo.creditCardInfo.cardNumber,newValue:e.paymentRequest.cardNumber};n.push(i)}if(e.paymentRequest.expiryMonth!=t.previousPaymentInfo.creditCardInfo.expiryMonth){i={name:"expiryMonth",displayName:"Expiry Month",oldValue:t.previousPaymentInfo.creditCardInfo.expiryMonth,newValue:e.paymentRequest.expiryMonth};n.push(i)}if(e.paymentRequest.expiryYear!=t.previousPaymentInfo.creditCardInfo.expiryYear){i={name:"expiryYear",displayName:"Expiry Year",oldValue:t.previousPaymentInfo.creditCardInfo.expiryYear,newValue:e.paymentRequest.expiryYear};n.push(i)}if(e.paymentRequest.address!=t.previousPaymentInfo.creditCardInfo.address){i={name:"address",displayName:"Billing Address",oldValue:t.previousPaymentInfo.creditCardInfo.address,newValue:e.paymentRequest.address};n.push(i)}if(e.paymentRequest.city!=t.previousPaymentInfo.creditCardInfo.city){i={name:"city",displayName:"City",oldValue:t.previousPaymentInfo.creditCardInfo.city,newValue:e.paymentRequest.city};n.push(i)}if(e.paymentRequest.stateId!=t.previousPaymentInfo.creditCardInfo.state.encryptedId){var d=t.states.filter(function(e){return e.encryptedId==t.previousPaymentInfo.creditCardInfo.state.encryptedId})[0],p=t.states.filter(function(t){return t.encryptedId==e.paymentRequest.stateId})[0];i={name:"state",displayName:"State",oldValue:d.name,newValue:p.name};n.push(i)}if(e.paymentRequest.zipcode!=t.previousPaymentInfo.creditCardInfo.zipcode){i={name:"zipcode",displayName:"Zip Code",oldValue:t.previousPaymentInfo.creditCardInfo.zipcode,newValue:e.paymentRequest.zipcode};n.push(i)}}else if(e.paymentRequest.cardHolderName&&t.splitArray.includes(1)){i={name:"cardDetails",displayName:"Card Details",oldValue:null,newValue:"Card details added."};n.push(i)}}if("MONEYORDER"==m||"SPLIT"==m){if(e.paymentRequest.moneyOrderAmount&&null!=t.previousPaymentInfo.moneyOrderAmount){if(e.paymentRequest.moneyOrderAmount!=t.previousPaymentInfo.moneyOrderAmount){i={name:"moneyOrderAmount",displayName:"MO Amount",oldValue:null!=t.previousPaymentInfo.moneyOrderAmount?"$"+(+t.previousPaymentInfo.moneyOrderAmount).toFixed(2):"",newValue:"$"+e.paymentRequest.moneyOrderAmount};n.push(i)}}else if(e.paymentRequest.moneyOrderAmount){i={name:"moneyOrderAmount",displayName:"MO Amount",oldValue:"",newValue:"$"+e.paymentRequest.moneyOrderAmount};n.push(i)}if(t.file){i={name:"moneyOrderDoc",displayName:"MO Document",oldValue:t.moFile,newValue:t.file.name};n.push(i)}}if(null!==e.paymentRequest.policyVersion.heardAboutUs&&void 0!==e.paymentRequest.policyVersion.heardAboutUs){t.heardAboutUsOldValue=t.heardAboutUsEnumConstants.filter(function(t){return t.value==e.paymentRequest.policyVersion.heardAboutUs});var h=t.heardAboutUsOldValue[0].name;if(h!==t.previousPaymentInfo.policyVersion.heardAboutUs){i={name:"heardAboutUs",displayName:"How did you hear about us",oldValue:null===t.previousPaymentInfo.policyVersion.heardAboutUs?"null":t.HeardAboutUsConstant.getHeardAboutUsModelByHeardAboutUs(t.previousPaymentInfo.policyVersion.heardAboutUs).label,newValue:t.HeardAboutUsConstant.getHeardAboutUsModelByHeardAboutUs(h).label};n.push(i)}}var y={backdrop:!0,ignoreBackdropClick:!0,animated:!0,keyboard:!1,initialState:{okButton:{label:"OK"},updatedFieldsDetails:n}};t.blockUI.stop(),t.modalService.show(O.a,y).content.onClose.subscribe(function(e){a(void 0!=e&&1==e)})})},e.prototype.resetOnlyCreditCardDetails=function(){$(".selectAllWhenFilter1").prop("checked",!1),this.cardDetails=!1,this.manualReceiptPage.controls.card.setValue(void 0),this.manualReceiptPage.get("address").clearValidators(),this.manualReceiptPage.get("aprtUntNumber").clearValidators(),this.manualReceiptPage.get("city").clearValidators(),this.manualReceiptPage.get("stateId").clearValidators(),this.manualReceiptPage.get("zipcode").clearValidators(),this.manualReceiptPage.get("cardHolderName").clearValidators(),this.manualReceiptPage.get("cardNumber").clearValidators(),this.manualReceiptPage.get("expiryMonth").clearValidators(),this.manualReceiptPage.get("expiryYear").clearValidators(),this.manualReceiptPage.get("cvv").clearValidators(),this.manualReceiptPage.get("moneyOrderAmount").clearValidators(),this.manualReceiptPage.get("cashAmount").clearValidators(),this.manualReceiptPage.get("moneyOrderUpload").clearValidators(),this.manualReceiptPage.get("cardAmount").clearValidators()},e.prototype.setValidatorsOnAgent=function(){this.manualReceiptPage.get("agent").setValidators([l.Validators.required]),this.manualReceiptPage.get("agent").updateValueAndValidity()},e.prototype.setValidatorsOnOffice=function(){this.manualReceiptPage.get("office").setValidators([l.Validators.required]),this.manualReceiptPage.get("office").updateValueAndValidity()},e.prototype.ngAfterViewInit=function(){this.paymentTransactionAdmin&&(this.initDatePicker(),this.updateOfficeAndAgent())},e.prototype.updateOfficeAndAgent=function(){var e=this;$(".selectpicker").selectpicker({selectOnTab:!0}),this.manualReceiptService.getAllActiveAgents().subscribe(function(t){void 0!=t&&void 0!=t.data&&(e.agents=t.data,setTimeout(function(){e.manualReceiptPage.controls.agent.setValue(e.agentId),$(".selectpicker").selectpicker("refresh")},200))}),this.manualReceiptService.getAllActiveOffices().subscribe(function(t){void 0!=t&&void 0!=t.data&&(e.offices=t.data,setTimeout(function(){e.manualReceiptPage.controls.office.setValue(e.officeId),$(".selectpicker").selectpicker("refresh")},200))})},e.prototype.initDatePicker=function(){var e=this;$("#updatedCreatedDateTime").datepicker({format:"mm/dd/yyyy",timepicker:!1,inline:!0,keyboardNavigation:!1,autoclose:!0,closeOnDateSelect:!0,clearBtn:!0,startDate:moment().subtract(30,"years").calendar(),endDate:moment().calendar(),orientation:"top"}).on("changeDate",function(t){e.isTransactionDateChanged=!0,e.manualReceiptPage.controls.updatedCreatedDateTime.setValue($("#updatedCreatedDateTime").val())}).on("clearDate",function(t){(void 0==$("#updatedCreatedDateTime").val()||void 0!=$("#updatedCreatedDateTime").val()&&0==$("#updatedCreatedDateTime").val().length)&&($("#updatedCreatedDateTime").datepicker("setDate",moment().calendar()),$("#updatedCreatedDateTime").val(""),e.manualReceiptPage.controls.updatedCreatedDateTime.setValue(""))}),setTimeout(function(){$("#transactionDateCalender").on("click",function(){$("#updatedCreatedDateTime").focus()})},100)},e.prototype.setDatePicker=function(e){console.log(" datePicker : "+$("#updatedCreatedDateTime").data("datepicker")),$("#updatedCreatedDateTime").datepicker("setDate",e)},e.prototype.hideAll=function(){var e=document.querySelectorAll(".modal.in");if(e)for(var t=0;t<e.length;t++){var a=e[t].getElementsByClassName("modal-header");if(a&&a.length>0){var n=a[0].getElementsByTagName("BUTTON");n&&n.length>0&&n[0].click()}}},e.prototype.minimumCardAmountValidation=function(){var e=this.manualReceiptPage.controls.cardAmount;!this.paymentTransactionAdmin&&this.splitArray.includes(1)&&+this.manualReceiptPage.controls.cardAmount.value<+h.a.MIN_CARD_AMOUNT&&(e.setErrors({invalidAmount:"Card Amount should be atleast $15 or more."}),e.markAsTouched())},e.prototype.updateCardTransactionFeesForAmWins=function(){if(!this.paymentTransactionAdmin){if(this.manualReceiptPage.controls.paymentBy.value!=this.paymentByEnumConstants[0].value||1!=this.manualReceiptPage.controls.transactionType.value&&5!=this.manualReceiptPage.controls.transactionType.value)this.amwinsCardTransactionFees=!1,this.windhavenCardTransactionFees=!1,this.falconCardTransactionFees=!1;else{3==this.manualReceiptPage.controls.product.value?(this.transactionAmount=h.a.AMWINS_CARD_TRANSACTION_FEE,this.amwinsCardTransactionFees=!0,this.manualReceiptPage.controls.cardAmount.setValue((this.totalCollecatedAmountByUser+this.transactionAmount).toFixed(2))):38==this.manualReceiptPage.controls.product.value?(this.transactionAmount=h.a.WINDHAVEN_CARD_TRANSACTION_FEE,this.windhavenCardTransactionFees=!0,this.manualReceiptPage.controls.cardAmount.setValue((this.totalCollecatedAmountByUser+this.transactionAmount).toFixed(2))):12==this.manualReceiptPage.controls.product.value&&(this.transactionAmount=h.a.FALCON_CARD_TRANSACTION_FEE,this.falconCardTransactionFees=!0,this.manualReceiptPage.controls.cardAmount.setValue((this.totalCollecatedAmountByUser+this.transactionAmount).toFixed(2)));var e=+this.totalCollecatedAmountByUser+ +this.transactionAmount;+e<+this.manualReceiptPage.controls.premiumAmount.value?this.manualReceiptPage.controls.amount.setValue((+this.manualReceiptPage.controls.premiumAmount.value).toFixed(2)):(this.manualReceiptPage.controls.amount.reset(),this.manualReceiptPage.controls.amount.setValue(e.toFixed(2)))}this.minimumCardAmountValidation()}this.transactionAmount>0&&!this.paymentTransactionAdmin?(this.showPaymentTransactionFeesWarning=!0,this.amwinsCardTransactionFees||this.windhavenCardTransactionFees||this.falconCardTransactionFees?38==this.manualReceiptPage.controls.product.value?this.paymentTransactionFeesWarningAmount="Windhaven Card Payment Transaction fees $"+h.a.AMWINS_CARD_TRANSACTION_FEE+" is added.":3==this.manualReceiptPage.controls.product.value?this.paymentTransactionFeesWarningAmount="AmWins Card Payment Transaction fees $"+h.a.WINDHAVEN_CARD_TRANSACTION_FEE+" is added.":12==this.manualReceiptPage.controls.product.value&&(this.paymentTransactionFeesWarningAmount="Falcon Card Payment Transaction fees $"+h.a.FALCON_CARD_TRANSACTION_FEE+" is added."):this.paymentTransactionFeesWarningAmount="Payment Transaction fees $"+this.transactionAmount+" is added."):this.showPaymentTransactionFeesWarning=!1},e.prototype.removeCardValidations=function(){var e=this;setTimeout(function(){e.manualReceiptPage.get("address").clearValidators(),e.manualReceiptPage.get("address").updateValueAndValidity(),e.manualReceiptPage.get("aprtUntNumber").clearValidators(),e.manualReceiptPage.get("city").clearValidators(),e.manualReceiptPage.get("city").updateValueAndValidity(),e.manualReceiptPage.get("stateId").clearValidators(),e.manualReceiptPage.get("stateId").updateValueAndValidity(),e.manualReceiptPage.get("zipcode").clearValidators(),e.manualReceiptPage.get("zipcode").updateValueAndValidity(),e.manualReceiptPage.get("cardHolderName").clearValidators(),e.manualReceiptPage.get("cardHolderName").updateValueAndValidity(),e.manualReceiptPage.get("cardNumber").clearValidators(),e.manualReceiptPage.get("cardNumber").updateValueAndValidity(),e.manualReceiptPage.get("expiryMonth").clearValidators(),e.manualReceiptPage.get("expiryMonth").updateValueAndValidity(),e.manualReceiptPage.get("expiryYear").clearValidators(),e.manualReceiptPage.get("expiryYear").updateValueAndValidity(),e.manualReceiptPage.get("cvv").clearValidators(),e.manualReceiptPage.get("cvv").updateValueAndValidity()},500)},e.prototype.openPaymentSchedules=function(e){this.isShowSchedule=!this.isShowSchedule,e.stopPropagation(),e.preventDefault()},e.prototype.closePaymentScheduleBox=function(e){this.isShowSchedule=!1},e.prototype.fetchRenewalDetails=function(){var e=this;return new Promise(function(t){var a=e.productEnumConstants[e.manualReceiptCheckPolicyForm.controls.product.value].name;e.manualReceiptService.getRenewPolicyDetails(a,e.searchedPolicy).subscribe(function(a){a?(localStorage.setItem("installmentDueDates",a.data.installmentDueDates),localStorage.setItem("installmentsAmounts",a.data.installmentsAmounts),e.downPayAmount=a.data.downPaymentDue,e.downPayAmount&&(e.premiumAmount=e.downPayAmount,e.collectedAmount=a.data.amount,e.fullPayAmount=a.data.totalPremium,e.lateFees=parseFloat(e.collectedAmount)-parseFloat(e.premiumAmount),e.installmentDueDates=localStorage.getItem("installmentDueDates").split(","),e.installmentsAmounts=localStorage.getItem("installmentsAmounts").split(","),e.renewalFeeAmount=a.data.userServiceRenewFee[0].amount,e.transactionTypeRenewalSelected=!0),t(!0)):t(!1)},function(a){(0==a.status||JSON.parse(a._body).error)&&e.loginService.checkErrorResponse(a),e.commonService.showErrorMessage(JSON.parse(a._body).message),t(!1)})})},e.prototype.fetchRenewalFees=function(){var e=this;return new Promise(function(t){var a=e.commonService.getLoginUserDetails();e.manualReceiptService.fetchRenewalFees(a.encryptedId).subscribe(function(a){a?(e.renewalFeeAmount=a.data[0].amount,t(!0)):t(!1)},function(a){(0==a.status||JSON.parse(a._body).error)&&e.loginService.checkErrorResponse(a),e.commonService.showErrorMessage(JSON.parse(a._body).message),t(!1)})})},e.prototype.verifyTotalAndPremiumAmount=function(){if(!this.paymentTransactionAdmin){var e=parseFloat(this.manualReceiptPage.controls.amount.value),t=parseFloat(this.manualReceiptPage.controls.premiumAmount.value);if(0==this.manualReceiptPage.controls.transactionType.value||1==this.manualReceiptPage.controls.transactionType.value||5==this.manualReceiptPage.controls.transactionType.value)if(e<t){var a=+t;this.lateFees&&(a=+a+ +this.lateFees),this.renewalFeeAmount>0&&5==this.manualReceiptPage.controls.transactionType.value&&this.updateRenewalFeeWithTotalCollecationAmount(),this.manualReceiptPage.controls.amount.setValue((+a).toFixed(2))}else if(this.lateFees){a=+t;this.lateFees&&(a=+a+ +this.lateFees),this.renewalFeeAmount>0&&5==this.manualReceiptPage.controls.transactionType.value&&this.updateRenewalFeeWithTotalCollecationAmount(),e<a&&this.manualReceiptPage.controls.amount.setValue((+a).toFixed(2))}}},e.prototype.getAllActiveAgentList=function(){var e=this;this.manualReceiptService.getAllActiveAgents().subscribe(function(t){void 0!=t&&void 0!=t.data&&(e.agents=t.data,setTimeout(function(){$(".selectpicker").selectpicker("refresh")},200))})},e.prototype.quotedByChange=function(e){console.log(this.manualReceiptPage.controls.quotedBy.value)},e.prototype.updatePaymentAmount=function(e){this.splitArray.length>0&&(this.manualReceiptPage.controls.paymentBy.value==this.paymentByEnumConstants[3].value?this.splitArray.includes(1)&&this.splitArray.includes(2)?(this.manualReceiptPage.controls.cardAmount.setValue((+e).toFixed(2)),this.manualReceiptPage.controls.cashAmount.setValue(void 0),this.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0)):this.splitArray.includes(1)&&this.splitArray.includes(3)?(this.manualReceiptPage.controls.cardAmount.setValue((+e).toFixed(2)),this.manualReceiptPage.controls.cashAmount.setValue(void 0),this.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0)):(this.transactionAmount=this.getTransactionFeesAmountByName("CASH_MO"),this.manualReceiptPage.controls.cashAmount.setValue((+e).toFixed(2)),this.manualReceiptPage.controls.cardAmount.setValue(void 0),this.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0)):this.manualReceiptPage.controls.paymentBy.value==this.paymentByEnumConstants[0].value?(this.transactionAmount=this.getTransactionFeesAmountByName("CARD"),this.manualReceiptPage.controls.cardAmount.setValue((+e).toFixed(2)),this.manualReceiptPage.controls.cashAmount.setValue(void 0),this.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0)):this.manualReceiptPage.controls.paymentBy.value==this.paymentByEnumConstants[1].value?(this.transactionAmount=this.getTransactionFeesAmountByName("CASH"),this.manualReceiptPage.controls.cashAmount.setValue((+e).toFixed(2)),this.manualReceiptPage.controls.cardAmount.setValue(void 0),this.manualReceiptPage.controls.moneyOrderAmount.setValue(void 0)):this.manualReceiptPage.controls.paymentBy.value==this.paymentByEnumConstants[2].value&&(this.transactionAmount=this.getTransactionFeesAmountByName("MO"),this.manualReceiptPage.controls.moneyOrderAmount.setValue((+e).toFixed(2)),this.manualReceiptPage.controls.cashAmount.setValue(void 0),this.manualReceiptPage.controls.cardAmount.setValue(void 0)))},x([Object(E.BlockUI)(),D("design:type",Object)],e.prototype,"blockUI",void 0),e=x([Object(n.Component)({selector:"employeManualReceipt-content",template:a("Zto+")}),D("design:paramtypes",[o.b,o.a,r.a,s.a,c.a,u.a,m.a,d.a,n.NgZone,I.a,p.a,M.a])],e)}(),L=a("XhAN"),Y=[{path:"",component:W,canDeactivate:[L.a]}],H=o.c.forChild(Y),z=a("8nFs"),J=a("VWgf");a.d(t,"EmployeManualReceiptModule",function(){return Z});var K=this&&this.__decorate||function(e,t,a,n){var o,i=arguments.length,l=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(l=(i<3?o(l):i>3?o(t,a,l):o(t,a))||l);return i>3&&l&&Object.defineProperty(t,a,l),l},Z=function(){function e(){}return e=K([Object(n.NgModule)({imports:[i.CommonModule,l.FormsModule,l.ReactiveFormsModule,H,z.a,o.c,J.TextMaskModule],declarations:[W]})],e)}()},"Zto+":function(e,t){e.exports='<block-ui [template]="blockTemplate"> </block-ui>\n\n<div class="panel with-nav-tabs panel-primary quote-main policy-main">\n\n   <div class="container">\n      <div class="row">\n         <div class="panel-body">\n            <div class="tab-content">\n               \x3c!-- /Start Tab start --\x3e\n               \x3c!-- <form autocomplete="off" [formGroup]="manualReceiptPage" novalidate name="startForm" (ngSubmit)="next(manualReceiptPage.value)">--\x3e\n               <div class="">\n                  <div class="col-md-offset-1 col-md-10 col-sm-12">\n                     <alert-message></alert-message>\n                  </div>\n               </div>\n               \n               \n               \x3c!-- Check Policy --\x3e\n               <form autocomplete="off" *ngIf="isShowFetchPolicy" [formGroup]="manualReceiptCheckPolicyForm" (keyup.enter)="fetchPolicy()" (ngSubmit)="fetchPolicy()">\n\t\t\t\t\t\t<div class="tab-pane fade in active" id="tab1primary">\n\t\t\t\t\t\t\t<div class="col-sm-12 mreceipt">\n\t\t\t\t\t\t\t\t<h2>\n\t\t\t\t\t\t\t\t\tManual Receipt Program <span>(Use this page to fetch policy for a customer)</span>\n\t\t\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="form-group col-sm-12">\n\t\t\t\t\t\t\t\t<div class="well additional-information">\n\t\t\t\t\t\t\t\t\t<h3>Transaction Details</h3>\n\t\t\t\t\t\t\t\t\t<div class="policy-field-wapper receiptpage">\n\t\t\t\t\t\t\t\t\t\t<div class="row">\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="form-group col-sm-4 col-xs-7">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label class="control-label">Transaction Type<em>*</em>:</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div [ngClass]="{ \'quote-select-has-error\' : (manualReceiptCheckPolicyForm.controls[\'transactionType\'].invalid && \n                                        \t\tmanualReceiptCheckPolicyForm.controls[\'transactionType\'].dirty && manualReceiptCheckPolicyForm.controls[\'transactionType\'].value == \'\') ||\n                                        \t\tmanualReceiptCheckPolicyForm.controls[\'transactionType\'].hasError(\'required\') && manualReceiptCheckPolicyForm.controls[\'transactionType\'].touched }" \n                                        \t\tcontainerClass="errorTooltip"\n                                        \t\t[isDisabled]="( (manualReceiptCheckPolicyForm.controls[\'transactionType\'].dirty && manualReceiptCheckPolicyForm.controls[\'transactionType\'].invalid) \n                                        \t\t|| (manualReceiptCheckPolicyForm.controls[\'transactionType\'].hasError(\'required\') && manualReceiptCheckPolicyForm.controls[\'transactionType\'].touched) ) ? false : true"\n                                        \t\ttooltip="Transaction type is required">\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t<select class="selectpicker"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tformControlName="transactionType"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(change)="setValidatorsOnFetchPolicyNumber()"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-live-search="true" data-dropup-auto="false"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-actions-box="true" data-selected-text-format="count"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-size="5">\n\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value="">No Transaction</option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t*ngFor="let transaction of transactionTypeEnumConstants"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[ngValue]="transaction.value">{{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTransactionTypeConstant.getTransactionTypeModelByTransacationType(transaction.name).label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}</option>\n\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t<div class="form-group col-sm-4 col-xs-5 pl0">\n\n\t\t\t\t\t\t\t\t\t\t\t\t<label class="control-label">Product<em>*</em> :</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<div [ngClass]="{ \'quote-select-has-error\' : (manualReceiptCheckPolicyForm.controls[\'product\'].invalid && \n                                        \t\tmanualReceiptCheckPolicyForm.controls[\'product\'].dirty && manualReceiptCheckPolicyForm.controls[\'product\'].value == \'\') ||\n                                        \t\tmanualReceiptCheckPolicyForm.controls[\'product\'].hasError(\'required\') && manualReceiptCheckPolicyForm.controls[\'product\'].touched }" \n                                        \t\tcontainerClass="errorTooltip"\n                                        \t\t[isDisabled]="( (manualReceiptCheckPolicyForm.controls[\'product\'].dirty && manualReceiptCheckPolicyForm.controls[\'product\'].invalid) \n                                        \t\t|| (manualReceiptCheckPolicyForm.controls[\'product\'].hasError(\'required\') && manualReceiptCheckPolicyForm.controls[\'product\'].touched) ) ? false : true"\n                                        \t\ttooltip="Product is required">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<select class="selectpicker" id="selectProduct"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tformControlName="product" data-live-search="true"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-dropup-auto="false" data-actions-box="true"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-selected-text-format="count" data-size="5"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontainerClass="errorTooltip">\n\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value="">No Product</option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option *ngFor="let productEnum of productEnumConstants"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[ngValue]="productEnum.value">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ProductConstant.getProductModelByProduct(productEnum.name).label}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div *ngIf="manualReceiptCheckPolicyForm.controls[\'transactionType\'].value != 2" class="form-group col-sm-4 col-xs-12">\n\t\t\t\t\t\t\t\t\t\t\t\t<label class="control-label">Policy Number<em\n\t\t\t\t\t\t\t\t\t\t\t\t\t*ngIf="manualReceiptCheckPolicyForm.controls[\'policyNumber\'].validator != null">*</em>\n\t\t\t\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\t\t\t\t</label> \n\t\t\t\t\t\t\t\t\t\t\t\t<input autocomplete="off" type="text" class="form-control"\n\t\t\t\t\t\t\t\t\t\t\t\t\tformControlName="policyNumber" id="policyNumber"\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontainerClass="errorTooltip" maxlength="16"\n\t\t\t\t\t\t\t\t\t\t\t\t\t(keypress)="omit_special_char($event)"\n\t\t\t\t\t\t\t\t\t\t\t\t\t(keyup)="onPolicyNumberKeyUp($event)"\n\t\t\t\t\t\t\t\t\t\t\t\t\t(blur)="onPolicyNumberKeyUp($event)"\n\t\t\t\t\t\t\t\t\t\t\t\t\t[ngClass]="{ \'quote-has-error\' : manualReceiptCheckPolicyForm.controls.policyNumber.invalid && manualReceiptCheckPolicyForm.controls.policyNumber.touched }"\n\t\t\t\t\t\t\t\t\t\t\t\t\t[isDisabled]="!manualReceiptCheckPolicyForm.controls[\'policyNumber\'].touched || !manualReceiptCheckPolicyForm.controls[\'policyNumber\'].invalid"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip="{{ manualReceiptCheckPolicyForm.controls[\'policyNumber\'].errors?.policyNumberExist ? \'Policy number already exist\' : \'Policy number is required.\' }}"\n\t\t\t\t\t\t\t\t\t\t\t\t\trequired>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="col-xs-12">\n\t\t\t\t\t\t\t<div class="text-center quote-btns">\n\t\t\t\t\t\t\t\t<button type="button" class="btn btn-orange tab-btn1"\n\t\t\t\t\t\t\t\t\t(click)="fetchPolicy()">{{ (manualReceiptCheckPolicyForm.controls[\'transactionType\'].value != 2) ? \'Fetch Policy\' : \'Make Payment\' }} </button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>               \n               \n               \x3c!-- \t<input (blur)="resetDrityFlag()" > --\x3e\n               <form autocomplete="off" *ngIf="!isShowFetchPolicy" [formGroup]="manualReceiptPage">\n               <div class="tab-pane fade in active" id="tab1primary">\n                  <div class="col-md-offset-1 col-md-10 col-sm-12 mreceipt">\n                     <h2>Manual Receipt Program <span>(Use this page to create a receipt for a customer)</span></h2>\n                  </div>\n                  <div class="form-group col-md-offset-1 col-md-10 col-sm-12">\n                     <div class="well additional-information">\n                        <h3>Customer Information</h3>\n                        <div class="policy-field-wapper receiptpage">\n                           <div class="row">\n                              <div class="form-group col-sm-4 col-xs-7 plr">\n                                 <label class="control-label">First Name<em>*</em> :</label> \n                                 <input autocomplete="off" #firstName type="text" class="form-control " formControlName="firstName" id="fName"\n                                 [ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls.firstName.invalid && manualReceiptPage.controls.firstName.touched }"\n\t\t\t\t\t\t\t\t containerClass="errorTooltip" maxlength="20"\n                                 [isDisabled]="!manualReceiptPage.controls[\'firstName\'].touched || !manualReceiptPage.controls[\'firstName\'].invalid" \n                                 tooltip="{{ manualReceiptPage.controls[\'firstName\'].errors?.required ? \'First name is required.\' : \n                                 (manualReceiptPage.controls[\'firstName\'].errors?.pattern ? \'Only characters are allowed.\' : \'Valid first name\') }}"\n                                 (keyup)="onNameKeyUp($event, \'firstName\')"\n                                 (blur)="onNameBlur($event, \'firstName\'); submitForm()"\n                                 [attr.disabled]="((paymentId && !isNameChanged) || isEditable) ? \'disabled\' : null"\n                                 required>\n                              </div>\n                              <div class="form-group col-sm-2 col-xs-5 plr">\n                                 <label class="control-label">Middle Name :</label> \n\t\t\t\t\t\t\t\t <input autocomplete="off" type="text" class="form-control" formControlName="middleName" id="mName"\n                                 containerClass="errorTooltip" maxlength="15"\n                                 [ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls.middleName.invalid && manualReceiptPage.controls.middleName.touched }"\n                                 [isDisabled]="!manualReceiptPage.controls[\'middleName\'].touched || !manualReceiptPage.controls[\'middleName\'].invalid" \n                                 tooltip="{{ manualReceiptPage.controls[\'middleName\'].errors?.pattern ? \'Only characters are allowed.\' : \'Valid middle name\' }}"\n                                 (keyup)="onNameKeyUp($event, \'middleName\')"\n                                 (blur)="onNameBlur($event, \'middleName\')"\n                                 [attr.disabled]="((paymentId && !isNameChanged) || isEditable) ? \'disabled\' : null">\n                              </div>\n                              <div class="form-group col-sm-4 col-xs-7 plr">\n                                 <label class="control-label">Last Name<em>*</em> :</label> \n                                 <input autocomplete="off" type="text" class="form-control" \n\t\t\t\t\t\t\t\t formControlName="lastName"\n                                 containerClass="errorTooltip" maxlength="30"\n                                 [ngClass]="{ \'quote-has-error\': manualReceiptPage.controls[\'lastName\'].invalid && manualReceiptPage.controls[\'lastName\'].touched}" \n                                 [isDisabled]="!manualReceiptPage.controls[\'lastName\'].touched || !manualReceiptPage.controls[\'lastName\'].invalid"\n                                 tooltip="{{ manualReceiptPage.controls[\'lastName\'].errors?.required ? \'Last name is required.\' : \n                                 (manualReceiptPage.controls[\'lastName\'].errors?.pattern ? \'Only characters are allowed.\' : \'Valid last name\') }}"\n                                 (keyup)="onNameKeyUp($event, \'lastName\')"\n                                 (blur)="onNameBlur($event, \'lastName\'); submitForm()"\n                                 [attr.disabled]="((paymentId && !isNameChanged) || isEditable) ? \'disabled\' : null"\n                                 required>\n                              </div>\n                              <div class="form-group col-sm-2 col-xs-5 plr">\n                                 <label class="control-label">Suffix :</label> \n                                 <select class="selectpicker" formControlName="suffix" [attr.disabled]="((paymentId && !isNameChanged) || isEditable) ? \'disabled\' : null">\n                                    <option selected="" [ngValue]="undefined">None</option>\n                                    <option *ngFor="let suffix of suffixEnumConstants" [ngValue]="suffix.name">\n                                    {{SuffixConstant.getSuffixModelBySuffix(suffix.name).label}}\n                                    </option>\n                                 </select>\n                              </div>\n                           </div>\n                           <div class="row">\n                              <div class="form-group col-sm-6 col-xs-12 plr">\n                                 <label class="control-label">Email Address<em>*</em> :</label> \n                                 <input autocomplete="off" type="email" class="form-control"  \n                                 [ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls[\'email\'].invalid && manualReceiptPage.controls[\'email\'].touched }"\n                                 formControlName="email" (keyup)="onEmailKeyUp()"\n                                 containerClass="errorTooltip"\n                                 tooltip="{{ ( manualReceiptPage.controls[\'email\'].hasError(\'pattern\') ? \'Please enter valid email address.\' : (manualReceiptPage.controls[\'email\'].hasError(\'emailAddressIsRequired\') ? \'Email is required if Notification Method is Mail or Both\' : \'\' ) )}}" \n                                 [isDisabled]="!manualReceiptPage.controls[\'email\'].invalid || !manualReceiptPage.controls[\'email\'].touched" \n                                 [attr.disabled]="(isEditable) ? \'disabled\' : null"\n                                 (blur)="reEnterCorrectEmail()" required>\n                              </div>\n                              \n                              <div class="form-group col-sm-6 col-xs-12 plr">\n                                 <label class="control-label">Re-enter Email<em>*</em> :</label> \n                                 <input autocomplete="off" type="email" class="form-control" \n                                 \t[ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls[\'reEmail\'].invalid && manualReceiptPage.controls[\'reEmail\'].touched}"\n                                 \tformControlName="reEmail" (keyup)="onReEmailKeyUp()"\n                                 \tcontainerClass="errorTooltip"\n                                 \ttooltip="{{ ( manualReceiptPage.controls[\'reEmail\'].hasError(\'required\') ? \'Email address is required.\' : \n                                 \t\t(manualReceiptPage.controls[\'reEmail\'].hasError(\'reEnterCorrectEmail\') ? \'Please re-enter valid email address.\' : \n                                 \t\t(manualReceiptPage.controls[\'reEmail\'].hasError(\'pattern\') ? \'Please enter valid email address.\' : \'\') ) )}}"\n                                     [isDisabled] ="!manualReceiptPage.controls[\'reEmail\'].invalid || !manualReceiptPage.controls[\'reEmail\'].touched" \n                                     [attr.disabled]="(isEditable) ? \'disabled\' : null"\n                           \t\t\t(blur)= "reEnterCorrectEmail()"\n                           \t\t\toncopy="return false" oncut="return false" onpaste="return false" required>\n                           \t\t\t\n                              </div>\n                              <div class="form-group col-sm-6 col-xs-12 plr">\n                                 <label class="control-label">Phone Number<em>*</em> :</label> \n                                 <input autocomplete="off" type="tel" class="form-control" \n                                 [textMask]="{mask: mobileNoMask}" [(ngModel)]="mobileNo"\n                                 [ngClass]="{ \'quote-has-error\': manualReceiptPage.controls[\'mobileNo\'].invalid && manualReceiptPage.controls[\'mobileNo\'].touched || manualReceiptPage.controls[\'mobileNo\'].hasError(\'\')}"\n                                 containerClass="errorTooltip"\n                                 tooltip="{{ ( manualReceiptPage.controls[\'mobileNo\'].hasError(\'required\') ? \'Phone No. is required.\':manualReceiptPage.controls[\'mobileNo\'].hasError(\'\') ? \'Phone No. is not valid\' : (manualReceiptPage.controls[\'mobileNo\'].hasError(\'mobileNoIsRequired\') ? \'Phone No. is required if Notification Method is Text or Both\' : (manualReceiptPage.controls[\'mobileNo\'].hasError(\'invalidMobileNumber\')) ? \'Phone number can\\\'t be start with 0\\\'s.\' : \'\' ) )}}" \n                                 [isDisabled]="!manualReceiptPage.controls[\'mobileNo\'].touched || !manualReceiptPage.controls[\'mobileNo\'].invalid" \n                                 [attr.disabled]="(isEditable) ? \'disabled\' : null"\n                                 formControlName="mobileNo"\n                                 (blur)="validatePhoneNumber();" required>\t\t\t\t\t\t\t\t\t\t\t\n                              </div>\t\n                              <div class="form-group col-sm-6 col-xs-12 notification-method plr">\n                                 <label class="control-label">Notification Method :</label>\n                                 <select id="notificationMethod"  class="selectpicker" name="notificationMethod" formControlName="notificationMethod" \n                                 [attr.disabled]="(isEditable) ? \'disabled\' : null"\n                                 (change)="notificationMethodChanged()">\n                                 <option *ngFor="let notificationMethod of notificationMethodEnumConstants" [ngValue]="notificationMethod.value">\n                                 {{NotificationMethodConstant.getNotificationMethodModelByNotificationMethod(notificationMethod.name).label}}\n                                 </option>\n                                 </select>\n                                 \n                                 <a containerclass="infoTooltip" href="javascript:void(0);" placement="left" tooltip="Coming Soon!">\n                                 \t<i class="fa fa-question fa-lg"></i>\n                               \t</a>\n                                  \n                              </div>\n                           </div>\n                        </div>\n                     </div>\n                  </div>\n                  <div class="form-group col-md-offset-1 col-md-10 col-sm-12">\n                  \n                     <div class="well additional-information">\n                        <h3>Transaction Details</h3>\n                        <div class="policy-field-wapper receiptpage transaction-details-paymentpopup">\n                        <div class="payment-scheduled-popupinner" *ngIf="isShowSchedule" (clickOutside)="closePaymentScheduleBox($event)">\n\t\t\t\t\t\t\t\t\t<h5 class="popup-header">Payment Schedule</h5>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div class="popup-content">\n\t\t\t\t\t\t\t\t\t\t<div class="table-responsive">\n\t\t\t\t\t\t\t\t\t\t\t<table class="table table-striped">\n\t\t\t\t\t\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<th>#</th>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<th>Amount</th>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<th>Due Date</th>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>$ {{downPayAmount}}</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>{{ todayDate | date: \'MM/dd/yyyy\' }} (Today)</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr *ngFor="let installment of installmentsAmounts; let index = index">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t <td>{{ index + 1 }}</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>{{installment}}</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>{{installmentDueDates[index] | date: \'MM/dd/yyyy\'}}</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<p *ngIf="downPayAmount && manualReceiptPage.controls[\'transactionType\'].value == 5 && installmentDueDates.length>1">\n\t\t\t\t\t\t\t\t<span (click)="openPaymentSchedules($event)">Policy will be renewed and <a href="javascript:void(0);"><b>click here</b></a> for new installment schedule.</span> \n\t\t\t\t\t\t\t</p>\n                        \n                           <div class="row">\n                           \t  \x3c!-- [isDisabled]="!manualReceiptPage.controls[\'transactionType\'].invalid || !manualReceiptPage.controls[\'transactionType\'].dirty" --\x3e\n                              <div class="form-group col-sm-4 col-xs-7 plr" \n                              \t[ngClass]="{ \'quote-select-has-error\' : (manualReceiptPage.controls[\'transactionType\'].invalid && \n                              \t\tmanualReceiptPage.controls[\'transactionType\'].dirty && manualReceiptPage.controls[\'transactionType\'].value == \'\' ) ||\n                                        \t\tmanualReceiptPage.controls[\'transactionType\'].hasError(\'required\') && manualReceiptPage.controls[\'transactionType\'].touched }"\n                           \t\tcontainerClass="errorTooltip"\n\t\t\t\t\t\t\t\ttooltip="Transaction type is required"\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t[isDisabled]="((manualReceiptPage.controls[\'transactionType\'].dirty && manualReceiptPage.controls[\'transactionType\'].invalid) \n                                        \t\t|| (manualReceiptPage.controls[\'transactionType\'].hasError(\'required\') && manualReceiptPage.controls[\'transactionType\'].touched) ) ? false : true" >\n\t\t\t\t\t\t\t\t\n                                 <label class="control-label">Transaction Type<em>*</em> :</label>\n                                 <select class="selectpicker todisable" formControlName="transactionType" (change)="setValidatorOfTransactionType()" \n                                 \tdata-live-search="true"\n                                 \tdata-dropup-auto="false" \n                                    data-actions-box="true" \n                                 \tdata-selected-text-format="count" \n                                 \tdata-size="5">\n                                 \t\n                                    <option value="">No Transaction</option>\n                                  \t<option *ngFor="let transaction of transactionTypeEnumConstants" \n                                    \t[ngValue]="transaction.value" \n                                    \t[disabled]="((manualReceiptPage.controls[\'product\'].value == 35 || manualReceiptPage.controls[\'product\'].value == 38 || manualReceiptPage.controls[\'product\'].value == 12) && !paymentTransactionAdmin && ((transaction.value == 0 || transaction.value == 1) && (zeroFullPayAmount || downPayAmount))) || (transaction.value == 1 && lateFees && !paymentTransactionAdmin) || (transaction.value == 2 && paymentId && !paymentTransactionAdmin) || \n                                                (transaction.value == 5 && !downPayAmount &&  paymentId && !zeroFullPayAmount && !paymentTransactionAdmin && (isRenewal == \'false\' || isRenewal == false) && ( manualReceiptPage.controls[\'product\'].value == 0 || manualReceiptPage.controls[\'product\'].value == 3 || manualReceiptPage.controls[\'product\'].value == 8 || manualReceiptPage.controls[\'product\'].value == 35  || manualReceiptPage.controls[\'product\'].value == 38 || manualReceiptPage.controls[\'product\'].value == 12) ) ||\n                                                (transaction.value == 5 && !downPayAmount &&  paymentId && !paymentTransactionAdmin && (isRenewal == \'false\' || isRenewal == false) && ( manualReceiptPage.controls[\'product\'].value == 38 )) ||\n                                                (paymentId && !paymentTransactionAdmin && isPolicyIsCancelled && (transaction.value == 0 || transaction.value == 1 || transaction.value == 5)) ||\n                                                (isDisableRenewBtn && (transaction.value == 0 || transaction.value == 1 || transaction.value == 5))">\n                                       {{ TransactionTypeConstant.getTransactionTypeModelByTransacationType(transaction.name).label }}\n                                    </option>\n                                    \n                                 </select>\n                                 \n                                 \x3c!-- <select class="selectpicker" formControlName="transactionType" (change)="setValidatorOfPolicyNumber()" data-live-search="true">\n                                    <option value="">No Transaction</option>\n                                  \t<option *ngFor="let transaction of transactionTypeList" \n                                    \t[ngValue]="transaction.label">\n                                    \t{{ transaction.label }}\n                                    </option>\n                                 </select> --\x3e\n                                 \n                              </div>\n                               \n                              <div class="form-group col-sm-4 col-xs-5 plr" \n                              \t[ngClass]="{ \'quote-select-has-error\' : manualReceiptPage.controls[\'product\'].invalid && \n                              \t\tmanualReceiptPage.controls[\'product\'].dirty && manualReceiptPage.controls[\'product\'].value == \'\'}"\n                              \tcontainerClass="errorTooltip"\n\t\t\t\t\t\t\t\ttooltip="Product is required"\n\t\t\t\t\t\t\t\t[isDisabled]="!manualReceiptPage.controls[\'product\'].invalid || !manualReceiptPage.controls[\'product\'].dirty">\n\t\t\t\t\t\t\t\t\n                                 <label class="control-label">Product<em>*</em> :</label>\n\x3c!--                                  <select class="selectpicker" formControlName="product" (change)="detectProduct()">\n --\x3e                                 \n                                 <select class="selectpicker todisable" id="selectProduct" formControlName="product" (change)="onProductChange()" \n                                 \tdata-live-search="true"\n                                 \tdata-dropup-auto="false" \n                                 \tdata-actions-box="true" \n                                 \tdata-selected-text-format="count"  \n                                    data-size="5"\n                                    [attr.disabled]="(paymentTransactionAdmin) ? \'disabled\' : null">\n                                 \t\n                                 \t<option value="">No Product</option>\n                                \t<option *ngFor="let productEnum of productEnumConstants" \n                                    \t[ngValue]="productEnum.value" >\n                                    \t{{ProductConstant.getProductModelByProduct(productEnum.name).label}}\n                                    </option>\n                                 </select>\n                              </div>\n                              \x3c!-- (blur)="policyNumberExist()" --\x3e\n                              <div *ngIf="manualReceiptPage.controls[\'transactionType\'].value != 2" class="form-group col-sm-4 col-xs-12 plr">\n                                 <label class="control-label">Policy Number<em *ngIf="manualReceiptPage.controls[\'policyNumber\'].validator != null">*</em> :</label> \n                                 <input autocomplete="off" type="text" class="form-control" formControlName="policyNumber" id="policyNumber"\n                                 containerClass="errorTooltip" maxlength="16"  (keypress)="omit_special_char($event)" (keyup)="onPolicyNumberKeyUp($event)" (blur)="onPolicyNumberKeyUp($event)"\n                                 [ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls.policyNumber.invalid && manualReceiptPage.controls.policyNumber.touched }"\n                                 [isDisabled]="!manualReceiptPage.controls[\'policyNumber\'].touched || !manualReceiptPage.controls[\'policyNumber\'].invalid" \n                                 tooltip="{{ manualReceiptPage.controls[\'policyNumber\'].errors?.policyNumberExist ? \'Policy number already exist\' : \'Policy number is required.\' }}"\n                                 required [attr.disabled]="paymentId || isPolicyReadOnly">\n                              </div>\n\n\n                              <div *ngIf="manualReceiptPage.controls[\'transactionType\'].value == 2" class="form-group col-sm-4 col-xs-5 plr" \n                              \t[ngClass]="{ \'quote-select-has-error\' : manualReceiptPage.controls[\'heardAboutUs\'].invalid && \n                                    manualReceiptPage.controls[\'heardAboutUs\'].dirty && manualReceiptPage.controls[\'heardAboutUs\'].value == \'\' ||\n                                    manualReceiptPage.controls[\'heardAboutUs\'].hasError(\'required\') && manualReceiptPage.controls[\'heardAboutUs\'].touched }"\n                              \tcontainerClass="errorTooltip"\n\t\t\t\t\t\t\t         \ttooltip="Heard About Us is required"\n                                 [isDisabled]="((manualReceiptPage.controls[\'heardAboutUs\'].dirty && manualReceiptPage.controls[\'heardAboutUs\'].invalid) ||\n                                  (manualReceiptPage.controls[\'heardAboutUs\'].hasError(\'required\') && manualReceiptPage.controls[\'heardAboutUs\'].touched) ) ? false : true ">\n\t\t\t\t\t\t\t\t\n                                 <label class="control-label">How did you hear about us<em>*</em> :</label>\n\n                                 <select class="selectpicker" id="heardAboutUs" formControlName="heardAboutUs" \n                                 \tdata-live-search="true"\n                                 \tdata-dropup-auto="false" \n                                 \tdata-actions-box="true" \n                                 \tdata-selected-text-format="count"\n                                    data-size="5" >\n                                 <option value="">Select Value</option>\n                                \t<option *ngFor="let heardAboutUsEnum of heardAboutUsEnumConstants" \n                                    \t[ngValue]="heardAboutUsEnum.value" >\n                                    \t{{HeardAboutUsConstant.getHeardAboutUsModelByHeardAboutUs(heardAboutUsEnum.name).label}}\n                                    </option>\n                                 </select>\n                              </div>\n\n                           </div>\n                           \n                           <div *ngIf="showMakePaymentWarning && makePaymentWarning" class="row">\n                           \t\t<div class="col-sm-9 plr">\n                           \t\t\t<div class="alert alert-dismissible fade in alert-danger">\n                           \t\t\t\t<p><i class="icon fa fa-warning" style="font-size: 18px;"></i>&nbsp;&nbsp;{{ makePaymentWarning }}</p>\n\t\t\t\t\t\t\t\t\t</div>\n                           \t\t</div>\n                           </div>\n                           <div class="row">\n                           \n                           <div class="form-group col-sm-3 col-xs-6 plr">\n                                 <label class="control-label">Total Collected ($)<em>*</em> :</label> \n                                 <input autocomplete="off" type="tel" class="form-control" formControlName="amount" id="amount"\n                                 containerClass="errorTooltip" maxlength="15" (keypress)="checkNumberPattern($event)" \n                                 [ngClass]="{ \'quote-has-error\' : (manualReceiptPage.controls.amount.invalid && manualReceiptPage.controls.amount.touched)}"\n                                 [isDisabled]="!manualReceiptPage.controls[\'amount\'].touched || !manualReceiptPage.controls[\'amount\'].invalid" \n                                 tooltip="{{ manualReceiptPage.controls[\'amount\'].errors?.required ? \'Total collected amount is required.\' :\n                                 \tmanualReceiptPage.controls[\'amount\'].errors?.invalidTotalAmount ? \'Total collected amount is incorrect.\' :\n                                 \tmanualReceiptPage.controls[\'amount\'].errors?.min ? \'Total collected amount must be atleast \' + manualReceiptPage.controls[\'amount\'].errors?.min?.min : \n                                 \tmanualReceiptPage.controls[\'amount\'].errors?.max ? \'Total collected amount must be less than \' + manualReceiptPage.controls[\'amount\'].errors?.max?.max :\n                                 \tmanualReceiptPage.controls[\'amount\'].errors?.amountShouldBeGreterThanPremium ? \'Total collected amount should be greater than premium.\' :\n                                    manualReceiptPage.controls[\'amount\'].errors | json }}"\n                                 required\n                                 (blur)="checkTotalAmountAndPremiumAmount()">\n                              </div>\n                           \n                           \n                              <div class="form-group col-sm-3 col-xs-6 plr">\n                                 <label class="control-label">Premium Amount ($)<em>*</em> :</label> \n                                 <input autocomplete="off" type="tel" class="form-control" formControlName="premiumAmount" id="premiumAmount"\n                                 containerClass="errorTooltip" maxlength="15" (keypress)="checkNumberPattern($event)" \n                                 [ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls.premiumAmount.invalid && manualReceiptPage.controls.premiumAmount.touched }"\n                                 [isDisabled]="!manualReceiptPage.controls[\'premiumAmount\'].touched || !manualReceiptPage.controls[\'premiumAmount\'].invalid" \n                                 tooltip="{{ manualReceiptPage.controls[\'premiumAmount\'].errors?.required ? \'Premium amount is required.\' :\n                                 \tmanualReceiptPage.controls[\'premiumAmount\'].errors?.invalidTotalAmount ? \'Premium amount is incorrect.\' :\n                                 \tmanualReceiptPage.controls[\'premiumAmount\'].errors?.min ? \'Premium amount must be greater than or equal to \' + manualReceiptPage.controls[\'premiumAmount\'].errors?.min?.min : \n                                 \tmanualReceiptPage.controls[\'premiumAmount\'].errors?.max ? \'Premium amount must be less than or equal to \' + manualReceiptPage.controls[\'premiumAmount\'].errors?.max?.max :\n                                 \tmanualReceiptPage.controls[\'premiumAmount\'].errors | json }}"\n                                 required (blur)="checkTotalAmountAndPremiumAmount()" >\n                                 \x3c!-- removed [readonly]="isPremiumAmountReadOnly" --\x3e\n                              </div>\n\n                              <div *ngIf="manualReceiptPage.controls[\'transactionType\'].value == 2" class="form-group col-sm-3 col-xs-6 plr" \n                                 [ngClass]="{ \'quote-select-has-error\' : manualReceiptPage.controls[\'quotedBy\'].invalid && \n                                 manualReceiptPage.controls[\'quotedBy\'].dirty && manualReceiptPage.controls[\'quotedBy\'].value == \'\' ||\n                                 manualReceiptPage.controls[\'quotedBy\'].hasError(\'required\') && manualReceiptPage.controls[\'quotedBy\'].touched }"\n                                    containerClass="errorTooltip"\n                                 tooltip="Quoted By is required"\n                                 [isDisabled]="((manualReceiptPage.controls[\'quotedBy\'].dirty && manualReceiptPage.controls[\'quotedBy\'].invalid) ||\n                                 (manualReceiptPage.controls[\'quotedBy\'].hasError(\'required\') && manualReceiptPage.controls[\'quotedBy\'].touched) ) ? false : true ">\n                  \n                                 <label class="control-label">Quoted By<em>*</em> :</label>\n\x3c!--                                  <select class="selectpicker" formControlName="product" (change)="detectProduct()">\n --\x3e                                 \n                                 <select class="selectpicker" id="quotedBy" formControlName="quotedBy"  (change) = "quotedByChange(agent)"\n                                 \tdata-live-search="true"\n                                 \tdata-dropup-auto="false" \n                                 \tdata-actions-box="true" \n                                 \tdata-selected-text-format="count"  \n                                    data-size="5"\n                                    >\n                                 \t<option value="">Select Agent</option>\n                                    <option *ngFor="let agent of agents"\n                                       [ngValue]="agent.id">\n                                       {{agent.name}}\n                                    </option>\n                                 </select>\n                              </div>\n                              \n                              \x3c!-- <div *ngIf="showMakePaymentWarning" class="form-group col-sm-4 col-xs-12 plr">\n                              \t {{ makePaymentWarning }}\n                              </div> --\x3e\n                              \n                           </div>\n                           <div *ngIf="showPaymentTransactionFeesWarning && paymentTransactionFeesWarningAmount" class="row">\n                              <div class="col-sm-9 plr">\n                                 <div class="alert alert-dismissible fade in alert-info">\n                                    <p><i class="icon fa fa-warning" style="font-size: 18px;"></i>&nbsp;&nbsp;{{ paymentTransactionFeesWarningAmount }}</p>\n                                 </div>\n                              </div>\n                           </div>\n                           <div class="row">\n                                 <div *ngIf="isEditable || paymentTransactionAdmin" class="form-group col-sm-3 col-xs-6 plr">\n                                       <label class="control-label">Agent<em>*</em> :</label>\n                                       <div [ngClass]="{ \'quote-select-has-error\' : (manualReceiptPage.controls[\'agent\'].invalid && \n                                       manualReceiptPage.controls[\'agent\'].dirty && manualReceiptPage.controls[\'agent\'].value == \'\') ||\n                                       manualReceiptPage.controls[\'agent\'].hasError(\'required\') && manualReceiptPage.controls[\'agent\'].touched }" \n                                                 containerClass="errorTooltip"\n                                                 [isDisabled]="( (manualReceiptPage.controls[\'agent\'].dirty && manualReceiptPage.controls[\'agent\'].invalid) \n                                                 || (manualReceiptPage.controls[\'agent\'].hasError(\'required\') && manualReceiptPage.controls[\'agent\'].touched) ) ? false : true"\n                                                 tooltip="Agent is required">\n                                          <select class="selectpicker" id="selectAgent"\n                                             formControlName="agent" data-live-search="true"\n                                             data-dropup-auto="false" data-actions-box="true"\n                                             data-selected-text-format="count" data-size="5"\n                                             (change)="setValidatorsOnAgent()"\n                                             containerClass="errorTooltip">\n      \n                                             <option value="">Select Agent</option>\n                                             <option *ngFor="let agent of agents"\n                                                [ngValue]="agent.id">\n                                                {{agent.name}}\n                                             </option>\n                                          </select>\n                                       </div>\n                                    </div>\n      \n                                    <div *ngIf="isEditable || paymentTransactionAdmin" class="form-group col-sm-3 col-xs-6 plr">\n                                       <label class="control-label">Office<em>*</em> :</label>\n                                       <div [ngClass]="{ \'quote-select-has-error\' : (manualReceiptPage.controls[\'office\'].invalid && \n                                       manualReceiptPage.controls[\'office\'].dirty && manualReceiptPage.controls[\'office\'].value == \'\') ||\n                                       manualReceiptPage.controls[\'office\'].hasError(\'required\') && manualReceiptPage.controls[\'office\'].touched }" \n                                                 containerClass="errorTooltip"\n                                                 [isDisabled]="( (manualReceiptPage.controls[\'office\'].dirty && manualReceiptPage.controls[\'office\'].invalid) \n                                                 || (manualReceiptPage.controls[\'office\'].hasError(\'required\') && manualReceiptPage.controls[\'office\'].touched) ) ? false : true"\n                                                 tooltip="Office is required">\n                                          <select class="selectpicker" id="selectOffice"\n                                             formControlName="office" data-live-search="true"\n                                             data-dropup-auto="false" data-actions-box="true"\n                                             data-selected-text-format="count" data-size="5"\n                                             (change)="setValidatorsOnOffice()"\n                                             containerClass="errorTooltip">\n      \n                                             <option value="">Select Office</option>\n                                             <option *ngFor="let office of offices"\n                                                [ngValue]="office.decryptedId">\n                                                {{office.name}}\n                                             </option>\n                                          </select>\n                                       </div>\n                                    </div>\n                              <div *ngIf="isEditable || paymentTransactionAdmin" class="form-group col-sm-4 col-xs-6 plr effective-date">\n                                 <label class="control-label">Transaction Created Date<em>*</em> :</label>\n                                    <input type="text" class="form-control" [ngClass]="{ \'quote-has-error\': manualReceiptPage.controls[\'updatedCreatedDateTime\'].invalid && manualReceiptPage.controls[\'updatedCreatedDateTime\'].touched}" \n                                    formControlName="updatedCreatedDateTime" autocomplete="off"\n                                    [isDisabled]="!manualReceiptPage.controls[\'updatedCreatedDateTime\'].touched || \n                                                          !manualReceiptPage.controls[\'updatedCreatedDateTime\'].invalid"\n                                containerClass="errorTooltip" [textMask]="{mask: dateOfBirthMask}"\n                                tooltip="{{ (manualReceiptPage.controls.updatedCreatedDateTime.errors ? (manualReceiptPage.controls.updatedCreatedDateTime.errors.required ? \'Date is required.\' : \n                                (manualReceiptPage.controls.updatedCreatedDateTime.errors.dateIsNotValid ? manualReceiptPage.controls.updatedCreatedDateTime.errors.dateIsNotValid : \n                                (manualReceiptPage.controls.updatedCreatedDateTime.errors.dateIsGreaterThanToday ? manualReceiptPage.controls.updatedCreatedDateTime.errors.dateIsGreaterThanToday : \'\')) ) : \'Valid\') }}" \n                                 placeholder="mm/dd/yyyy" id="updatedCreatedDateTime">\n                                     \x3c!-- [textMask]="{mask: dateOfBirthMask}" --\x3e\n                                    <i class="fa fa-calendar-o fa-lg" id="transactionDateCalender"></i>\n                              </div>\n                           </div>\n                        </div>\n                     </div>\n                  </div>\n                  <div class="form-group col-md-offset-1 col-md-10 col-sm-12" id= "paymentVia">\n                     <div class="well additional-information policy-card-details payment-card">\n                        <h3>Payment Method</h3>\n\n                        <div *ngIf="customerAvailabilityErrorMessage" class="" style="padding: 10px 0 0">\n                           <div class="col-sm-12">\n                              <div class="alert alert-dismissible fade in alert-danger" style="margin-bottom: 0;">\n                                 <a href="javascript:void(0);" class="close" aria-label="close" (click)="customerAvailabilityErrorMessage = undefined">\xd7</a>\n                                 <p>Select atleast one Option</p>\n                              </div>\n                           </div>\n                        </div>\n                        \n                        <div class="form-group col-sm-12 quote-radio-main" style="\n                           padding: 10px 20px 0px;\n                           margin: auto">\n                           <label class="control-label">Customer Availability <em>*</em> :</label>\n                           <div class="radio">\n                              <input class="magic-radio" type="radio" id="call" [value]="customerAvailabilityEnumConstants[0].value" formControlName="customerAvailability" required>\n                              <label for="call">{{CustomerAvailabilityConstant.getCustomerAvailabilityModelByCustomerAvailability(customerAvailabilityEnumConstants[0].name).label}}</label>\n                           </div>\n                           <div class="radio">\n                              <input  class="magic-radio" type="radio" id="inPerson" [value]="customerAvailabilityEnumConstants[1].value" formControlName="customerAvailability" required>\n                              <label for="inPerson">{{CustomerAvailabilityConstant.getCustomerAvailabilityModelByCustomerAvailability(customerAvailabilityEnumConstants[1].name).label}}</label>\n                           </div>\n                           <div *ngIf="isEditable || paymentTransactionAdmin" class="radio">\n                              <input  class="magic-radio" type="radio" id="online" [value]="customerAvailabilityEnumConstants[2].value" formControlName="customerAvailability" required>\n                              <label for="online">{{CustomerAvailabilityConstant.getCustomerAvailabilityModelByCustomerAvailability(customerAvailabilityEnumConstants[2].name).label}}</label>\n                           </div>\n                        </div>\n\n                        <div *ngIf="paymentErrorMessage" class="" style="padding: 10px 0 0">\n                           <div class="col-sm-12">\n                              <div class="alert alert-dismissible fade in alert-danger" style="margin-bottom: 0;">\n                                 <a href="javascript:void(0);" class="close" aria-label="close" (click)="paymentErrorMessage = undefined">\xd7</a>\n                                 <p>Select atleast one payment method</p>\n                              </div>\n                           </div>\n                        </div>\n                        \n\n                        <div class="policy-field-wapper receiptpage">\n                           <ul class="pay-method-chec-radio list-inline">\n                              <li class="pay-method-inner">\n                                 <label class="checkbox-inline">\n                                    <input type="checkbox" name="payment" id="card" class="selectAllWhenFilter1" (change)="onPaymentByChange(1)" formControlName="card" [attr.checked]="checkCard">\n                                    <div class="pay-method-name"><img src="../assets/images/creadit-card.png" /> Credit/Debit Card</div>\n                                 </label>\n                              </li>\n                              <li class="pay-method-inner">\n                                 <label class="checkbox-inline">\n                                    <input type="checkbox" name="payment"  id="cash"  class="selectAllWhenFilter2" (change) = "onPaymentByChange(2)" formControlName="cash" >\n                                    <div class="pay-method-name"><img src="../assets/images/cash.png" />Cash</div>\n                                 </label>\n                              </li>\n                              <li class="pay-method-inner">\n                                 <label class="checkbox-inline">\n                                    <input type="checkbox" name="payment"  id="moneyOrder" class="selectAllWhenFilter3" (change) = "onPaymentByChange(3)" formControlName="moneyOrder" >\n                                    <div class="pay-method-name"><img src="../assets/images/money-order.png" />Money Order</div>\n                                 </label>\n                              </li>\n                           </ul>\n                        </div>\n                        <div class="policy-field-wapper receiptpage pay-method-chec-content">\n                           <div class="">\n                              <div class="row" *ngIf="cashDetails">\n                                 <div class="form-group cardno">\n\t\t\t\t\t\t\t\t\t<label class="control-label col-sm-2 plr">Cash Amount ($)<em>*</em> :</label>\n                                    <div class="col-sm-6 plr">\n                                       <input autocomplete="off" type="tel" class="form-control " formControlName="cashAmount" id="cashAmount"\n                                       [ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls.cashAmount.invalid && manualReceiptPage.controls.cashAmount.touched }"\n                                       containerClass="errorTooltip" maxlength="15" placeholder="Enter cash amount collected" (keypress)="checkNumberPattern($event)" \n                                       [isDisabled]="!manualReceiptPage.controls[\'cashAmount\'].touched || !manualReceiptPage.controls[\'cashAmount\'].invalid" \n                                       tooltip="{{ manualReceiptPage.controls[\'cashAmount\'].errors ?\n                                       \t\t(manualReceiptPage.controls[\'cashAmount\'].errors?.required ? \'Cash Amount is required.\' : \n\t\t                                 \tmanualReceiptPage.controls[\'cashAmount\'].errors?.min ? \'Cash amount must be greater than \' + manualReceiptPage.controls[\'cashAmount\'].errors?.min?.min : \n\t\t                                 \tmanualReceiptPage.controls[\'cashAmount\'].errors?.max ? \'Cash amount must be less than \' + manualReceiptPage.controls[\'cashAmount\'].errors?.max?.max :\n                                       \t\tmanualReceiptPage.controls[\'cashAmount\'].errors?.invalidAmount ? manualReceiptPage.controls[\'cashAmount\'].errors?.invalidAmount : \n                                       \t\t\'Invalid Amount\' ) : \'Invalid Amount\' }}"\n                                       required (change)="calculateTotalAmount()" (blur)="editCashAmountBlur()">\n                                    </div>\n                                 </div>\n                              </div>\n                              <div class="row" *ngIf="moneyOrder">\n                                 <div class="form-group cardno">\n                                    <label class="control-label col-sm-2 plr">MO Amount ($)<em>*</em> :</label>\n                                    <div class="col-sm-6 plr">\n                                       <input autocomplete="off" type="tel" step="0.01" class="form-control " formControlName="moneyOrderAmount" id="moneyOrderAmount" \n                                       [ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls.moneyOrderAmount.invalid && manualReceiptPage.controls.moneyOrderAmount.touched }"\n                                       containerClass="errorTooltip" maxlength="15" (keypress)="checkNumberPattern($event)" placeholder="Enter MO amount collected" \n                                       [isDisabled]="!manualReceiptPage.controls[\'moneyOrderAmount\'].touched || !manualReceiptPage.controls[\'moneyOrderAmount\'].invalid" \n                                       tooltip="{{ manualReceiptPage.controls[\'moneyOrderAmount\'].errors ?\n                                       \t\t(manualReceiptPage.controls[\'moneyOrderAmount\'].errors?.required ? \'Money order Amount is required.\' : \n\t\t                                 \tmanualReceiptPage.controls[\'moneyOrderAmount\'].errors?.min ? \'Money order amount must be greater than \' + manualReceiptPage.controls[\'moneyOrderAmount\'].errors?.min?.min : \n\t\t                                 \tmanualReceiptPage.controls[\'moneyOrderAmount\'].errors?.max ? \'Money order amount must be less than \' + manualReceiptPage.controls[\'moneyOrderAmount\'].errors?.max?.max :\n                                       \t\tmanualReceiptPage.controls[\'moneyOrderAmount\'].errors?.invalidAmount ? manualReceiptPage.controls[\'moneyOrderAmount\'].errors?.invalidAmount : \n                                       \t\t\'Invalid Amount\' ) : \'Invalid Amount\' }}"\n                                       required (change)="calculateTotalAmount()" (blur)="editMoneyOrderAmountBlur()">\n                                    </div>\n                                 </div>\n                              </div>\n                              <div class="row" *ngIf="moneyOrder && cashDetails">\n                                 <div class="form-group cardno">\n                                    <label class="control-label col-sm-2 plr">Total Amount ($) :\n                                    </label>\n                                    <div class="col-sm-6 plr">\n                                      <label class="control-label">$ {{ totalAmount | number:\'1.2-2\' }}</label>\n                                    </div>\n                                 </div>\n                              </div>\n                              <div class="row" *ngIf="moneyOrder">\n                                 <div class="form-group cardno">\n                                    <label class="control-label col-sm-2 plr">MO Receipt<em *ngIf="!isEditable && !paymentTransactionAdmin">*</em> :\n                                    </label>\n                                    <div class="col-sm-6 plr">\n                                       \x3c!-- <input type="file" id="upload" (change)="fileOnchangeEvent($event)" id="fileUpload"\n                                          formControlName = "moneyOrderUpload" accept="application/pdf"/> --\x3e\n                                          \n\t\t\t                   \t\t<div class="upload-more-outer" *ngIf="file == undefined || file == null">\n\t\t                   \t\t\t\t<ul class="list-inline">\n\n\t\t\t                   \t\t\t\t<li class="carimg muploadimg mrimg muploadbtn"\n\t\t\t                   \t\t\t\t\t[ngClass]="{ \'quote-has-error\' : manualReceiptPage[\'controls\'][\'moneyOrderUpload\'].invalid && manualReceiptPage[\'controls\'][\'moneyOrderUpload\'].touched }"\n                                       \t\t\tcontainerClass="errorTooltip" \n                                       \t\t\t[isDisabled]="!manualReceiptPage.controls[\'moneyOrderUpload\'].touched || !manualReceiptPage.controls[\'moneyOrderUpload\'].invalid" \n                                       \t\t\ttooltip="{{ manualReceiptPage.controls[\'moneyOrderUpload\'].errors?.required ? \'Money order receipt is required.\' : \'\' }}">\n\t\t\t                   \t\t\t\t\t\n\t\t\t                   \t\t\t\t\t\x3c!-- <a href="javascript:void(0);"> <img src="../../../../../../assets/images/PolicyBindImages/UploadDocumentImages/del-document.png" class="del-document" (click)="removeFile(\'FULL_COVERAGE\', 0, indexOfFullCoverageVehicle);"/> </a> --\x3e\n\t\t\t                   \t\t\t\t\t<label style="cursor: pointer;">\n\t\t\t\t\t\t\t\t\t\t\t\t    \x3c!-- <img id="imgMoneyOrderReceipt" src="../../../../../../assets/images/PolicyBindImages/UploadDocumentImages/upload_more.jpg" /> --\x3e\n\t\t\t\t\t\t\t\t\t\t\t\t    \x3c!-- <img [attr.id]="\'carimgs_\' + indexOfFullCoverageVehicle + \'_\' + 0" [src]="( testImage | image ) | async"/> --\x3e\n\t\t\t\t\t\t\t\t\t\t\t\t    \x3c!-- <img title="{{ file?.name }}" src="../../../../../../assets/images/manual-receipt/manual-receipt-upload.png" /> --\x3e\n\t\t\t\t\t\t\t\t\t\t\t\t    Click Here to Upload\n\t\t\t\t\t\t\t\t\t\t\t\t    <input style="opacity: 0; margin: 5px;" id="moneyOrderReceiptDocument" \n\t\t\t\t\t\t\t\t\t\t\t\t    \tclass=\'pis\' (change)="fileOnchangeEvent($event)" \n\t\t\t\t\t\t\t\t\t\t\t\t    \tformControlName="moneyOrderUpload" type="file">\n\t\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t                   \t\t\t\t</li>\n\t\t\t                   \t\t\t\t</ul>\n\t\t                   \t\t\t\t</div>\t\t                   \n\t\t                   \t\t\t\t\n\t\t                   \t\t\t\t<div class="upload-more-outer muploadtext" *ngIf="file">\n\t\t                   \t\t\t\t\t<a href="javascript:void(0);">\n\t\t                   \t\t\t\t\t\t<img src="../../../../../../assets/images/PolicyBindImages/UploadDocumentImages/del-document.png" class="del-document" (click)="removeFile();"/>\n\t\t                   \t\t\t\t\t</a>\n\t\t                   \t\t\t\t\t<h6>{{ file?.name}}</h6>\n\t\t                   \t\t\t\t\t\n\t\t                   \t\t\t\t</div>\n\t\t\t                   \n                                    </div>\n                                 </div>\n                              </div>\n                              <div class="row" *ngIf="moFile && isEditable && moneyOrder">\n                                 <label class="control-label col-sm-2 plr">Last MO Receipt :\n                                 </label>\n                                 <div class="col-sm-6 plr">\n                                    <div class="upload-more-outer">\n                                       <h6>{{ moFile }}</h6>\n                                    </div>\n                                    </div>\n                              </div>\n                              <div class="row" *ngIf="cardDetails">\n                                 <div class="form-group cardno">\n                                    <label class="control-label col-sm-2 col-sm-3 plr">Card Amount ($)<em>*</em> :</label>\n                                    <div class="col-sm-6 plr">\n                                       <input autocomplete="off" type="tel" step="0.01" class="form-control " formControlName="cardAmount" id="cardAmount" \n                                       [ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls.cardAmount.invalid && manualReceiptPage.controls.cardAmount.touched }"\n                                       containerClass="errorTooltip" maxlength="15" (keypress)="checkNumberPattern($event)" placeholder="Enter Card amount collected" \n                                       [isDisabled]="!manualReceiptPage.controls[\'cardAmount\'].touched || !manualReceiptPage.controls[\'cardAmount\'].invalid" \n                                       tooltip="{{ manualReceiptPage.controls[\'cardAmount\'].errors ?\n                                       \t\t(manualReceiptPage.controls[\'cardAmount\'].errors?.required ? \'Card Amount is required.\' : \n\t\t                                 \tmanualReceiptPage.controls[\'cardAmount\'].errors?.min ? \'Card amount must be greater than \' + manualReceiptPage.controls[\'cardAmount\'].errors?.min?.min : \n\t\t                                 \tmanualReceiptPage.controls[\'cardAmount\'].errors?.max ? \'Card amount must be less than \' + manualReceiptPage.controls[\'cardAmount\'].errors?.max?.max :\n                                       \t\tmanualReceiptPage.controls[\'cardAmount\'].errors?.invalidAmount ? manualReceiptPage.controls[\'cardAmount\'].errors?.invalidAmount : \n                                       \t\t\'Invalid Amount\' ) : \'Invalid Amount\' }}"\n                                       required (change)="calculateTotalAmount()" (blur)="editCardAmountBlur()">\n                                    </div>\n                                 </div>\n                              </div>\n                              <div class="row" *ngIf="cardDetails && !isNewOffice">\n                                 <div class="form-group nameoncard">\n                                    <label class="control-label col-sm-2 col-sm-3 plr">Name on Card<em>*</em> :</label>\n                                    <div class="col-sm-6 plr">\n                                       <input autocomplete="off" #nameOnCard type="text" class="form-control " formControlName="cardHolderName" id="nameOnCard"\n                                       [ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls.cardHolderName.invalid && manualReceiptPage.controls.cardHolderName.touched }"\n                                       containerClass="errorTooltip" maxlength="30" placeholder="Name holder"\n                                       [isDisabled]="!manualReceiptPage.controls[\'cardHolderName\'].touched || !manualReceiptPage.controls[\'cardHolderName\'].invalid" \n                                       tooltip="{{ manualReceiptPage.controls[\'cardHolderName\'].errors?.required ? \'Name on card is required.\' : \n                                       (manualReceiptPage.controls[\'cardHolderName\'].errors?.pattern ? \'Only characters are allowed.\' : \'Valid name on card\') }}"\n                                       required>\n                                    </div>\n                                 </div>\n                              </div>\n                              <div class="row" *ngIf="cardDetails && !isNewOffice">\n                                 <div class="form-group cardno">\n                                    <label class="control-label col-sm-2 col-sm-3 plr">Card Number<em>*</em> :</label>\n                                    <div class="col-sm-6 plr">\n                                    \t<div [hidden]="isShowCardNumber">\n                                       <input autocomplete="off" class="form-control" id="card-number" type="tel"\n                                       name="" placeholder="Enter card number"\n                                       formControlName="cardNumber" specialCharacters="[ \'-\' ]" mask="0000-0000-0000-0000"  minlength="16"\n                                       (keypress)="checkCardNumber($event)"\n                                       (keyup)="onCardNumberEnter($event)"\n                                       (blur)="onCardNumberBlur()"\n                                       [ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls.cardNumber.invalid && manualReceiptPage.controls.cardNumber.touched}"\n                                       containerClass="errorTooltip" maxlength="30"\n                                       [isDisabled]="!manualReceiptPage.controls[\'cardNumber\'].touched || !manualReceiptPage.controls[\'cardNumber\'].invalid"\n                                       tooltip="{{ manualReceiptPage.controls[\'cardNumber\'].errors?.required ? \'Card number is required.\' : \n                                       \t\tmanualReceiptPage.controls[\'cardNumber\'].errors?.pattern ? \'Only numerics are allowed.\' :\n                                       \t\tmanualReceiptPage.controls[\'cardNumber\'].errors?.minlength ? \'Minimum 16 characters are required\' : \n                                       \t\tmanualReceiptPage.controls[\'cardNumber\'].errors?.invalidCardType ? \'Only VISA, MASTER or DISCOVER cards are allowed.\' :\n                                       \t\tmanualReceiptPage.controls[\'cardNumber\'].errors?.invalidCardTypeDiscover ? (ProductConstant.getProductModelByProduct(productEnumConstants[this.manualReceiptPage.controls[\'product\'].value].name).label + \' does not support discover card for this type of transaction.\') : \'\' }}"\n                                       required /></div>\n                                       <h5 [hidden]="!isShowCardNumber" (click)="editCardNumber()" style="cursor: pointer;">\n                                       {{ cardXMask }}\n                                       </h5>\n                                       <img *ngIf="selectedCardString" src="{{ selectedCardString }}" class="card-icon" />\n                                    </div>\n                                 </div>\n                              </div>\n                              <div class="row" *ngIf="cardDetails && !isNewOffice">\n                                 <div class="form-group notification-method experiation">\n                                    <label class="control-label col-sm-2 col-sm-3 plr">Expiration<em>*</em> :</label>\n                                    <div class="col-sm-8">\n                                       <div class="row">\n                                       \n                                          <div class="col-xs-6 col-sm-5 col-md-3 plr"\n                                             [ngClass]="{ \'quote-select-has-error\' : manualReceiptPage.controls[\'expiryMonth\'].invalid && \n                                             manualReceiptPage.controls[\'expiryMonth\'].dirty && manualReceiptPage.controls[\'expiryMonth\'].value == \'\'}"\n                                             containerClass="errorTooltip"\n                                             tooltip="Expiry month is required"\n                                             [isDisabled]="!manualReceiptPage.controls[\'expiryMonth\'].dirty || !manualReceiptPage.controls[\'expiryMonth\'].invalid">\n                                             \n                                             <select class="selectpicker" formControlName="expiryMonth" [attr.data-size]="10" (change)="validateCardExpiry($event)">\n                                                <option value="">mm</option>\n                                                <option *ngFor="let cardMonth of cardMonths"\n                                                [ngValue]="cardMonth.value">{{ cardMonth.value }}</option>\n                                             </select>\n                                          </div>\n                                          \n                                          <div class="col-xs-6 col-sm-5 col-md-3 plr"\n                                             [ngClass]="{ \'quote-select-has-error\' : manualReceiptPage.controls[\'expiryYear\'].invalid && \n                                             manualReceiptPage.controls[\'expiryYear\'].dirty && manualReceiptPage.controls[\'expiryYear\'].value == \'\'}"\n                                             containerClass="errorTooltip"\n                                             tooltip="Expiry year is required"\n                                             [isDisabled]="!manualReceiptPage.controls[\'expiryYear\'].dirty || !manualReceiptPage.controls[\'expiryYear\'].invalid">\n                                             \n                                             <select class="selectpicker" formControlName="expiryYear"\n                                                [attr.data-size]="10" (change)="validateCardExpiry($event)">\n                                                <option value="">yyyy</option>\n                                                <option *ngFor="let cardYear of cardYears" [ngValue]="cardYear.value">{{ cardYear.value }}</option>\n                                                \n                                             </select>\n                                             \n                                          </div>\n                                          <div class="col-xs-12 col-sm-6 col-md-4 plr">\n                                             <div *ngIf="isShowCardCvvInfo" (clickOutside)="closeShowCardCvvInfo($event)">\n                                             <div class="payment-scheduled-popupinner">\n                                                <div class="popup-content text-center">\n                                                   <div class="table-responsive">\n                                                      <table class="table">\n                                                         <tbody>\n                                                            <tr>\n                                                               <td><img src="../assets/images/cvv.png" height="50"></td>\n                                                            </tr>\n                                                            <tr>\n                                                               <td>\n                                                                  <h6>Last 3 digits on<br/>back of card</h6>\n                                                               </td>\n                                                            </tr>\n                                                         </tbody>\n                                                      </table>\n                                                   </div>\n                                                </div>\n                                             </div>\n                                          </div>\n                                          <input autocomplete="off" class="form-control" type="password" name=""\n\t                                          placeholder="Security Code" formControlName="cvv"\n                                             [ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls.cvv.invalid && manualReceiptPage.controls.cvv.touched && !isEditable}"\n\t                                          containerClass="errorTooltip" maxlength="4"\n\t                                          (keypress)="checkCardNumber($event)"\n\t                                          [isDisabled]="!manualReceiptPage.controls[\'cvv\'].touched || !manualReceiptPage.controls[\'cvv\'].invalid"\n\t                                          tooltip="{{ !isEditable && manualReceiptPage.controls[\'cvv\'].errors?.required ? \'Security Code is required.\' : \n\t                                          (!isEditable && manualReceiptPage.controls[\'cvv\'].errors?.pattern ? \'Only numerics are allowed.\' : \'\' ) }}"/> \n                                          \n                                          \t<a containerclass="infoTooltip" (click)="openShowCardCvvInfo($event)" \n                                          \t\thref="javascript:void(0);" placement="left">\n\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-question fa-lg"></i>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n                                       </div>\n                                    </div>\n                                 </div>\n                              </div>\n                              <div *ngIf="isShowExpiredCardMsg" class="form-group notification-method experiation">\n                                    <label class="control-label col-sm-2 col-sm-3 plr"></label>\n                                    <div class="col-sm-8">\n                                    \t<div class="row">\n                                    \t\t<h5 style="margin-top: 0px !important; margin-bottom: 0px !important;">{{ cardExpiryMsg }}</h5>\n                                    \t</div>\n                                    </div>\n                              </div>\n                           </div>\n                           <div class="row" *ngIf="cardDetails && !isNewOffice">\n                              <div class="col-sm-6 plr col-xs-8">\n                                 <div class="form-group ">\n                                    <label class="control-label">Billing Address<em>*</em> :</label> \n                                    \n                                 <input autocomplete="off" type="text" class="form-control" formControlName="address" (blur)="verifyAddress()"\n\t\t\t\t                \tcontainerClass="errorTooltip" \n\t\t\t\t                \ttooltip="{{ (manualReceiptPage.controls[\'address\'].hasError(\'required\') ? \'Address is required.\' : (manualReceiptPage.controls[\'address\'].hasError(\'invalidAddress\') ? \'Invalid address\' : \'\') ) }}" \n\t\t\t\t                \t[isDisabled]="!manualReceiptPage.controls[\'address\'].touched || !manualReceiptPage.controls[\'address\'].invalid"\n\t\t\t\t                \t[ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls[\'address\'].invalid && manualReceiptPage.controls[\'address\'].touched}"/>\n                               \n                                 \n                                 \n                                 </div>\n                              </div>\n                              <div class="col-sm-3 plr col-xs-4" *ngIf="cardDetails">\n                                 <div class="form-group">\n                                    <label class="control-label">Apt./Unit # :</label> \n                                    <input autocomplete="off" type="text" class="form-control" formControlName="aprtUntNumber" (blur) ="checkZipCodeIsValidOrNot(); focusOnZip()" />\n                                 </div>\n                              </div>\n                           </div>\n                           <div class="row" *ngIf="cardDetails && !isNewOffice">\n                              <div class="col-sm-3 plr col-xs-5">\n                                 <div class="form-group ">\n                                    <label class="control-label">City<em>*</em> :</label> \n                                    <input autocomplete="off" type="text" class="form-control" \n                                    [ngClass]="{ \'quote-has-error\': manualReceiptPage.controls[\'city\'].hasError(\'required\') && manualReceiptPage.controls[\'city\'].touched}" \n                                    (blur)="checkZipCodeIsValidOrNot()" \n                                    formControlName="city" \n                                    containerClass="errorTooltip" \n                                    tooltip="City is required" \n                                    [isDisabled]="!manualReceiptPage.controls[\'city\'].touched || !manualReceiptPage.controls[\'city\'].invalid"/>\n                                 </div>\n                              </div>\n                              <div class="col-sm-3 plr col-xs-4">\n                                 <div class="form-group">\n                                    <label class="control-label">State<em>*</em> :</label> \n                                    <select class="selectpicker" [attr.id]="\'customerState\'" (change)="checkZipCodeIsValidOrNot()" formControlName="stateId" required>\n                                    <option *ngFor="let state of states" [value]="state.encryptedId">{{state.name}}</option>\n                                    </select>\n                                 </div>\n                              </div>\n                              <div class="col-sm-3 plr col-xs-3">\n                                 <div class="form-group">\n                                    <label class="control-label">Zipcode<em>*</em> :</label> \n                                    <input autocomplete="off" id= "zipcode" type="tel" class="form-control" maxlength="5" \n                                    [ngClass]="{ \'quote-has-error\': ((manualReceiptPage.controls[\'zipcode\'].hasError(\'required\') || \n                                    manualReceiptPage.controls[\'zipcode\'].hasError(\'invalidZipCode\') || \n                                    manualReceiptPage.controls[\'zipcode\'].hasError(\'invalidState\')) && \n                                    manualReceiptPage.controls[\'zipcode\'].touched) ||\n                                    manualReceiptPage.controls[\'zipcode\'].hasError(\'anotherZipcode\')}" \n                                    containerClass="errorTooltip" \n                                    tooltip="{{ (manualReceiptPage.controls[\'zipcode\'].hasError(\'required\') ? \'Zip code is required\' : \n                                    (manualReceiptPage.controls[\'zipcode\'].hasError(\'invalidZipCode\') ? \'Invalid zip code\' : \n                                    (manualReceiptPage.controls[\'zipcode\'].hasError(\'anotherZipcode\') ? errorMessage : \n                                    (manualReceiptPage.controls[\'zipcode\'].hasError(\'invalidState\') ? \'Please enter Texas Zipcode\' : \'Valid zip code\'))))}}" \n                                    [isDisabled]=" !manualReceiptPage.controls[\'zipcode\'].invalid || !manualReceiptPage.controls[\'zipcode\'].touched" formControlName="zipcode" (keyup)="checkZipCodeIsValidOrNot()"/>\n                                 </div>\n                              </div>\n                           </div>\n                        </div>\n                     </div>\n                  </div>\n               </div>\n               <div class="form-group col-md-offset-1 col-md-10 col-sm-12">\n                  <div class="well additional-information">\n                     <h3>Agent Notes<em>*</em></h3>\n                     <div class="policy-field-wapper receiptpage">\n                        <div class="row">\n                           <div class="form-group col-sm-12 col-xs-12 plr">\n                              <textarea class="form-control" rows="" cols="" style=" font-size:15px; border-color: #a4a4a4;\n                              box-shadow: none; resize: none; height: 73px;" formControlName="agentNotes" id="agentNotes"\n                              containerClass="errorTooltip" maxlength="200" \n                              [ngClass]="{ \'quote-has-error\' : manualReceiptPage.controls.agentNotes.invalid && manualReceiptPage.controls.agentNotes.touched }"\n                              [isDisabled]="!manualReceiptPage.controls[\'agentNotes\'].touched || !manualReceiptPage.controls[\'agentNotes\'].invalid" \n                              tooltip="{{ manualReceiptPage.controls[\'agentNotes\'].errors?.required ? \'Agent Notes is required.\' : \'\' }}"\n                              required>\n                              </textarea>\n                           </div>\n                        </div>\n                     </div>\n                  </div>\n               </div>\n            </div>\n            <div class="col-xs-12">\n\t            <div class="text-center quote-btns">\n\t               <button *ngIf = "!isEditable && !this.paymentTransactionAdmin" type="button" id="btnManualReceiptSubmit" class="btn btn-orange tab-btn1" (click)="submitReceiptForm()" >\n                  Submit</button>\n                  <button *ngIf = "isEditable || this.paymentTransactionAdmin" type="button" id="btnManualReceiptSubmit" class="btn btn-orange tab-btn1" (click)="submitReceiptForm()" >\n                     Update Transaction</button>\n\t               <button type="button" class="btn btn-red tab-btn1" (click)="cancelReceiptForm()" >\n\t               Cancel</button>\n\t            </div>\n\t           </div>\n            </form>\n         </div>\n      </div>\n   </div>\n</div>\n\n</div>\n'}});